<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Credentials Provisioning and Management via EAP (EAP-CREDS)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Requirements notation">
<link href="#rfc.section.2" rel="Chapter" title="2 Introduction">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Overview of existing solutions">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Scope Statement">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 EAP-CREDS as tunneled mechanism only">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Fragmentation Support">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 Encapsulating Provisioning Protocols in EAP-CREDS">
<link href="#rfc.section.2.6" rel="Chapter" title="2.6 Algorithm Requirements">
<link href="#rfc.section.2.7" rel="Chapter" title="2.7 Notation">
<link href="#rfc.section.3" rel="Chapter" title="3 EAP-CREDS Protocol">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Message Flow">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Phase Transitioning Rules">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Phase One: Initialization">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Phase Two: Provisioning">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Phase Three: Validation">
<link href="#rfc.section.4" rel="Chapter" title="4 EAP-CREDS Message Format">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Message Header">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Message Payload">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 EAP-CREDS defined TLVs">
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 The Action TLV">
<link href="#rfc.section.4.3.2" rel="Chapter" title="4.3.2 The Challenge-Data TLV">
<link href="#rfc.section.4.3.3" rel="Chapter" title="4.3.3 The Challenge-Response TLV">
<link href="#rfc.section.4.3.4" rel="Chapter" title="4.3.4 The Creds-Info TLV">
<link href="#rfc.section.4.3.5" rel="Chapter" title="4.3.5 The Error TLV">
<link href="#rfc.section.4.3.6" rel="Chapter" title="4.3.6 The Net-Usage TLV">
<link href="#rfc.section.4.3.7" rel="Chapter" title="4.3.7 The Profile TLV">
<link href="#rfc.section.4.3.8" rel="Chapter" title="4.3.8 The Protocol TLV">
<link href="#rfc.section.4.3.9" rel="Chapter" title="4.3.9 The ProtoData TLV">
<link href="#rfc.section.4.3.10" rel="Chapter" title="4.3.10 The ProtoHeaders TLV">
<link href="#rfc.section.4.3.11" rel="Chapter" title="4.3.11 The Params TLV">
<link href="#rfc.section.4.3.12" rel="Chapter" title="4.3.12 The Token TLV">
<link href="#rfc.section.4.3.13" rel="Chapter" title="4.3.13 The Version TLV">
<link href="#rfc.section.5" rel="Chapter" title="5 EAP-CREDS Messages">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 The EAP-CREDS-Init Message">
<link href="#rfc.section.5.1.1" rel="Chapter" title="5.1.1 EAP Server's Init Message">
<link href="#rfc.section.5.1.2" rel="Chapter" title="5.1.2 EAP Peer's Init Message">
<link href="#rfc.section.5.1.2.1" rel="Chapter" title="5.1.2.1 Bootstrapping Peer's Trustworthiness">
<link href="#rfc.section.5.1.3" rel="Chapter" title="5.1.3 The EAP-CREDS-Provisioning Message">
<link href="#rfc.section.5.1.4" rel="Chapter" title="5.1.4 The EAP-CREDS-Validate Message">
<link href="#rfc.section.6" rel="Chapter" title="6 Error Handling in EAP-CREDS">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Provisioning Protocols">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Token Types">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 Credentials Types">
<link href="#rfc.section.7.4" rel="Chapter" title="7.4 Credentials Algorithms">
<link href="#rfc.section.7.5" rel="Chapter" title="7.5 Challenge Types">
<link href="#rfc.section.7.6" rel="Chapter" title="7.6 Network Usage Datatypes">
<link href="#rfc.section.7.7" rel="Chapter" title="7.7 Credentials Encoding">
<link href="#rfc.section.7.8" rel="Chapter" title="7.8 Action Types">
<link href="#rfc.section.7.9" rel="Chapter" title="7.9 Usage Metadata Types">
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="10 Normative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.40.0 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Pala, M. and Y. Tian" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-pala-tian-eap-creds-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2022-06-30" />
  <meta name="dct.abstract" content="With the increase number of devices, protocols, and applications that rely on strong credentials (e.g., digital certificates, keys, or tokens) for network access, the need for a standardized credentials provisioning and management framework is paramount.  The 802.1x architecture allows for entities (e.g., devices, applications, etc.) to authenticate to the network by providing a communication channel where different methods can be used to exchange different types of credentials.  However, the need for managing these credentials (i.e., provisioning and renewal) is still a hard problem to solve. Usually, credentails used in an access network can be in different levels (e.g., network-level, user-level) and sometimes tend to live unmanaged for quite a long time due to the challenges of operation and implementation.  EAP-CREDS (RFC XXXX), if implemented in Managed Networks (e.g., Cable Modems), could enable our operators to offer a registration and credentials management service integrated in the home WiFi thus enabling visibility about registered devices.  During initialization, EAP-CREDS also allows for MUD files or URLs to be transferred between the EAP Peer and the EAP Server, thus giving detailed visibility about devices when they are provisioned with credentials for accessing the networks. The possibility provided by EAP-CREDS can help to secure home or business networks by leveraging the synergies of the security teams from the network operators thanks to the extended knowledge of what and how is registered/authenticated.  This specifications define how to support the provisioning and management of authentication credentials that can be exploited in different environments (e.g., Wired, WiFi, cellular, etc.) to users and/or devices by using EAP together with standard provisioning protocols.   " />
  <meta name="description" content="With the increase number of devices, protocols, and applications that rely on strong credentials (e.g., digital certificates, keys, or tokens) for network access, the need for a standardized credentials provisioning and management framework is paramount.  The 802.1x architecture allows for entities (e.g., devices, applications, etc.) to authenticate to the network by providing a communication channel where different methods can be used to exchange different types of credentials.  However, the need for managing these credentials (i.e., provisioning and renewal) is still a hard problem to solve. Usually, credentails used in an access network can be in different levels (e.g., network-level, user-level) and sometimes tend to live unmanaged for quite a long time due to the challenges of operation and implementation.  EAP-CREDS (RFC XXXX), if implemented in Managed Networks (e.g., Cable Modems), could enable our operators to offer a registration and credentials management service integrated in the home WiFi thus enabling visibility about registered devices.  During initialization, EAP-CREDS also allows for MUD files or URLs to be transferred between the EAP Peer and the EAP Server, thus giving detailed visibility about devices when they are provisioned with credentials for accessing the networks. The possibility provided by EAP-CREDS can help to secure home or business networks by leveraging the synergies of the security teams from the network operators thanks to the extended knowledge of what and how is registered/authenticated.  This specifications define how to support the provisioning and management of authentication credentials that can be exploited in different environments (e.g., Wired, WiFi, cellular, etc.) to users and/or devices by using EAP together with standard provisioning protocols.   " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">M. Pala</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Y. Tian</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">CableLabs</td>
</tr>
<tr>
<td class="left">Expires: January 1, 2023</td>
<td class="right">June 30, 2022</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Credentials Provisioning and Management via EAP (EAP-CREDS)<br />
  <span class="filename">draft-pala-tian-eap-creds-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>With the increase number of devices, protocols, and applications that rely on strong credentials (e.g., digital certificates, keys, or tokens) for network access, the need for a standardized credentials provisioning and management framework is paramount.  The 802.1x architecture allows for entities (e.g., devices, applications, etc.) to authenticate to the network by providing a communication channel where different methods can be used to exchange different types of credentials.  However, the need for managing these credentials (i.e., provisioning and renewal) is still a hard problem to solve. Usually, credentails used in an access network can be in different levels (e.g., network-level, user-level) and sometimes tend to live unmanaged for quite a long time due to the challenges of operation and implementation.  EAP-CREDS (RFC XXXX), if implemented in Managed Networks (e.g., Cable Modems), could enable our operators to offer a registration and credentials management service integrated in the home WiFi thus enabling visibility about registered devices.  During initialization, EAP-CREDS also allows for MUD files or URLs to be transferred between the EAP Peer and the EAP Server, thus giving detailed visibility about devices when they are provisioned with credentials for accessing the networks. The possibility provided by EAP-CREDS can help to secure home or business networks by leveraging the synergies of the security teams from the network operators thanks to the extended knowledge of what and how is registered/authenticated.  This specifications define how to support the provisioning and management of authentication credentials that can be exploited in different environments (e.g., Wired, WiFi, cellular, etc.) to users and/or devices by using EAP together with standard provisioning protocols.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 1, 2023.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2022 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Requirements notation</a>
</li>
<li>2.   <a href="#rfc.section.2">Introduction</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Overview of existing solutions</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Scope Statement</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">EAP-CREDS as tunneled mechanism only</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">Fragmentation Support</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">Encapsulating Provisioning Protocols in EAP-CREDS</a>
</li>
<li>2.6.   <a href="#rfc.section.2.6">Algorithm Requirements</a>
</li>
<li>2.7.   <a href="#rfc.section.2.7">Notation</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">EAP-CREDS Protocol</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Message Flow</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Phase Transitioning Rules</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Phase One: Initialization</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Phase Two: Provisioning</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Phase Three: Validation</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">EAP-CREDS Message Format</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Message Header</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Message Payload</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">EAP-CREDS defined TLVs</a>
</li>
<ul><li>4.3.1.   <a href="#rfc.section.4.3.1">The Action TLV</a>
</li>
<li>4.3.2.   <a href="#rfc.section.4.3.2">The Challenge-Data TLV</a>
</li>
<li>4.3.3.   <a href="#rfc.section.4.3.3">The Challenge-Response TLV</a>
</li>
<li>4.3.4.   <a href="#rfc.section.4.3.4">The Creds-Info TLV</a>
</li>
<li>4.3.5.   <a href="#rfc.section.4.3.5">The Error TLV</a>
</li>
<li>4.3.6.   <a href="#rfc.section.4.3.6">The Net-Usage TLV</a>
</li>
<li>4.3.7.   <a href="#rfc.section.4.3.7">The Profile TLV</a>
</li>
<li>4.3.8.   <a href="#rfc.section.4.3.8">The Protocol TLV</a>
</li>
<li>4.3.9.   <a href="#rfc.section.4.3.9">The ProtoData TLV</a>
</li>
<li>4.3.10.   <a href="#rfc.section.4.3.10">The ProtoHeaders TLV</a>
</li>
<li>4.3.11.   <a href="#rfc.section.4.3.11">The Params TLV</a>
</li>
<li>4.3.12.   <a href="#rfc.section.4.3.12">The Token TLV</a>
</li>
<li>4.3.13.   <a href="#rfc.section.4.3.13">The Version TLV</a>
</li>
</ul></ul><li>5.   <a href="#rfc.section.5">EAP-CREDS Messages</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">The EAP-CREDS-Init Message</a>
</li>
<ul><li>5.1.1.   <a href="#rfc.section.5.1.1">EAP Server's Init Message</a>
</li>
<li>5.1.2.   <a href="#rfc.section.5.1.2">EAP Peer's Init Message</a>
</li>
<ul><li>5.1.2.1.   <a href="#rfc.section.5.1.2.1">Bootstrapping Peer's Trustworthiness</a>
</li>
</ul><li>5.1.3.   <a href="#rfc.section.5.1.3">The EAP-CREDS-Provisioning Message</a>
</li>
<li>5.1.4.   <a href="#rfc.section.5.1.4">The EAP-CREDS-Validate Message</a>
</li>
</ul></ul><li>6.   <a href="#rfc.section.6">Error Handling in EAP-CREDS</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<ul><li>7.1.   <a href="#rfc.section.7.1">Provisioning Protocols</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">Token Types</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">Credentials Types</a>
</li>
<li>7.4.   <a href="#rfc.section.7.4">Credentials Algorithms</a>
</li>
<li>7.5.   <a href="#rfc.section.7.5">Challenge Types</a>
</li>
<li>7.6.   <a href="#rfc.section.7.6">Network Usage Datatypes</a>
</li>
<li>7.7.   <a href="#rfc.section.7.7">Credentials Encoding</a>
</li>
<li>7.8.   <a href="#rfc.section.7.8">Action Types</a>
</li>
<li>7.9.   <a href="#rfc.section.7.9">Usage Metadata Types</a>
</li>
</ul><li>8.   <a href="#rfc.section.8">Security Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgments</a>
</li>
<li>10.   <a href="#rfc.references">Normative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Requirements notation</h1>
<p id="rfc.section.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119" class="xref">[RFC2119]</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.2.p.1">Many environments are, today, moving towards requiring strong authentication when it comes to gain access to networks. The 802.1x architecture provides network administrators with the possibility to check credentials presented by a device even before providing any connectivity or IP services to it.  However, the provisioning and management of these credentials is a hard problem to solve and many vendors opt for long-lived credentials that can not be easily revoked, replaced, or simply renewed.  This specification addresses the problem of providing a simple-to-use and simple-to-deploy conduit for credentials management by extending the EAP protocol to support credentials provisioning and management functionality.  In particular, the EAP-CREDS method defined here provides a generic framework that can carry the messages for provisioning different types of credentials.  EAP-CREDS cannot be used as a stand-alone method, it is required that EAP-CREDS is used as an inner method of EAP-TLS, EAP-TEAP, or any other tunneling method that can provide the required secrecy and (at minimum) server-side authentication to make sure that the communication is protected and with the right server.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#existing_solutions" id="existing_solutions">Overview of existing solutions</a>
</h1>
<p id="rfc.section.2.1.p.1">Currently there are many protocols that address credentials lifecycle management. In particular, when it comes to digital certificates, some of the most deployed management protocols are: Certificate Management Protocol (CMP) <a href="#RFC4210" class="xref">[RFC4210]</a>, Certificate Management over CMS (CMC) <a href="#RFC5272" class="xref">[RFC5272]</a><a href="#RFC6402" class="xref">[RFC6402]</a>, Enrollment over Secure Transport (EST) <a href="#RFC7030" class="xref">[RFC7030]</a>, and Automated Certificate Management Environment (ACME) <a href="#RFC8555" class="xref">[RFC8555]</a>.  However, none of these protocols provide native support for client that do not have IP connectivity yet (e.g., because they do not have network-access credentials, yet). EAP-CREDS provides the possibility to use such protocols (i.e., message-based) by defining a series of messages that can be used to encapsulate the provisioning messages for the selected provisioning protocol.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#scope" id="scope">Scope Statement</a>
</h1>
<p id="rfc.section.2.2.p.1">This document focuses on the definition of the EAP-CREDS method to convey credentials provisioning and managing messages between the client and the AAA server. Moreover, the document defines how to encode messages for the main IETF provisioning protocols.  This document, however, does not provide specifications for how and where the credentials are generated. In particular, the credentials could be generated directly within the AAA server or at a different location (i.e., the Certificate Service Provider or CSP) site. Different authentication mechanisms (e.g., TLS, etc.) can be used to secure the communication between the server's endpoint and the CSP.  Examples and details of how to use EAP-CREDS encapsulation mechanism with specific protocol are out of scope of this document. For more details of using EAP-CREDS method with Simple Provisioning Protocol (SPP), please refer to EAP-CREDS with Simple Provisioning Protocol (SPP) .  For more details of using EAP-CREDS method with Certificate Management Protocol (CMP), please refer to EAP-CREDS withwith Certificate Management Protocol (CMP) .  These two documents can be used as the template for other protocols' encapulation with EAP-CREDS.  </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#tunnel" id="tunnel">EAP-CREDS as tunneled mechanism only</a>
</h1>
<p id="rfc.section.2.3.p.1">EAP-CREDS requires that an outer mechanism is in place between the Peer and the Server in order to provide authentication and confidentiality of the messages exchanged via EAP-CREDS. In other words, EAP-CREDS assumes that an appropriately encrypted and authenticated channel has been established to prevent the possibility to leak information or to allow man-in-the-middle attacks.  </p>
<p id="rfc.section.2.3.p.2">This choice was taken to simplify the message flow between Peer and Server, and to abstract EAP-CREDS from the secure-channel establishment mechanism. EAP-TLS, or EAP-TEAP are examples of such mechanisms.  </p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> <a href="#frag" id="frag">Fragmentation Support</a>
</h1>
<p id="rfc.section.2.4.p.1">EAP does not directly support handling fragmented packets and it requires the outer method to provide fragmentation support.  </p>
<p id="rfc.section.2.4.p.2">Because of the outer method requirements in particular, removing any support for fragmented messages in EAP-CREDS removes the duplication of packets (e.g., Acknowledgment Packets) sent across the Peer and the Server, thus resulting in a smaller number of exchanged messages.  </p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> <a href="#teap_creds" id="teap_creds">Encapsulating Provisioning Protocols in EAP-CREDS</a>
</h1>
<p id="rfc.section.2.5.p.1">In order to use EAP-CREDS together with your favorite provisioning protocol, the messages from the provisioning protocol need to be sent to the other party. In EAP-CREDS, this is done by encoding the provisioning protocol messages inside the ('ProtoData') TLV.  In case the provisioning protocol uses additional data for its operations (e.g., uses HTTP Headers), this data can be encoded in a separate ('ProtoHeaders') TLV.  </p>
<p id="rfc.section.2.5.p.2">Since the implementation of the provisioning endpoint could happen in a (logically or physically) different component, a method is needed to identify when a provisioning protocol has actually ended. In EAP-CREDS, the 'D' (Done) bit in the message headers is used for this purpose.  </p>
<p id="rfc.section.2.5.p.3">In the first message of Phase Two, the Server provides the client with all the selected parameters for one specific credential that needs attention (or for a new credential) to be managed by the network. In particular, the server provides, at minimum, the ('Protocol') TLV, the ('Action') TLV, and the ('Params') or the ('Creds-Info') TLV.  </p>
<p id="rfc.section.2.5.p.4">After checking the parameters sent by the Server, if the Peer does not support any of the proposed ones, it MUST send a message with one single ('Error') TLV with the appropriate error code(s). The server, can then decide if to manage a different set of credentials (if more where reported by the Peer in its Phase One message) or if to terminate the EAP session with an error.  </p>
<p id="rfc.section.2.5.p.5">The Peer and the Server exchange Provisioning messages until an error is detected (and the appropriate error message is sent to the other party) or until Phase Two is successfully completed.  </p>
<h1 id="rfc.section.2.6">
<a href="#rfc.section.2.6">2.6.</a> <a href="#eap_creds_hashing" id="eap_creds_hashing">Algorithm Requirements</a>
</h1>
<p id="rfc.section.2.6.p.1">EAP-CREDS uses the SHA-256 hashing algorithm to verify credentials in phase three of the protocol. Peers and Servers MUST support SHA-256 for this purpose.  </p>
<h1 id="rfc.section.2.7">
<a href="#rfc.section.2.7">2.7.</a> <a href="#notation" id="notation">Notation</a>
</h1>
<p id="rfc.section.2.7.p.1">In this document we use the following notation in the diagrams to provide information about the cardinality of the data structures (TLVs) within EAP-CREDS messages: </p>
<div id="rfc.table.1"></div>
<div id="eap_creds_notation"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>EAP-CREDS Notation</caption>
<thead><tr>
<th class="center">Symbol</th>
<th class="center">Example</th>
<th class="left">Usage</th>
</tr></thead>
<tbody>
<tr>
<td class="center">{ }</td>
<td class="center">{TLV1}</td>
<td class="left">Curly Brackets are used to indicate a set</td>
</tr>
<tr>
<td class="center">[ ]</td>
<td class="center">{[TLV2]}</td>
<td class="left">Square Brackets are used to indicate that a field is optional</td>
</tr>
<tr>
<td class="center">( )</td>
<td class="center">{TLV1(=V)}</td>
<td class="left">Round Squares are used to specify a value</td>
</tr>
<tr>
<td class="center">+ </td>
<td class="center">{TLV_2+}</td>
<td class="left">The Plus character indicates that one or more instances are allowed</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> EAP-CREDS Protocol</h1>
<p id="rfc.section.3.p.1">In a nutshell, EAP-CREDS provides the abstraction layer on top of which credentials provisioning/managing protocols can be deployed thus enabling their use even before provisioning IP services.  </p>
<p id="rfc.section.3.p.2">This section outlines the operation of the protocol and message flows.  The format of the CREDS messages is given in <a href="#creds_msg" class="xref">Section 4</a>.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Message Flow</h1>
<p id="rfc.section.3.1.p.1">EAP-CREDS message flow is logically subdivided into three different phases: Initialization, Provisioning, and Validation. EAP-CREDS enforces the order of phases, i.e. it is not possible to move to an earlier phase.  </p>
<p id="rfc.section.3.1.p.2">Phase transitioning is controlled by the Server. In particular, the server, after the last message of a phase, it can decide to either (a) start the next phase by sending the first message of the next phase, or (b) continue the same phase by sending another "first" message of the phase (e.g., managing a second set of credentials) - this is allowed only in Phase Two and Phase Three but NOT in Phase One, or (c) terminate the EAP session.  </p>
<p></p>

<dl>
<dt>Phase One (Required).</dt>
<dd style="margin-left: 8">Initialization. During this phase the Peer and the Server exchange the information needed to select the appropriate credentials management protocol.  Phase One flow is composed by only messages.  In particular, the Sever sends its initial message of type ('EAP-CREDS-Init'). The Peer replies with the details about which provisioning protocols are supported, and additional information such as the list of installed credentials and, optionally, authorization data (for new credentials registration).  </dd>
<dt>Phase Two (Optional).</dt>
<dd style="margin-left: 8">Provisioning Protocol Flow. In this phase, the Peer and the Server exchange the provisioning protocol's messages encapsulated in a EAP-CREDS message of type Provisioning. The messages use two main TLVs.  The first one is the ('ProtoHeaders') TLV which is optional and carries information that might be normally conveyed via the transport protocol (e.g., HTTP headers). The second one is the ('ProtoData'), which is required and carries the provisioning protocol's messages. The server can decide to repeat phase two again to register new credentials or to renew a separate set of credentials by issuing a new ('Provisioning') message for the new target. When no more credentials have to be managed, the Server can start phase three or simply terminate the EAP session.  </dd>
<dt>Phase Three (Optional).</dt>
<dd style="margin-left: 8">Credentials Validation. This optional phase can be initiated by the server and it is used to validate that the Peer has properly installed the credentials and can use them to authenticate itself. Depending on the credentials' type, the messages can carry a challenge/nonce, the value of the secret/token, or other information. The format of the credentials is supposed to be known by the provider and the device.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#phase_transitioning" id="phase_transitioning">Phase Transitioning Rules</a>
</h1>
<p id="rfc.section.3.2.p.1">In order to keep track of starting and ending a phase, EAP-CREDS defines several bits and fields in the EAP-CREDS message headers. In particular, as described in <a href="#creds_header" class="xref">Section 4.1</a>, the 'S' (Start) bit is used to indicate the beginning (or Start) of a phase, while the 'Phase' field (4 bits) is used to indicate the phase for this message.  </p>
<p id="rfc.section.3.2.p.2">In EAP-CREDS, phase transitioning is under the sole control of the Server, therefore the value of the 'S' (Start) bit is meaningful only in messages sent by the Server.  The value of the 'S' (Start) bit in Peer's messages SHALL be set to '0x0' and SHALL be ignored by the server.  </p>
<p id="rfc.section.3.2.p.3">When starting a new phase, the Server MUST set the 'S' (Start) bit to '1' and the 'Phase' field to the current phase number (e.g., 0x01 for phase one, 0x02 for phase two, or 0x03 for phase three).  </p>
<p id="rfc.section.3.2.p.4">In case the first message of a phase is to be repeated (e.g., because of processing multiple credentials), the 'S' (Start) bit SHALL be set to '0' (i.e., it should be set to '1' only on the first occurrence and set to '0' in subsequent messages).  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#creds_phase_one" id="creds_phase_one">Phase One: Initialization</a>
</h1>
<p id="rfc.section.3.3.p.1">The following figure provides the message flow for Phase One: </p>
<pre>

    ,--------.                               ,----------.         
    |EAP Peer|                               |EAP Server|         
    `---+----'                               `----+-----'         
        |         Outer Tunnel Established        |               
        | &lt;---------------------------------------&gt;               
        |                                         |               
        | [1] EAP-Request/EAP-CREDS(Type=Init)    |  ,---------!. 
        |     { [ Version+ ], [ Challenge-Data ] }|  |Phase One|_\
        | &lt;----------------------------------------  |Begins     |
        |                                         |  `-----------'
        |  [2] EAP-Response/EAP-CREDS(Type=Init)  |               
        |      { [ Version+ ], [ Protocols+ ],    |               
        |        [ Creds-Info+ ], [ Encoding+ ],  |  ,---------!. 
        |        [ Format+ ], [ Token ],     |  |Phase One|_\
        |        [ Profile+ ], [ Challenge-Rsp ], |  |Ends       |
        |        [ Storage-Info ],[ Net-Usage] }  |  `-----------'
        | ----------------------------------------&gt;               
        |                                         |               
        |                                         |                   

    </pre>
<p class="figure">EAP-CREDS Phase One Message Flow</p>
<p id="rfc.section.3.3.p.2">[1] Server sends EAP-Request/EAP-CREDS(Type=Init): </p>

<ul class="empty">
<li>After the establishment of the outer mechanism (e.g., EAP-TLS, EAP-TEAP, EAP-TTLS, etc.), the server MAY decide to start a credentials management session. In order to do that, the Server sends an EAP-Request/EAP-CREDS(Type=Init) message to the Peer with the 'S' (Start) bit set to '1' and the Phase field value set to '0x01' (thus indicating the beginning of Phase One) as described in <a href="#creds_header" class="xref">Section 4.1</a>. Also, the Server MAY use one or more ('Version') TLVs to indicate the supported versions.  </li>
<li>The Server MAY also specify which versions of EAP-CREDS are supported by adding zero, one or more ('Version') TLVs. If no ('Version') TLV is added to the message, the Peer SHOULD assume the supported version is 1 ('0x01').  </li>
<li>Optionally, the Server MAY also send a ('Challenge-Data') TLV which includes chanllenge data value (usually some random value) and a specified challenge type. The Peer MUST use the specified type and use chanllenge data value for calculating the ('Challenge-Response') TLV.  </li>
</ul>

<p> </p>
<p id="rfc.section.3.3.p.3">[2] The Peer sends EAP-Response/EAP-CREDS(Type=Init) </p>

<ul class="empty">
<li>The Peer, sends back a message that carries one ('Version') TLV to indicate the selected version of EAP-CREDS (i.e.  from the list provided by the server) (optional). If the client does not include the ('Version') TLV, the Server MUST use the most recent supported version of EAP-CREDS. Moreover, the Server includes one or more ('Protocol') TLVs to indicate the list of supported provisioning protocols, followed by one ('Creds-Info') TLVs for each installed credentials to provide their status to the server (i.e., if multiple credentials are configured on the Peer for this Network, then the Peer MUST include one ('Creds-Info') TLV for each of them).  </li>
<li>The Peer MAY also provide the list of supported Encodings and Formats by adding one or more ('Encoding') and ('Formats') TLVs. The Peer MAY also provide the Server with information about the Peer's credentials storage by using the ('Storage-Info') TLV.  </li>
<li>When there are no available credentials, the Peer MAY include an authorization token that can be consumed by the Server for registering new credentials.  In particular, the Peer can include the ('Token') TLV to convey the value of the token. The ('Challenge-Data') and ('Challenge-Response') TLVs, instead, can be used to convey a challenge and its response based on the authorization information. For example, suppose a public key hash is present in the Token, the peer can generate some random data - or use the one from the Server - and generate a signature on that value: the signature SHALL be encoded in the ('Challenge-Response') TLV and it should be calculated over the concatenation of values inside the ('Challenge-Data') TLV and the ('Token') TLV.  </li>
<li>Also, the Peer MAY add one or more ('Profile') TLVs to indicate to the Server which profiles are requested/supported (e.g., a pre-configuration MAY exist on the Peer with these ecosystem-specific identifiers).  </li>
<li>Ultimately, the Peer MAY include additional metadata regarding the status of the Peer. To this end, the Peer can use a ('Storage-Info') TLV to provide the server with additional data about the Peer's capabilities and resources. Also, the ('Net-Usage') TLV can be used to provide the Server with the indication of which network resources are needed by the Peer and what is its intended utilization pattern(s).  </li>
<li>The server checks that the Peer's selected protocol, version, and parameters are supported and, if not (or if the server detects an error), it can (a) send a non-recoverable error message to the peer, notify the outer (tunneling) layer, and terminate the EAP-CREDS session, or (b) start phase one again by sending a new ('EAP-CREDS-Init') message that will also carry an ('ERROR') TLV that provides the Peer with the reason the initial response was not acceptable. In this case, the ('Phase') field MUST be omitted since it is not the first message of phase one. The server and the peer can repeat phase one until they reach an agreement or the session is terminated by the Server.  </li>
</ul>

<p> </p>
<p></p>

<ul class="empty"><li>NOTE WELL: The determination of the need to start phase two or not is based on the contents of the ('Creds-Info') TLV sent by the Peer (e.g., a credential is about to expire or a credential is simply missing).  </li></ul>

<p> </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#creds_phase_two" id="creds_phase_two">Phase Two: Provisioning</a>
</h1>
<p id="rfc.section.3.4.p.1">The following figure provides the message flow for Phase 2: </p>
<pre>

,--------.                                     ,----------.         
|EAP Peer|                                     |EAP Server|         
`---+----'                                     `----+-----'         
    |  [1] EAP-Request/EAP-CREDS(Type=Provisioning) |               
    |      { Protocol, Action,                      |  ,---------!. 
    |        [ Creds-Info  ], [ Params ],           |  |Phase Two|_\
    |        [ ProtoData ], [ ProtoHeaders ] }      |  |Begins     |
    | &lt;----------------------------------------------  `-----------'
    |                                               |               
    | [2] EAP-Response/EAP-CREDS(Type=Provisioning) |               
    |     { ProtoData, [ ProtoHeaders ] }           |               
    | ----------------------------------------------&gt;               
    |                                               |               
    .                                               .               
    .                                               .               
    .                                               .               
    .                                               .               
    | [N] EAP-Response/EAP-CREDS(Type=Provisioning) |               
    |     { [ Creds-Info ], [ ProtoData ],          |               
    |       [ ProtoHeaders ] }                      |               
    | &lt;----------------------------------------------               
    |                                               |               
    | [N+1] EAP-Request/EAP-CREDS(Type=Provisioning)|  ,---------!. 
    |     { [ ProtoData ], [ ProtoHeaders ] }       |  |Phase Two|_\
    | ----------------------------------------------&gt;  |Ends       |
    |                                               |  `-----------'
    |                                               |               
</pre>
<p class="figure">EAP-CREDS Phase Two Message Flow</p>
<p id="rfc.section.3.4.p.2">[1] The Server sends EAP-Request/EAP-CREDS(Type=Provisioning) </p>

<ul class="empty"><li>The first message of Phase Two indicates that the Server is ready to initiate the selected provisioning protocol.This message contains the parameters of the selected provisioning protocol in the ('Params') (e.g., algorithm for generating credentials), the description of installed credentials in the ('Creds-Info'), the selected provisioning protocol's message data and some extra fields (e.g., transport-protocol headers) in the ('ProtoData') and its content in ('ProtoHeaders') TLVs respectively.  </li></ul>

<p> </p>
<p id="rfc.section.3.4.p.3">[2] The Peer sends EAP-Response/EAP-CREDS(Type=Provisioning) </p>

<ul class="empty"><li>After that, the Peer sends its first message to the Server by sending the EAP-Response/EAP-CREDS(Type=Provisioning) message. This message contains the selected provisioning protocol's message data and some extra fields (e.g., transport-protocol headers) in the ('ProtoData') and its content in ('ProtoHeaders') TLVs respectively.  </li></ul>

<p> </p>
<p id="rfc.section.3.4.p.4">[N=3] The Server sends EAP-Request/EAP-CREDS(Type=Provisioning) </p>

<ul class="empty"><li>The Server replies to the Peer's message with EAP-Request/EAP-CREDS(Type=Provisioning) messages until the provisioning protocol reaches an end or an error condition arise (non-recoverable).  </li></ul>

<p> </p>
<p id="rfc.section.3.4.p.5">[N] The Server sends EAP-Request/EAP-CREDS(Type=Provisioning) </p>

<ul class="empty"><li>When the provisioning protocol has been executed for the specific set of credentials, the server sends a last message that MUST include the description of the provisioned credentials in a ('Creds-Info') TLV and MUST set the 'D' (Done) bit in the EAP-CREDS message header to '1' to indicates that the server does not have any more ('Type=Provisioning') messages for this credenital.  The final message does not need to be an empty one, i.e. other TLVs are still allowed in the same message (e.g., the 'ProtoData' and the 'ProtoHeaders' ones).  </li></ul>

<p> </p>
<p id="rfc.section.3.4.p.6">[N+1] The Peer sends EAP-Request/EAP-CREDS(Type=Provisioning) </p>

<ul class="empty"><li>The Peer MUST reply to the server with a ('Type=Provisioning') message that MUST have the 'D' (Done) bit in the EAP-CREDS message header set to '1', thus indicating that the credentials have been installed correctly. In case of errors, the Peer MUST include the appropriate ('Error') TLV.  Also in this case, the final message does not need to be an empty one, i.e. other TLVs are still allowed in the same message (e.g., tthe 'ProtoData' and the 'ProtoHeaders' ones).  </li></ul>

<p> </p>
<p id="rfc.section.3.4.p.7">At this point, the Server can decide to provision (or manage) another set of credentials by issuing a new ('Type=Provisioning') message, or it can decide to start Phase Three by sending its first ('Type=Validate') message, or it can terminate the EAP session.  </p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#creds_phase_three" id="creds_phase_three">Phase Three: Validation</a>
</h1>
<p id="rfc.section.3.5.p.1">The following figure provides the message flow for Phase 3: </p>
<pre>

    ,--------.                                ,----------.           
    |EAP Peer|                                |EAP Server|           
    `---+----'                                `----+-----'           
        | [1] EAP-Request/EAP-CREDS(Type=Validate) |  ,-----------!. 
        |     { Creds-Info, Challenge-Data }       |  |Phase Three|_\
        | &lt;-----------------------------------------  |Begins       |
        |                                          |  `-------------'
        | [2] EAP-Response/EAP-CREDS(Type=Validate)|  ,-----------!. 
        |     { Challenge-Response }               |  |Phase Three|_\
        | -----------------------------------------&gt;  |Ends         |
        |                                          |  `-------------'
        |                                          |                 

    </pre>
<p class="figure">EAP-CREDS Phase Three Message Flow</p>
<p id="rfc.section.3.5.p.2">Phase three is optional and it is used by the server to request the client to validate (with proof) that the new credentials have been installed correctly before issuing the final EAP-CREDS Success message.  </p>
<p></p>

<ul class="empty"><li>NOTE WELL: Phase Three introduces a dependency on the selected hashing algorithm to provide common and easy way to check the integrity and functionality of a newly installed set of credentials.  </li></ul>

<p> </p>
<p id="rfc.section.3.5.p.4">[1] The Server sends EAP-Request/EAP-CREDS(Type=Validate) </p>

<ul class="empty">
<li>In order to start Phase Three, the Server sends an EAP-Request/EAP-CREDS(Type=Validate) message to the Peer.  The Server MUST include the ('Creds-Info') TLV to provide the indication about which set of credentials the Server intends to validate. The Server MUST also include a randomly generated challenge in the message to the client. The type of challenge determines in ('Challenge-Data') for the peer to calculate ('Challenge-Response').  EAP-CREDS defines the asymmetric and symmetric challenges in <a href="#eap_creds_challenge_types" class="xref">Section 7.5</a> and others can be defined according to the specified rules.  </li>
<li>As usual, the Server MUST set, in the headers, the 'S' (Start) bit to '1' in its first message of Phase Three and the 'Phase' value shall be set to '3' (beginning of Phase Three).  </li>
</ul>

<p> </p>
<p id="rfc.section.3.5.p.5">[2] The Peer sends EAP-Response/EAP-CREDS(Type=Validate) </p>

<ul class="empty">
<li>When the client receives the Validate message from the server, it calculates the response to the challenge and sends the response back to the server in a EAP-Response/EAP-CREDS(Type=Validate) message.  When the 'EAP-CREDS-ASYMMETRIC-CHALLENGE' and 'EAP-CREDS-SYMMETRIC-CHALLENGE' values are used in the 'Challenge types', the Peer MUST calculate the response as follows: <ul class="empty">
<li>Public-Key <ul class="empty"><li>For any public-key based credentials (e.g., certificates or raw key pairs), the response to the challenge is calculated by generating a signature over the hashed value of the challenge. The hashing algorithm to be used for this purpose is specified in <a href="#eap_creds_hashing" class="xref">Section 2.6</a>.  The format of the signature in the ('Challenge-Response') TLV is the concatenation of: <ul>
<li>The signatureAlgorithm (DER encoded) which contains the identifier for the cryptographic algorithm used by the Peer to generate the signature using <a href="#RFC3279" class="xref">[RFC3279]</a>, <a href="#RFC4055" class="xref">[RFC4055]</a>, and <a href="#RFC4491" class="xref">[RFC4491]</a> list supported signature algorithms. Other signature algorithms MAY also be supported.  The definition of the signatureAlgorithm is provided in Section 4.1.1.2 of <a href="#RFC5280" class="xref">[RFC5280]</a>.  </li>
<li>The signatureValue (DER encoded) which contains the digital signature itself. The signature value is encoded as a BIT STRING and the details of how to generate the signatures' structures can be found in Section 4.1.1.3 of <a href="#RFC5280" class="xref">[RFC5280]</a> and referenced material.  </li>
</ul>
<p> </p>
</li></ul>
<p> </p>
</li>
<li>Symmetric Secret <ul class="empty"><li>For any symmetric based credentials (e.g., password or Key), the response to the challenge is calculated by using the selected hash function (see <a href="#eap_creds_hashing" class="xref">Section 2.6</a>) on the concatenation of (a) the value carried in the server-provided ('Challenge-Data') TLV, and (b) the secret value itself (salted hash).  </li></ul>
<p> </p>
</li>
</ul>
<p> </p>
</li>
<li>The initial values for the type of challenges are described in the <a href="#eap_creds_challenge_types" class="xref">Section 7.5</a>.  Other types of challenges MAY be defined according to the specified procedures.  </li>
<li>In case of issues with the validation of newly deployed credentials, both the Server and the Peer should consider those credentials invalid (or unusable) and should issue the required failure message(s).  </li>
</ul>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#creds_msg" id="creds_msg">EAP-CREDS Message Format</a>
</h1>
<p id="rfc.section.4.p.1">The EAP-CREDS defines the following message types: </p>

<ol>
<li>EAP-CREDS-Init</li>
<li>EAP-CREDS-Provisioning</li>
<li>EAP-CREDS-Validate</li>
</ol>

<p> </p>
<p id="rfc.section.4.p.2">Each of these message types have the basic structure as identified in <a href="#creds_header" class="xref">Section 4.1</a>.  EAP-CREDS messages contain zero, one, or more TLVs.  The internal structure of the different types of TLVs is described in <a href="#creds_msg_payload" class="xref">Section 4.2</a>, while a detailed description of the EAP-CREDS message types is provided in <a href="#creds_msg_types" class="xref">Section 5</a>.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#creds_header" id="creds_header">Message Header</a>
</h1>
<p id="rfc.section.4.1.p.1">The EAP-CREDS messages consist of the standard EAP header (see Section 4 of <a href="#RFC3748" class="xref">[RFC3748]</a>), followed by the message payload of the EAP-CREDS.  The header has the following structure: </p>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Code      |  Identifier   |             Length            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Type      |J|S|F|D| Phase |         Message Length        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         Message Length        |               Data           ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-.

</pre>
<p id="rfc.section.4.1.p.2">Where the Code, Identifier, Length, and Type fields are all part of the EAP header as defined in <a href="#RFC3748" class="xref">[RFC3748]</a>. Since EAP-CREDS can only be used as a tunneled mechanism, the presence of these fields is only for backward compatibility with existing parsers. In particular, the 'Length' field is used for fragmentation instead of the message length: the message length is carried in the 'Message Length' field if Jumbo Message is indicated in the header.  </p>
<p id="rfc.section.4.1.p.3">The Type field in the EAP header is &lt;TBD&gt; for EAP-CREDS.  </p>
<p id="rfc.section.4.1.p.4">The Flags bitfield is used to convey status information (e.g., extra long message, phase number, phase transitioning state). The transition-control bit (i.e., the 'S' (Start) bit) are set in Server's messages and are ignored in Peer's messages (the Server is the entity that unilaterally controls the phase transition process).  The meanings of the bits in the 'Flags' field are as follows: </p>

<ul class="empty">
<li>Bit 'J' (Jumbo Message) - If set, it indicates the presence of the 'Message Length' field.  This bit SHALL be used only when the size of the message exceeds the maximum value allowed in the 'Length' field. In this case, the 'Message Length' field is added to the message and set to the whole message size and the 'Length' field is used for the current fragment length.  If not set, the 'Message Length' field is not present in the Message and the 'Length' field is used for the message size (and the 'F' (Fragment) bit MUST be set to '0').  </li>
<li>Bit 'S' (Start) - If set, this message is the first one of a new EAP-CREDS phase.  The value of the new phase is encoded in the 'Phase' field.  </li>
<li>Bit 'F' (Fragment) - If set, this message is a fragment of a message. In this case, the 'Data' field is to be concatenated with all messages with the 'F' (Fragment) bit set to '1' until the message with the 'F' (Fragment) bit set to '0' that indicates the end of the message. If the message is not fragmented, the 'F' (Fragment) bit MUST be set to '0'. The use of this bit is required when the tunneling method does not provide support for messages up to 2^32 bits in size.  </li>
<li>Bit 'D' (Done) - This bit is used in Phase Two and Phase Three to indicate that the specific operation for the identified credential is over. For example, when multiple credentials exist on the Peer and the Server needs to manage and validate one of them. In its last message, when the provisioning protocol is done, the server sets the 'D' (Done) bit to indicate that it is done. The Peer, in its reply, sets the bit to indicate the end of provisioning for this credentials is also over. After that, the Server can continue Phase Two, transition to Phase Three, or terminate the EAP session.  </li>
</ul>

<p> </p>
<p id="rfc.section.4.1.p.5">The Phase field is a 4-bits value and identifies the EAP-CREDS phase for the current message.  The version of EAP-CREDS described in this document supports three values for this field: </p>

<ul class="empty">
<li>0x01 - Phase One</li>
<li>0x02 - Phase Two</li>
<li>0x03 - Phase Three</li>
</ul>

<p> </p>
<p id="rfc.section.4.1.p.6">A detailed explanation of the 'Phase' and 'Flags' fields of the message headers is provided in <a href="#phase_transitioning" class="xref">Section 3.2</a>.  </p>
<p id="rfc.section.4.1.p.7">The Data field is the message payload. The full description of this field is provided in the next section.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#creds_msg_payload" id="creds_msg_payload">Message Payload</a>
</h1>
<p id="rfc.section.4.2.p.1">The Data part of the message is organized as zero, one, or more TLV objects whose structure is defined in this section.  </p>
<p id="rfc.section.4.2.p.2">Each TLV object has the same basic structure that is defined as follows: </p>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                   TLV Length                  |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       TLV Value                              ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.2.p.3">Where:</p>
<p id="rfc.section.4.2.p.4">TLV-Type (uint8) </p>

<ul class="empty"><li>This field is used to indicate the type of data that the TLV carries. The type of TLV determines its internal structure.  The supported values for this fields are provided in the following table: </li></ul>

<p> </p>
<p id="rfc.section.4.2.p.5">Length (uint24) </p>

<ul class="empty"><li>This field carries the size of the value of the TLV. In particular, the overall size of a TLV (i.e., the header plus the value) can be calculated by adding the size of the header (6 octets) to the value of the Length field (i.e., the size of the TLV's value).  </li></ul>

<p> </p>
<div id="rfc.table.2"></div>
<div id="eap_creds_tlvs_table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>EAP-CREDS Supported TLVs Types</caption>
<thead><tr>
<th class="center">TLV Name</th>
<th class="left">TLV Type</th>
<th class="center">Scope/Usage</th>
</tr></thead>
<tbody>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Action TLV</td>
<td class="center">Phase Two</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Certificate-Data TLV</td>
<td class="center">Phase Two</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Challenge-Data TLV</td>
<td class="center">Phase Two, Phase Three</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Challenge-Response TLV</td>
<td class="center">Phase Two, Phase Three</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Credentials-Data TLV</td>
<td class="center">Phase Two</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Creds-Info TLV</td>
<td class="center">Phase Two, Phase Three</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Error TLV</td>
<td class="center">All Phases</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Net-Usage TLV</td>
<td class="center">Phase One</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Profile TLV</td>
<td class="center">Phase Two</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Protocol TLV</td>
<td class="center">Phase One, Phase Two</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">ProtoData TLV</td>
<td class="center">Phase Two</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">ProtoHeaders TLV</td>
<td class="center">Phase Two</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Params TLV</td>
<td class="center">Phase Two</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Token TLV</td>
<td class="center">Phase One</td>
</tr>
<tr>
<td class="center">&lt;TBD&gt;</td>
<td class="left">Version TLV</td>
<td class="center">Phase One</td>
</tr>
</tbody>
</table>
<p id="rfc.section.4.2.p.6">TLV Value ( &gt; 1 octet ) </p>

<ul class="empty"><li>This field carries data for the identified TLV. The internal structure is determined by the TLV Type field.  </li></ul>

<p> </p>
<p id="rfc.section.4.2.p.7">The rest of this section describes the structure of the different supported TLVs and their usage in the different messages.  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#creds_tlvs_types" id="creds_tlvs_types">EAP-CREDS defined TLVs</a>
</h1>
<p id="rfc.section.4.3.p.1">EAP-CREDS messages's payload comprises zero, one, or more TLVs that are encoded in a single EAP-CREDS message.  The values for the TLV Type that are supported by this specifications are listed in <a href="#eap_creds_tlvs_table" class="xref">Table 2</a>.  </p>
<h1 id="rfc.section.4.3.1">
<a href="#rfc.section.4.3.1">4.3.1.</a> <a href="#tlv_action" id="tlv_action">The Action TLV</a>
</h1>
<pre>

   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   TLV Type    |                 TLV Length                    |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Flags     |  Action Type  |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   </pre>
<p id="rfc.section.4.3.1.p.1">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - Action TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.1.p.2">TLV Length (uint24) </p>

<ul class="empty"><li>Fixed value (=2)</li></ul>

<p> </p>
<p id="rfc.section.4.3.1.p.3">Flags (uint8) </p>

<ul class="empty"><li>Reserved</li></ul>

<p> </p>
<h1 id="rfc.section.4.3.2">
<a href="#rfc.section.4.3.2">4.3.2.</a> <a href="#tlv_challenge" id="tlv_challenge">The Challenge-Data TLV</a>
</h1>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Ch. Type    |           Challenge Data                     ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.3.2.p.1">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - Challenge-Data TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.2.p.2">Length (uint24) </p>

<ul class="empty"><li>3 octets</li></ul>

<p> </p>
<p id="rfc.section.4.3.2.p.3">Challenge Type (uint8) </p>

<ul class="empty"><li>This field carries the type of Challenge. In particular, the challenge type determines how the Peer MUST calculate the ('Challenge-Response').  The initial values for this field are listed in <a href="#eap_creds_challenge_types" class="xref">Section 7.5</a>.  Please refer to <a href="#creds_phase_three" class="xref">Section 3.5</a> for a detailed explanation of how to calculate the response to the challenge for the challenge types defined in this document.  </li></ul>

<p> </p>
<p id="rfc.section.4.3.2.p.4">Challenge Data (&gt; 1 octet) </p>

<ul class="empty"><li>This field carries the data to be used as a challenge when validating newly deployed credentials.  </li></ul>

<p> </p>
<h1 id="rfc.section.4.3.3">
<a href="#rfc.section.4.3.3">4.3.3.</a> <a href="#tlv_challenge_response" id="tlv_challenge_response">The Challenge-Response TLV</a>
</h1>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Challenge Response                     ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.3.3.p.1">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - Challenge-Response TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.3.p.2">Length (uint24) </p>

<ul class="empty"><li>3 octets</li></ul>

<p> </p>
<p id="rfc.section.4.3.3.p.3">Challenge Response (&gt; 1 octet) </p>

<ul class="empty"><li>This field carries the data that resulted from the use of the credentials to be validated.  </li></ul>

<p> </p>
<h1 id="rfc.section.4.3.4">
<a href="#rfc.section.4.3.4">4.3.4.</a> <a href="#tlv_Creds-Info" id="tlv_Creds-Info">The Creds-Info TLV</a>
</h1>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |        
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Flags     |   CredsType   |             ProtoID           |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                         IssuedOn (GMT)                        |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                        ExpiresOn (GMT)                       |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Credentials Length                      |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                           CredIDValue                        ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.3.4.p.1">The Creds-Info TLV is used by the Peer to provide a description of the installed credentials that are relevant for the network that is being accessed.  </p>
<p id="rfc.section.4.3.4.p.2">For example, when a set of credentials need to be renewed, the server checks the ('Creds-Info') from the Peer and eventually selects the right one for renewal. The TLV structure is as follows: </p>
<p id="rfc.section.4.3.4.p.3">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - Creds-Info TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.4.p.4">Length (uint24) </p>

<ul class="empty"><li>Provides the total length of the body of the Creds-Info TLV.  </li></ul>

<p> </p>
<p id="rfc.section.4.3.4.p.5">Flags (uint8) </p>

<ul class="empty"><li>Provides a BITMASK that can be used to provide information about the status of the credentials (e.g., if the use marks the credentials to be compromised). The bits have the following meaning: <ul class="empty">
<li>Bit 0 - If set, the credential is marked as compromised</li>
<li>Bit 1 - If set, the credential is immutable and cannot be updated</li>
<li>Bit 2 - Private Key or Secret Immutable, the public part of the credential (e.g., a certificate) can still be updated</li>
<li>Bit 3 - If set, the credential cannot be updated (both public and private parts)</li>
<li>Bit 4 - If set, the credential is ready to be used </li>
<li>Bit 5 - If set, the credential was generated on the server</li>
<li>Bit 6 - If set, the Peer would like to update the credential even if they are not expired</li>
<li>Bit 7 - Reserved</li>
</ul>
<p> </p>
</li></ul>

<p> </p>
<p id="rfc.section.4.3.4.p.6">CredType (uint8) </p>

<ul class="empty"><li>This field provides the description of the type of credential. The type of credentials are listed in <a href="#iana_creds_type" class="xref">Section 7.3</a> </li></ul>

<p> </p>
<p id="rfc.section.4.3.4.p.7">ProtoID (uint16) </p>

<ul class="empty"><li>This field indicates the protocol that was used to retrieve the target credential. When the TLV is used in a Request by the Server, this field is ignored.  The values for this field are listed in <a href="#iana_proto" class="xref">Section 7.1</a>.  </li></ul>

<p> </p>
<p id="rfc.section.4.3.4.p.8">IssuedOn (16 octets) </p>

<ul class="empty">
<li>This field carries the GMT date for when this credential was issued.  This field is 16 bytes long (the last byte must be set to '0x00') and contains the NULL-terminated ASCII string that represents the timestamp where the credential was issued. When the value is not set, the field should be set to { 0x00 }. The format of the string is as follows: </li>
<li>
<ul class="empty"><li>YYYYMMDDHHmmssZ</li></ul>
<p> </p>
</li>
<li>Where: <ul class="empty">
<li>YYYY - is the 4 digits representation of the year</li>
<li>MM - is the 2 digits representation of the month</li>
<li>DD - is the 2 digits representation of the day of the month</li>
<li>HH - is the 2 digits representation of the hour of the day (24 hour format)</li>
<li>mm - is the 2 digits representation of the minutes of the hour</li>
<li>ss - is the 2 digits representation of the seconds of the minute</li>
<li>Z - is the character 'Z'</li>
</ul>
<p> </p>
</li>
</ul>

<p> </p>
<p id="rfc.section.4.3.4.p.9">ExpiresOn (16 octets) </p>

<ul class="empty"><li>This field carries the GMT date for when this credential is to be considered expired. This field is 16 bytes long (the last byte must be set to '0x00') and contains the NULL-terminated ASCII string that represents the timestamp where the credential was issued. The format is the same as the ('IssuedOn') field.  When the value is not set, the field should be set to { 0x00 }.  </li></ul>

<p> </p>
<p id="rfc.section.4.3.4.p.10">Credentials Length (uint32) </p>

<ul class="empty"><li>Length (in bytes) of the Credentials value. When used with a public-key type of credentials, this is the size of the key (e.g., for an RSA 2048 bit keys, this field should carry the value of 256). When used with a symmetric secret, this field carries the size of the secret (in bytes).  </li></ul>

<p> </p>
<p id="rfc.section.4.3.4.p.11">CredIDValue (&gt; 1 octet) </p>

<ul class="empty"><li>The binary value of the credentials' identifier. This identifier can be the binary value of the SHA-256 calculated over the certificate, a username, or it could be a random handle. As long as the ID allows the peer and the server to uniquely (in its context) identify the credentials, the value of this field can be calculated in any way.  </li></ul>

<p> </p>
<h1 id="rfc.section.4.3.5">
<a href="#rfc.section.4.3.5">4.3.5.</a> <a href="#tlv_error" id="tlv_error">The Error TLV</a>
</h1>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     EAP-CREDS Error Code      |      Secondary Error Code     |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          Description                         ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.3.5.p.1">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - Challenge-Response-Data TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.5.p.2">Length (uint24) </p>

<ul class="empty"><li>3 octets</li></ul>

<p> </p>
<p id="rfc.section.4.3.5.p.3">EAP-CREDS Error Code (2 octets) </p>

<ul class="empty">
<li>This field carries the EAP-CREDS error code. These code are related to the EAP-CREDS operations only and it should not be used to carry the Provisioning-Protocol specific error codes.  </li>
<li>The error codes supported by this specifications are listed in <a href="#tlv_error" class="xref">Section 4.3.5</a>.  </li>
</ul>

<p> </p>
<p id="rfc.section.4.3.5.p.4">Secondary Error Code (2 octets) </p>

<ul class="empty"><li>This field is used to convey an error at the encapsulation layer (i.e., the provisioning protocol error).  For example, this field can be used to convey a transport protocol error code (e.g., HTTP status code).  Do not use this field to convery EAP-CREDS specific errors.  </li></ul>

<p> </p>
<p id="rfc.section.4.3.5.p.5">Description ( &gt; 1 octet) </p>

<ul class="empty"><li>The Description field is optional (i.e., when the Description Size is set to zero) and carries information about the error that occurred.  The message may or may not be used by a user or an automated process for debugging purposes.  </li></ul>

<p> </p>
<h1 id="rfc.section.4.3.6">
<a href="#rfc.section.4.3.6">4.3.6.</a> <a href="#tlv_network_usage" id="tlv_network_usage">The Net-Usage TLV</a>
</h1>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |U| Desc Format |   Encoding    |   Net-Usage Data         ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.3.6.p.1">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - Net-Usage TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.6.p.2">Length (uint24) </p>

<ul class="empty"><li>Variable Length TLV (Value must be &gt; 2 )</li></ul>

<p> </p>
<p id="rfc.section.4.3.6.p.3">Desc Format (7 bits) </p>

<ul class="empty"><li>This field provide the expected data format for the Net-Usage Data. For example, the value in this field could be set to 'MUD' and have the 'U' bit set to '1' to provide the MUD-related information at credentials management time instead of at network-provisioning time (DHCP option). This possibility could help the Network controller to decide if the device shall be allowed to register its credentials or not.  The initial values for this field are listed in <a href="#iana_usage_metadata_type" class="xref">Section 7.9</a>.  </li></ul>

<p> </p>
<p id="rfc.section.4.3.6.p.4">Encoding (uint8) </p>

<ul class="empty"><li>Provides the indication of the Encoding the network usage description data is in. The allowed values for this field are listed in <a href="#iana_creds_encoding_type" class="xref">Section 7.7</a>.  </li></ul>

<p> </p>
<p id="rfc.section.4.3.6.p.5">The 'U' field (1 bit) </p>

<ul class="empty">
<li>The 'URL' bit ('U') is used to indicate if the value of the Net-Usage Data field is to be interpreted as a URL or as the actual data. In particular, if the value in the 'URL' bit is '1', then the value in the Net-Usage Data field is to be interpreted as the URL where the actual data can be downloaded from. Otherwise, if the 'URL' bit is set to '0', then the value in the Net-Usage Data field is to be interpreted as the actual data (not a URL referencing it).  </li>
<li>An example use of this bit is when the Peer wants to convey the URL of the MUD file <a href="#RFC8520" class="xref">[RFC8520]</a>. In this case, the Peer can set the Net-Usage Data field to the URL of the MUD file related to the Peer.  </li>
</ul>

<p> </p>
<p id="rfc.section.4.3.6.p.6">Net-Usage Data (octet string) </p>

<ul class="empty">
<li>This is additional information related to the device. In particular, this TLV can be used by the Peer to provide the Server with the description of the intended network usage or a URL that points to the same information.  </li>
<li>For example, this field can be used to convey a MUD file (Manufacturer Usage Description) or the latest firmware-update manifest.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.4.3.7">
<a href="#rfc.section.4.3.7">4.3.7.</a> <a href="#tlv_profiles" id="tlv_profiles">The Profile TLV</a>
</h1>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                    Profile Identifier                        ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.3.7.p.1">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - Profile Identifying Data TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.7.p.2">Length (uint24) </p>

<ul class="empty"><li>Length value should be &gt;= 1</li></ul>

<p> </p>
<p id="rfc.section.4.3.7.p.3">Profile Identifier (octet string) </p>

<ul class="empty">
<li>The Profile Identifier is used to provide indication to the other party about which profiles are supported when requesting credentials management.  </li>
<li>Also in this case, the data used in this field is left to be interpreted by the end-point and it is independent from the EAP-CREDS data types. This could be a raw byte value, a string, or a more complex structured data (e.g., an OID).  </li>
<li>An example of values for this field, an end-point could use the string representation (i.e., dotted representation) of the Object Identifier (OID) of the specific profile supported (e.g., could be defined in the Certificate Policy of the credentials' provider).  </li>
</ul>

<p> </p>
<h1 id="rfc.section.4.3.8">
<a href="#rfc.section.4.3.8">4.3.8.</a> <a href="#tlv_protocols" id="tlv_protocols">The Protocol TLV</a>
</h1>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         Protocol ID           |             Version           |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.3.8.p.1">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - Protocol TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.8.p.2">TLV Length (uint24) </p>

<ul class="empty"><li>Fixed TLV Length value of 4.</li></ul>

<p> </p>
<p id="rfc.section.4.3.8.p.3">Protocol ID (uint16) </p>

<ul class="empty"><li>The Protocol ID value carries the id of a supported provisioning protocol. The initial list of values for the provisioning protocol identifiers can be found in <a href="#iana_proto" class="xref">Section 7.1</a>.  </li></ul>

<p> </p>
<p id="rfc.section.4.3.8.p.4">Version (uint16) </p>

<ul class="empty"><li>The Version (Protocol Version) value represents the specific version of the identified provisioning protocol.  When no version is specified for a protocol (i.e., either it does not support multiple versions or it does not matter), the value of this field should be set to '0x0'.  </li></ul>

<p> </p>
<h1 id="rfc.section.4.3.9">
<a href="#rfc.section.4.3.9">4.3.9.</a> <a href="#tlv_proto_data" id="tlv_proto_data">The ProtoData TLV</a>
</h1>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                         Provisioning Data                    ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.3.9.p.1">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - ProtoData TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.9.p.2">Length (uint24) </p>

<ul class="empty"><li>3 octets</li></ul>

<p> </p>
<p id="rfc.section.4.3.9.p.3">Headers Data (&gt; 1 octet) </p>

<ul class="empty"><li>This field carries the provisioning protocol's messages.  </li></ul>

<p> </p>
<h1 id="rfc.section.4.3.10">
<a href="#rfc.section.4.3.10">4.3.10.</a> <a href="#tlv_proto_headers" id="tlv_proto_headers">The ProtoHeaders TLV</a>
</h1>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                           Headers Data                       ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.3.10.p.1">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - ProtoHeaders TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.10.p.2">Length (uint24) </p>

<ul class="empty"><li>3 octets</li></ul>

<p> </p>
<p id="rfc.section.4.3.10.p.3">Headers Data (&gt; 1 octet) </p>

<ul class="empty"><li>This field carries the meta-data (if any) that might be associated with the transport-layer normally used with the provisioning protocol. For example, this TLV can carry the set of HTTP headers required by EST or ACME.  </li></ul>

<p> </p>
<h1 id="rfc.section.4.3.11">
<a href="#rfc.section.4.3.11">4.3.11.</a> <a href="#tlv_prov_params" id="tlv_prov_params">The Params TLV</a>
</h1>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |            Min Length         |          Max Length           |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Algorithm   |     Flags     |     OBJECT IDENTIFIER (DER)  ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.3.11.p.1">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - Params TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.11.p.2">Length (uint24) </p>

<ul class="empty"><li>Provides the length of the TLV (&gt;= 6 octets)</li></ul>

<p> </p>
<p id="rfc.section.4.3.11.p.3">Min Length (uint16) </p>

<ul class="empty">
<li>Provides the minimum allowed size size for the credentials. This value has meaning depending on the context of the credentials, however sizes are always expressed in bytes.  </li>
<li>For example, when used with a symmetric key or a password, the ('Min Length') and ('Max Length') refer to the minimum and maximum size of the password data. The ('Algor OID') field can be omitted in this case.  </li>
<li>On the other hand, when referring public-key credentials, this field should carry the size of the modulus of the key. For example, for an RSA 2048 bit keys, the field should carry the value of 256.  For an ECDSA that uses the prime256r1 curve, this field should carry the value of 32 and the Algor OID should be the DER representation of the specific value of the curve (i.e., the DER representation of '1.2.840.10045.3.1.7').  </li>
</ul>

<p> </p>
<p id="rfc.section.4.3.11.p.4">Max Length (uint16) </p>

<ul class="empty">
<li>Provides the indication maximum size of the credentials. This value has meaning depending on the context of the credentials, however sizes are always expressed in bytes.  </li>
<li>The same considerations apply to this field as well as the ('Min Length') one discussed above.  </li>
</ul>

<p> </p>
<p id="rfc.section.4.3.11.p.5">Algorithm (uint8) </p>

<ul class="empty"><li>Provides the indication of the algorithm used for the generation of the credentials. The allowed values for this field are listed in <a href="#iana_creds_algor_type" class="xref">Section 7.4</a>.  </li></ul>

<p> </p>
<p id="rfc.section.4.3.11.p.6">Flags (uint8) </p>

<ul class="empty">
<li>Provides a BITMASK that can be used to provide information about the status of the credentials (e.g., if the use marks the credentials to be compromised). The bits have the following meaning: <ul class="empty">
<li>Bit 0 - Credentials (or part of it) are to be generated on the server</li>
<li>Bit 1 - Credentials (or part of it) are to be generated on the peer</li>
<li>Bit 2 - Credentials are to be generated on dedicated hardware</li>
<li>Bit 3 - Reserved</li>
<li>Bit 4 - Reserved</li>
<li>Bit 5 - Reserved</li>
<li>Bit 6 - Reserved</li>
<li>Bit 7 - Reserved</li>
</ul>
<p> </p>
</li>
<li>When using public-key based credentials, the bits 0 and 1 are mutually exclusive.  </li>
<li>When using passwords or shared secrets, if bit 0 is set, then the secret is generated by the server and then sent to the client. On the other hand, if bit 1 is set, then the secret is generated by the peer and then sent to the server. Ultimately, if both bits are set, then the Server generates the first part of the password and sends it to the Peer, while the Peer generates the second part of the password and sends it to the Server. The password to be used for future authentication is the concatenation of the two shares of the password: first the one from the Server, then the one from the Client.  </li>
<li>
<ul class="empty"><li>NOTE WELL: Last but not least, since these passwords/secrets are meant to be used in a automated fashion, there is no restriction around the character set to use or their interpretation.  Therefore, it is good practice to generate random pass-phrases that use the full 8-bit character set (on client and server) to maximize the secret's search space.  </li></ul>
<p> </p>
</li>
</ul>

<p> </p>
<p id="rfc.section.4.3.11.p.7">Object Identifier (binary; &gt; 1 octet) </p>

<ul class="empty"><li>Provides the indication of additional parameters that are needed to be encoded for the credentials. This value is used only when the credentials use public-key cryptography - this field carries additional information about the generation algorithm to be used.  We provide some useful values that can be used as reference: </li></ul>

<p> </p>
<div id="rfc.table.3"></div>
<div id="oid_table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Object Identifiers Examples</caption>
<thead><tr>
<th class="left">OID Name</th>
<th class="center">Dotted Representation</th>
<th class="center">Binary Encoding</th>
</tr></thead>
<tbody>
<tr>
<td class="left">secp256r1 curve</td>
<td class="center">1.2.840.10045.3.1.7</td>
<td class="center">06 08 2A 86 48 CE 3D 03 01 07</td>
</tr>
<tr>
<td class="left">secp384r1 curve</td>
<td class="center">1.2.840.10045.3.1.34</td>
<td class="center">06 08 2A 86 48 CE 3D 03 01 22</td>
</tr>
<tr>
<td class="left">secp521r1 curve</td>
<td class="center">1.2.840.10045.3.1.35</td>
<td class="center">06 08 2A 86 48 CE 3D 03 01 23</td>
</tr>
<tr>
<td class="left">X25519 curve</td>
<td class="center">1.3.101.110</td>
<td class="center">06 03 2B 65 6E</td>
</tr>
<tr>
<td class="left">X25519 curve</td>
<td class="center">1.3.101.110</td>
<td class="center">06 03 2B 65 6E</td>
</tr>
<tr>
<td class="left">X448 curve</td>
<td class="center">1.3.101.111</td>
<td class="center">06 03 2B 65 6F</td>
</tr>
<tr>
<td class="left">Ed25519 curve</td>
<td class="center">1.3.101.112</td>
<td class="center">06 03 2B 65 70</td>
</tr>
<tr>
<td class="left">Ed448 curve</td>
<td class="center">1.3.101.113</td>
<td class="center">06 03 2B 65 71</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.4.3.12">
<a href="#rfc.section.4.3.12">4.3.12.</a> <a href="#tlv_auth_token" id="tlv_auth_token">The Token TLV</a>
</h1>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |  Token Type   |    Encoding   |             Value            ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.3.12.p.1">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - Token TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.12.p.2">TLV Length (uint24) </p>

<ul class="empty"><li>Provides the length of the TLV (&gt; 3 octets)</li></ul>

<p> </p>
<p id="rfc.section.4.3.12.p.3">Token Type (uint8) </p>

<ul class="empty"><li>Provides the indication of the type of credentials. The allowed values for this field are listed in <a href="#iana_token" class="xref">Section 7.2</a>.  </li></ul>

<p> </p>
<p id="rfc.section.4.3.12.p.4">Encoding (uint8) </p>

<ul class="empty"><li>Provides the indication of the Encoding the credentials are in. The allowed values for this field are listed in <a href="#iana_creds_encoding_type" class="xref">Section 7.7</a>.  </li></ul>

<p> </p>
<p id="rfc.section.4.3.12.p.5">Value (octet string) </p>

<ul class="empty"><li>This field carries the data for the credentials.  </li></ul>

<p> </p>
<h1 id="rfc.section.4.3.13">
<a href="#rfc.section.4.3.13">4.3.13.</a> <a href="#tlv_version" id="tlv_version">The Version TLV</a>
</h1>
<pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Version     |
 +-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.4.3.13.p.1">TLV Type (uint8) </p>

<ul class="empty"><li>&lt;TBD&gt; - Version TLV</li></ul>

<p> </p>
<p id="rfc.section.4.3.13.p.2">TLV Length (uint24) </p>

<ul class="empty"><li>Provides the length of the TLV. The field has a fixed value of 1.</li></ul>

<p> </p>
<p id="rfc.section.4.3.13.p.3">Version (uint8) </p>

<ul class="empty">
<li>The Version field represents the specific version of the EAP-CREDS protocol that are supported by the end point. When multiple versions of EAP-CREDS are supported, multiple ('Version') TLVs can be used.  </li>
<li>When no version is specified (i.e., either it does not support multiple versions or it does not matter), the value of this field should be set to '0x0' (any version).  </li>
</ul>

<p> </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#creds_msg_types" id="creds_msg_types">EAP-CREDS Messages</a>
</h1>
<p id="rfc.section.5.p.1">This section describes each message and what TLVs are allowed or required.  EAP-CREDS defines the following values for the Message Type (Type): </p>
<div id="rfc.table.4"></div>
<div id="eap_creds_msgs_table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>EAP-CREDS Message Types</caption>
<thead><tr>
<th class="center">Message Type</th>
<th class="left">Name</th>
<th class="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="left">EAP-CREDS-Init</td>
<td class="left">Initialization Phase;</td>
</tr>
<tr>
<td class="center">1</td>
<td class="left">EAP-CREDS-Provisioning</td>
<td class="left">Carries Provisioning Protocol Messages;</td>
</tr>
<tr>
<td class="center">2</td>
<td class="left">EAP-CREDS-Validate</td>
<td class="left">Validates newly installed credentials;</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#creds_msg_init" id="creds_msg_init">The EAP-CREDS-Init Message</a>
</h1>
<p id="rfc.section.5.1.p.1">The EAP-CREDS-Init message type is used in Phase One only of EAP-CREDS. The message flow is depicted in <a href="#creds_phase_one" class="xref">Section 3.3</a>. This message supports the following TLVs: Version, Protocol, Creds-Info, and Error.  </p>
<h1 id="rfc.section.5.1.1">
<a href="#rfc.section.5.1.1">5.1.1.</a> <a href="#creds_msg_server_init" id="creds_msg_server_init">EAP Server's Init Message</a>
</h1>
<p id="rfc.section.5.1.1.p.1">EAP-CREDS starts with an ('EAP-CREDS-Init') message from the server. This message MAY contain zero, one, or more ('Version') TLVs and, optionally, a ('Challenge-Data') TLV.  </p>
<p id="rfc.section.5.1.1.p.2">The first message from the server is the one that starts Phase One, therefore the Server MUST set the headers' 'S' (Start) bit to '1' (Start) and the headers' 'Phase' value to '1' (Phase One).  </p>
<p id="rfc.section.5.1.1.p.3">The Server uses one or more ('Version') TLVs in the EAP-Request/EAP-CREDS(Type=Init) message to provide the Peer with the list of EAP-CREDS versions supported. If omitted, the implicit version of EAP-CREDS used in the session is one ('0x1').  If the Server detects multiple occurrences of this TLV in the reply from the Peer, an error shall be issued and the EAP-CREDS session should be terminated.  </p>
<p id="rfc.section.5.1.1.p.4">In case Token-Based registration is enabled on the Server, the Server MUST include, in its Init message, a ('Challenge-Data') field that can be used by the client to provide challenge data for proof-of-possession of secrets.  </p>
<h1 id="rfc.section.5.1.2">
<a href="#rfc.section.5.1.2">5.1.2.</a> <a href="#creds_msg_peer_init" id="creds_msg_peer_init">EAP Peer's Init Message</a>
</h1>
<p id="rfc.section.5.1.2.p.1">The Peer MUST reply to the Server's ('EAP-CREDS-Init') message with its own ('EAP-CREDS-Init') one. The Peer SHOULD include one ('Version') TLV in its first message to indicate the version of EAP-CREDS that the client wants to use for the session. The Peer MUST also provide the list of supported provisioning protocols (via one or more the 'Protocol' TLV), the list and status of the installed credentials (via the 'Creds-Info' TLV). The Peer MAY include authorization data when registering new credentials (e.g., an authorization token or a device certificate) via the ('Token') and ('Challenge-Response') TLV.  </p>
<p id="rfc.section.5.1.2.p.2">The Peer MUST include one ('Creds-Info') TLV for each credential the Network is authorized to manage. Typically, a Peer will include only one ('Creds-Info') TLV in its ('EAP-CREDS-Init') message, but there might be cases where multiple types of credentials are available and selected depending on the location and other factors (e.g., X.509 certificate and username/password combination).  </p>
<p id="rfc.section.5.1.2.p.3">In case the Peer does not have any credentials available yet, it does not add any ('Creds-Info') TLV - leaving the Server with the only action possible: Registration. In this case, the Peer SHOULD include authorization information via the ('Token') TLV as described in <a href="#creds_msg_peer_init_token" class="xref">Section 5.1.2.1</a>.  Additionally, the Peer can add the ('Profile') TLV to indicate a preferred profile for the credentials.  </p>
<h1 id="rfc.section.5.1.2.1">
<a href="#rfc.section.5.1.2.1">5.1.2.1.</a> <a href="#creds_msg_peer_init_token" id="creds_msg_peer_init_token">Bootstrapping Peer's Trustworthiness</a>
</h1>
<p id="rfc.section.5.1.2.1.p.1">When the Peer does not have any valid credentials for the Network that it is authenticating to, it does not provide any ('Creds-Info') TLV. This indicates to the Server that new credentials MUST be registered before the Peer is allowed on the network.  </p>
<p id="rfc.section.5.1.2.1.p.2">The Registration process might rely on information exchanged during the Provisioning Process in Phase Two. However, if an authorization mechanism is not available from the supported provisioning protocol and no credentials are available on the Peer, EAP-CREDS provides a simple mechanism for the Peer to leverage an out-of-band token/passphrase/ott that may be already available on the Peer (e.g., a device certificate or a 'spendable' credentials token like a kerberos ticket or a crypto-currency transaction) and that can be verified by the Server.  </p>
<p id="rfc.section.5.1.2.1.p.3">In particular, when the Peer wants to register new credentials (and the Server requires the use of additional authorization data) it may need to provide (a) a Token, (b) a challenge value, and (c) a response to the challenge value. To do so, the Peer MUST encode the token in a ('Token') TLV, the challenge value in a ('Challenge-Data') TLV, and, finally, the response to the challenge in the ('Challenge-Response') TLV.  </p>
<p id="rfc.section.5.1.2.1.p.4">The use of ('Challenge-Data') and ('Challenge-Response') TLVs is optional, however it is suggested that if a token is used for bootstrapping the trust, it should provide a way to verify a secret associated with it.  </p>
<p id="rfc.section.5.1.2.1.p.5">It is also very important that the authorization token is disclosed only to authorized servers - the Peer MUST NOT disclose authorization tokens that are not meant for the network that is being accessed. This can be done, usually, by verifying the identity of the Server first (in the outer mechanism) and then verify that the target of the Token is the Server the Client is talking to.  </p>
<h1 id="rfc.section.5.1.3">
<a href="#rfc.section.5.1.3">5.1.3.</a> <a href="#creds_msg_protoflow" id="creds_msg_protoflow">The EAP-CREDS-Provisioning Message</a>
</h1>
<p id="rfc.section.5.1.3.p.1">The EAP-CREDS-Provisioning message type is used in Phase Two only of EAP-CREDS. The message flow is depicted in <a href="#creds_phase_two" class="xref">Section 3.4</a>. This message type supports the following TLVs: Protocol, Profile, Creds-Info, ProtoHeaders, ProtoData, Token, and Error.  </p>
<p id="rfc.section.5.1.3.p.2">After the exchange of phase one messages, the Server MAY start phase two by issuing an ('EAP-CREDS-Provisioning') message for the Peer where it encodes all the required details for starting the provisioning process.  In particular, the server sends the selected ('Action'), ('Protocol'), and metadata to the client in a EAP-Request/EAP-CREDS(Type=Provisioning) message.  The header's 'S' (Start) bit MUST be set to '1' (Start) and the 'Phase' value set to '2' (Phase Two begins).  </p>
<p></p>

<ul class="empty"><li>NOTE WELL: After the initial message, the only TLVs that are allowed in messages coming from the server are the usual ('ProtoHeaders') ('ProtoData'), and ('Error').  </li></ul>

<p> </p>
<p id="rfc.section.5.1.3.p.4">The client checks that all the selected parameters are supported for the selected credentials and, if no errors are detected, it sends its first ('EAP-CREDS-Provisioning') message to the Server with the ('ProtoHeaders') and ('ProtoData') TLVs only.  </p>
<p id="rfc.section.5.1.3.p.5">From now on, the conversation between the Peer and the Server continues until an error is detected or the provisioning protocol completes successfully.  </p>
<p id="rfc.section.5.1.3.p.6">If no other actions, the server MAY continue with phase three or issue a success message and terminate the EAP session.  </p>
<h1 id="rfc.section.5.1.4">
<a href="#rfc.section.5.1.4">5.1.4.</a> <a href="#creds_msg_validate" id="creds_msg_validate">The EAP-CREDS-Validate Message</a>
</h1>
<p id="rfc.section.5.1.4.p.1">The EAP-CREDS-Validate message type is used in Phase Three only of EAP-CREDS. The message flow is depicted in <a href="#creds_phase_three" class="xref">Section 3.5</a>. This message type supports the following TLVs: Protocol, Creds-Info, ProtoHeaders, ProtoData, Token, and Error.  </p>
<p id="rfc.section.5.1.4.p.2">After Phase One (and/or Phase Two) ends, the Server MAY start phase three by issuing an ('EAP-CREDS-Validate') message for the Peer where it encodes all the required details for starting the validation process.  In particular, the server sends the ('Creds-Info'), a ('Challenge-Data'), and the ('Phase') fields in a EAP-Request/EAP-CREDS(Type=Validate) message.  The ('Phase') field should carry the '1' value for the 'S' (Start) bit (Start) and the number '3' for its value (Phase Three begins).  </p>
<p id="rfc.section.5.1.4.p.3">The Peer generates the answer to the Challenge and sends back a EAP-Response/EAP-CREDS(Type=Validate) message with the ('Challenge-Response') and an optional ('Challenge-Data') field (only for server-side validation of the symmetric credentials). If the Peer requested server-side validation of the credentials, the Server MUST include (if a symmetric secret) the response to the Peer-issued ('Challenge-Data') TLV by computing the response and adding it to the ('Challenge-Response') TLV in its reply.  </p>
<p id="rfc.section.5.1.4.p.4">Finally, in the last message, the Server (if Phase Three is to be ended) SHALL include the ('Phase') field with the 'S' (Start) bit set to '0' (end of phase) and the value set to '3' (Phase Three ended).  </p>
<p id="rfc.section.5.1.4.p.5">At this point, EAP-CREDS has terminated all possible operations and can be terminated.  The Server can now terminate the EAP session successfully. In case the Peer was not authenticated during the tunnel establishment (i.e., no credentials were already available on the Peer), the Server should terminate the EAP session with a Failure (thus requiring the device to re-attach and authenticate to the network - phase two should have provided the Peer with the credentials to use for authenticating to the Network).  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#err_handling" id="err_handling">Error Handling in EAP-CREDS</a>
</h1>
<p id="rfc.section.6.p.1">This section provides a description of the error handling by using the CREDS-Error-TLV in a CREDS message.  &lt;TBD&gt; </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.7.p.1">This document uses a new EAP type, EAP-CREDS, whose value (TBD) MUST be allocated by IANA from the EAP TYPEs sub-registry of the RADIUS registry.  This section provides guidance to the Internet Assigned Numbers Authority (IANA) regarding registration of values related to the EAP-CREDS protocol, in accordance with <a href="#RFC8126" class="xref">[RFC8126]</a>.  </p>
<p id="rfc.section.7.p.2">The EAP Method Type number for EAP-CREDS needs to be assigned.  </p>
<p id="rfc.section.7.p.3">This document also requires IANA to create new registries as defined in the following subsections.  </p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#iana_proto" id="iana_proto">Provisioning Protocols</a>
</h1>
<div id="rfc.table.5"></div>
<div id="iana_proto_table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>EAP-CREDS Inner Protocol Identifiers</caption>
<thead><tr>
<th class="center">Message Type</th>
<th class="left">Purpose</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="left">Unspecified</td>
</tr>
<tr>
<td class="center">1</td>
<td class="left">Simple Provisioning Protocol (SPP)</td>
</tr>
<tr>
<td class="center">2</td>
<td class="left">Basic Certificate Management Protocol (CMP-S)</td>
</tr>
<tr>
<td class="center">3</td>
<td class="left">Full Certificate Management Protocol (CMP-F)</td>
</tr>
<tr>
<td class="center">4</td>
<td class="left">Enrollment over Secure Transport (EST)</td>
</tr>
<tr>
<td class="center">5</td>
<td class="left">Certificate Management over CMS (CMC)</td>
</tr>
<tr>
<td class="center">6</td>
<td class="left">Automatic Certificate Management Environment (ACME)</td>
</tr>
<tr>
<td class="center">...</td>
<td class="left">...</td>
</tr>
<tr>
<td class="center">49141 ... 65534</td>
<td class="left">Vendor Specific</td>
</tr>
</tbody>
</table>
<p id="rfc.section.7.1.p.1">Assignment of new values for new cryptosuites MUST be done through IANA with "Specification Required" and "IESG Approval" as defined in <a href="#RFC8126" class="xref">[RFC8126]</a>.  </p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#iana_token" id="iana_token">Token Types</a>
</h1>
<div id="rfc.table.6"></div>
<div id="iana_token_table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Token Types in ('Token') TLV</caption>
<thead><tr>
<th class="center">Token Type</th>
<th class="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="left">Unspecified</td>
</tr>
<tr>
<td class="center">1</td>
<td class="left">JWT</td>
</tr>
<tr>
<td class="center">2</td>
<td class="left">Kerberos</td>
</tr>
<tr>
<td class="center">3</td>
<td class="left">OAuth</td>
</tr>
<tr>
<td class="center">4</td>
<td class="left">Certificate</td>
</tr>
<tr>
<td class="center">200..254</td>
<td class="left">Vendor Specific</td>
</tr>
</tbody>
</table>
<p id="rfc.section.7.2.p.1">Assignment of new values for new Message Types MUST be done through IANA with "Expert Review" as defined in <a href="#RFC8126" class="xref">[RFC8126]</a>.  </p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> <a href="#iana_creds_type" id="iana_creds_type">Credentials Types</a>
</h1>
<div id="rfc.table.7"></div>
<div id="iana_creds_type_table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Credentials Types in ('Creds-Info') TLV</caption>
<thead><tr>
<th class="center">Credentials Type</th>
<th class="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="left">X.509 Certificate</td>
</tr>
<tr>
<td class="center">1</td>
<td class="left">Public Key</td>
</tr>
<tr>
<td class="center">2</td>
<td class="left">Symmetric Key</td>
</tr>
<tr>
<td class="center">3</td>
<td class="left">Username and Password</td>
</tr>
<tr>
<td class="center">4</td>
<td class="left">AKA Subscriber Key</td>
</tr>
<tr>
<td class="center">5</td>
<td class="left">Bearer Token</td>
</tr>
<tr>
<td class="center">6</td>
<td class="left">One-Time Token</td>
</tr>
<tr>
<td class="center">7</td>
<td class="left">API Key</td>
</tr>
</tbody>
</table>
<p id="rfc.section.7.3.p.1">Assignment of new values for new Message Types MUST be done through IANA with "Expert Review" as defined in <a href="#RFC8126" class="xref">[RFC8126]</a>.  </p>
<h1 id="rfc.section.7.4">
<a href="#rfc.section.7.4">7.4.</a> <a href="#iana_creds_algor_type" id="iana_creds_algor_type">Credentials Algorithms</a>
</h1>
<div id="rfc.table.8"></div>
<div id="iana_creds_algor_type_table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Credentials Algorithms in ('Param') TLV</caption>
<thead><tr>
<th class="center">ID</th>
<th class="left">Algorithm</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="left">None</td>
</tr>
<tr>
<td class="center">1</td>
<td class="left">RSA</td>
</tr>
<tr>
<td class="center">2</td>
<td class="left">ECDSA</td>
</tr>
<tr>
<td class="center">3</td>
<td class="left">XMMS</td>
</tr>
<tr>
<td class="center">4</td>
<td class="left">AKA Subscriber Key</td>
</tr>
<tr>
<td class="center">5</td>
<td class="left">OAuth</td>
</tr>
<tr>
<td class="center">6</td>
<td class="left">Kerberos4</td>
</tr>
<tr>
<td class="center">7</td>
<td class="left">Kerberos5</td>
</tr>
<tr>
<td class="center">200-254</td>
<td class="left">Reserved</td>
</tr>
</tbody>
</table>
<p id="rfc.section.7.4.p.1">Assignment of new values for new Message Types MUST be done through IANA with "Expert Review" as defined in <a href="#RFC8126" class="xref">[RFC8126]</a>.  </p>
<h1 id="rfc.section.7.5">
<a href="#rfc.section.7.5">7.5.</a> <a href="#eap_creds_challenge_types" id="eap_creds_challenge_types">Challenge Types</a>
</h1>
<div id="rfc.table.9"></div>
<div id="eap_creds_challenge_types_table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Challenge Type in ('Challenge') TLV</caption>
<thead><tr>
<th class="center">ID</th>
<th class="left">Data Type</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="left">Not Specified</td>
</tr>
<tr>
<td class="center">1</td>
<td class="left">EAP-CREDS-ASYMMETRIC</td>
</tr>
<tr>
<td class="center">2</td>
<td class="left">EAP-CREDS-SYMMETRIC</td>
</tr>
</tbody>
</table>
<p id="rfc.section.7.5.p.1">Assignment of new values for new Message Types MUST be done through IANA with "Expert Review" as defined in <a href="#RFC8126" class="xref">[RFC8126]</a>.  </p>
<h1 id="rfc.section.7.6">
<a href="#rfc.section.7.6">7.6.</a> <a href="#iana_net_usage_type" id="iana_net_usage_type">Network Usage Datatypes</a>
</h1>
<div id="rfc.table.10"></div>
<div id="iana_net_usage_table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Network Usage Datatypes in ('Net-Usage') TLV</caption>
<thead><tr>
<th class="center">ID</th>
<th class="left">Data Type</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="left">Vendor-Specific</td>
</tr>
<tr>
<td class="center">1</td>
<td class="left">Manufacturer Usage Description <a href="#RFC8520" class="xref">[RFC8520]</a>
</td>
</tr>
<tr>
<td class="center">2</td>
<td class="left">Network Access Granting System </td>
</tr>
<tr>
<td class="center">3</td>
<td class="left">Firmware Manifest</td>
</tr>
<tr>
<td class="center">4..127</td>
<td class="left">Reserved for Future Use</td>
</tr>
</tbody>
</table>
<p id="rfc.section.7.6.p.1">Assignment of new values for new Message Types MUST be done through IANA with "Expert Review" as defined in <a href="#RFC8126" class="xref">[RFC8126]</a>.  </p>
<h1 id="rfc.section.7.7">
<a href="#rfc.section.7.7">7.7.</a> <a href="#iana_creds_encoding_type" id="iana_creds_encoding_type">Credentials Encoding</a>
</h1>
<div id="rfc.table.11"></div>
<div id="iana_creds_encoding_type_table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Credentials Encoding in ('Token') TLV</caption>
<thead><tr>
<th class="center">ID</th>
<th class="left">Encoding</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="left">None (Raw)</td>
</tr>
<tr>
<td class="center">1</td>
<td class="left">DER</td>
</tr>
<tr>
<td class="center">2</td>
<td class="left">PEM</td>
</tr>
<tr>
<td class="center">3</td>
<td class="left">Base64</td>
</tr>
<tr>
<td class="center">4</td>
<td class="left">JSON</td>
</tr>
<tr>
<td class="center">5</td>
<td class="left">XML</td>
</tr>
<tr>
<td class="center">6</td>
<td class="left">ASCII</td>
</tr>
<tr>
<td class="center">7</td>
<td class="left">UTF-8</td>
</tr>
<tr>
<td class="center">200-254</td>
<td class="left">Reserved</td>
</tr>
</tbody>
</table>
<p id="rfc.section.7.7.p.1">Assignment of new values for new Message Types MUST be done through IANA with "Expert Review" as defined in <a href="#RFC8126" class="xref">[RFC8126]</a>.  </p>
<h1 id="rfc.section.7.8">
<a href="#rfc.section.7.8">7.8.</a> <a href="#iana_creds_action" id="iana_creds_action">Action Types</a>
</h1>
<div id="rfc.table.12"></div>
<div id="iana_action_table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Action Types in ('Action') TLV</caption>
<thead><tr>
<th class="center">ID</th>
<th class="left">Data Type</th>
<th class="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="left">Registration</td>
<td class="left">Registers New Credentials</td>
</tr>
<tr>
<td class="center">1</td>
<td class="left">Renewal</td>
<td class="left">Renew an Existing Credential</td>
</tr>
<tr>
<td class="center">2</td>
<td class="left">Remove</td>
<td class="left">Removes an Existing Credential</td>
</tr>
<tr>
<td class="center">200-254</td>
<td class="left">n/a</td>
<td class="left">Reserved</td>
</tr>
</tbody>
</table>
<p id="rfc.section.7.8.p.1">Assignment of new values for new Message Types MUST be done through IANA with "Expert Review" as defined in <a href="#RFC8126" class="xref">[RFC8126]</a>.  </p>
<h1 id="rfc.section.7.9">
<a href="#rfc.section.7.9">7.9.</a> <a href="#iana_usage_metadata_type" id="iana_usage_metadata_type">Usage Metadata Types</a>
</h1>
<div id="rfc.table.13"></div>
<div id="iana_usage_metadata_type_table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Usage Metadata Types in ('Net-Usage') TLV</caption>
<thead><tr>
<th class="center">Type</th>
<th class="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="left">Binary (Unspecified)</td>
</tr>
<tr>
<td class="center">1</td>
<td class="left">MUD File</td>
</tr>
<tr>
<td class="center">2</td>
<td class="left">TEEP Manifest</td>
</tr>
</tbody>
</table>
<p id="rfc.section.7.9.p.1">Assignment of new values for new Message Types MUST be done through IANA with "Expert Review" as defined in <a href="#RFC8126" class="xref">[RFC8126]</a>.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.8.p.1">Several security considerations need to be explicitly considered for the system administrators and application developers to understand the weaknesses of the overall architecture.  </p>
<p id="rfc.section.8.p.2">The most important security consideration when deploying EAP-CREDS is related to the security of the outer channel. In particular, EAP-CREDS assumes that the communication channel has been properly authenticated and that the information exchanged between the Peer and the Server are protected (i.e., confidentiality and integrity).  </p>
<p id="rfc.section.8.p.3">For example, if certificate-based authentication is used, the server presents a certificate to the peer as part of the trust establishment (or negotiation).  The peer SHOULD verify the validity of the EAP server certificate and SHOULD also examine the EAP server name presented in the certificate in order to determine whether the EAP server can be trusted.  When performing server certificate validation, implementations MUST provide support for the rules in <a href="#RFC5280" class="xref">[RFC5280]</a> for validating certificates against a known trust anchor.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#acks" id="acks">Acknowledgments</a>
</h1>
<p id="rfc.section.9.p.1">The authors would like to thank everybody who provided insightful comments and helped in the definition of the deployment considerations.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3279">[RFC3279]</b></td>
<td class="top">
<a>Bassham, L.</a>, <a>Polk, W.</a> and <a>R. Housley</a>, "<a href="https://tools.ietf.org/html/rfc3279">Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 3279, DOI 10.17487/RFC3279, April 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3748">[RFC3748]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Blunk, L.</a>, <a>Vollbrecht, J.</a>, <a>Carlson, J.</a> and <a>H. Levkowetz</a>, "<a href="https://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>", RFC 3748, DOI 10.17487/RFC3748, June 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4055">[RFC4055]</b></td>
<td class="top">
<a>Schaad, J.</a>, <a>Kaliski, B.</a> and <a>R. Housley</a>, "<a href="https://tools.ietf.org/html/rfc4055">Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 4055, DOI 10.17487/RFC4055, June 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4210">[RFC4210]</b></td>
<td class="top">
<a>Adams, C.</a>, <a>Farrell, S.</a>, <a>Kause, T.</a> and <a>T. Mononen</a>, "<a href="https://tools.ietf.org/html/rfc4210">Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)</a>", RFC 4210, DOI 10.17487/RFC4210, September 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4491">[RFC4491]</b></td>
<td class="top">
<a>Leontiev, S.</a> and <a>D. Shefanovski</a>, "<a href="https://tools.ietf.org/html/rfc4491">Using the GOST R 34.10-94, GOST R 34.10-2001, and GOST R 34.11-94 Algorithms with the Internet X.509 Public Key Infrastructure Certificate and CRL Profile</a>", RFC 4491, DOI 10.17487/RFC4491, May 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5272">[RFC5272]</b></td>
<td class="top">
<a>Schaad, J.</a> and <a>M. Myers</a>, "<a href="https://tools.ietf.org/html/rfc5272">Certificate Management over CMS (CMC)</a>", RFC 5272, DOI 10.17487/RFC5272, June 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="https://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, DOI 10.17487/RFC5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6402">[RFC6402]</b></td>
<td class="top">
<a>Schaad, J.</a>, "<a href="https://tools.ietf.org/html/rfc6402">Certificate Management over CMS (CMC) Updates</a>", RFC 6402, DOI 10.17487/RFC6402, November 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7030">[RFC7030]</b></td>
<td class="top">
<a>Pritikin, M.</a>, <a>Yee, P.</a> and <a>D. Harkins</a>, "<a href="https://tools.ietf.org/html/rfc7030">Enrollment over Secure Transport</a>", RFC 7030, DOI 10.17487/RFC7030, October 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8126">[RFC8126]</b></td>
<td class="top">
<a>Cotton, M.</a>, <a>Leiba, B.</a> and <a>T. Narten</a>, "<a href="https://tools.ietf.org/html/rfc8126">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 8126, DOI 10.17487/RFC8126, June 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8520">[RFC8520]</b></td>
<td class="top">
<a>Lear, E.</a>, <a>Droms, R.</a> and <a>D. Romascanu</a>, "<a href="https://tools.ietf.org/html/rfc8520">Manufacturer Usage Description Specification</a>", RFC 8520, DOI 10.17487/RFC8520, March 2019.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8555">[RFC8555]</b></td>
<td class="top">
<a>Barnes, R.</a>, <a>Hoffman-Andrews, J.</a>, <a>McCarney, D.</a> and <a>J. Kasten</a>, "<a href="https://tools.ietf.org/html/rfc8555">Automatic Certificate Management Environment (ACME)</a>", RFC 8555, DOI 10.17487/RFC8555, March 2019.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Massimiliano Pala</span> 
	  <span class="n hidden">
		<span class="family-name">Pala</span>
	  </span>
	</span>
	<span class="org vcardline">CableLabs</span>
	<span class="adr">
	  <span class="vcardline">858 Coal Creek Cir</span>

	  <span class="vcardline">
		<span class="locality">Louisville</span>,  
		<span class="region">CO</span> 
		<span class="code">80027</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:m.pala@openca.org">m.pala@openca.org</a></span>

<span class="vcardline">URI: <a href="http://www.linkedin.com/in/mpala">http://www.linkedin.com/in/mpala</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Yuan Tian</span> 
	  <span class="n hidden">
		<span class="family-name">Tian</span>
	  </span>
	</span>
	<span class="org vcardline">CableLabs</span>
	<span class="adr">
	  <span class="vcardline">858 Coal Creek Cir</span>

	  <span class="vcardline">
		<span class="locality">Louisville</span>,  
		<span class="region">CO</span> 
		<span class="code">80027</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:y.tian@cablelabs.com">y.tian@cablelabs.com</a></span>

<span class="vcardline">URI: <a href="http://www.linkedin.com/in/ytian21">http://www.linkedin.com/in/ytian21</a></span>

  </address>
</div>

</body>
</html>
