<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Credentials Provisioning and Management via EAP (EAP-CREDS)</title>
<meta content="Massimiliano Pala" name="author">
<meta content="Yuan Tian" name="author">
<meta content="
       
   With the increase number of devices, protocols, and applications that
   rely on strong credentials (e.g., digital certificates, keys, or
   tokens) for network access, the need for a standardized credentials
   provisioning and management framework is paramount.  The 802.1x
   architecture allows for entities (e.g., devices, applications, etc.)
   to authenticate to the network by providing a communication channel
   where different methods can be used to exchange different types of
   credentials.  However, the need for managing these credentials (i.e.,
   provisioning and renewal) is still a hard problem to solve.  Usually,
   credentails used in an access network can be in different levels
   (e.g., network-level, user-level) and sometimes tend to live
   unmanaged for quite a long time due to the challenges of operation
   and implementation.  EAP-CREDS (RFC XXXX), if implemented in Managed
   Networks (e.g., Cable Modems), could enable our operators to offer a
   registration and credentials management service integrated in the
   home WiFi thus enabling visibility about registered devices.  During
   initialization, EAP-CREDS also allows for MUD files or URLs to be
   transferred between the EAP Peer and the EAP Server, thus giving
   detailed visibility about devices when they are provisioned with
   credentials for accessing the networks.  The possibility provided by
   EAP-CREDS can help to secure home or business networks by leveraging
   the synergies of the security teams from the network operators thanks
   to the extended knowledge of what and how is registered/
   authenticated.  This specifications define how to support the
   provisioning and management of authentication credentials that can be
   exploited in different environments (e.g., Wired, WiFi, cellular,
   etc.) to users and/or devices by using EAP together with standard
   provisioning protocols. 
    " name="description">
<meta content="xml2rfc 3.12.2" name="generator">
<meta content="draft-pala-tian-eap-creds-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.2
    Python 3.10.6
    weasyprint 54.1
-->
<link href="draft-pala-tian-eap-creds.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EAP-CREDS</td>
<td class="right">May 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Pala &amp; Tian</td>
<td class="center">Expires 2 November 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-pala-tian-eap-creds-03</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-05-01" class="published">1 May 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-11-02">2 November 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M.P. Pala</div>
<div class="org">CableLabs</div>
</div>
<div class="author">
      <div class="author-name">Y.T. Tian</div>
<div class="org">CableLabs</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Credentials Provisioning and Management via EAP (EAP-CREDS)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
   With the increase number of devices, protocols, and applications that
   rely on strong credentials (e.g., digital certificates, keys, or
   tokens) for network access, the need for a standardized credentials
   provisioning and management framework is paramount.  The 802.1x
   architecture allows for entities (e.g., devices, applications, etc.)
   to authenticate to the network by providing a communication channel
   where different methods can be used to exchange different types of
   credentials.  However, the need for managing these credentials (i.e.,
   provisioning and renewal) is still a hard problem to solve.  Usually,
   credentails used in an access network can be in different levels
   (e.g., network-level, user-level) and sometimes tend to live
   unmanaged for quite a long time due to the challenges of operation
   and implementation.  EAP-CREDS (RFC XXXX), if implemented in Managed
   Networks (e.g., Cable Modems), could enable our operators to offer a
   registration and credentials management service integrated in the
   home WiFi thus enabling visibility about registered devices.  During
   initialization, EAP-CREDS also allows for MUD files or URLs to be
   transferred between the EAP Peer and the EAP Server, thus giving
   detailed visibility about devices when they are provisioned with
   credentials for accessing the networks.  The possibility provided by
   EAP-CREDS can help to secure home or business networks by leveraging
   the synergies of the security teams from the network operators thanks
   to the extended knowledge of what and how is registered/
   authenticated.  This specifications define how to support the
   provisioning and management of authentication credentials that can be
   exploited in different environments (e.g., Wired, WiFi, cellular,
   etc.) to users and/or devices by using EAP together with standard
   provisioning protocols.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 2 November 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-requirements-notation" class="xref">Requirements notation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-overview-of-existing-soluti" class="xref">Overview of existing solutions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-scope-statement" class="xref">Scope Statement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-eap-creds-as-tunneled-mecha" class="xref">EAP-CREDS as tunneled mechanism only</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-fragmentation-support" class="xref">Fragmentation Support</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-encapsulating-provisioning-" class="xref">Encapsulating Provisioning Protocols in EAP-CREDS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-algorithm-requirements" class="xref">Algorithm Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="xref">2.7</a>.  <a href="#name-notation" class="xref">Notation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-eap-creds-protocol" class="xref">EAP-CREDS Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-message-flow" class="xref">Message Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-phase-transitioning-rules" class="xref">Phase Transitioning Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-phase-one-initialization" class="xref">Phase One: Initialization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-phase-two-provisioning" class="xref">Phase Two: Provisioning</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-phase-three-validation" class="xref">Phase Three: Validation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-eap-creds-message-format" class="xref">EAP-CREDS Message Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-message-header" class="xref">Message Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-message-payload" class="xref">Message Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-eap-creds-defined-tlvs" class="xref">EAP-CREDS defined TLVs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-the-action-tlv" class="xref">The Action TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-the-challenge-data-tlv" class="xref">The Challenge-Data TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="xref">4.3.3</a>.  <a href="#name-the-challenge-response-tlv" class="xref">The Challenge-Response TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.4">
                    <p id="section-toc.1-1.4.2.3.2.4.1"><a href="#section-4.3.4" class="xref">4.3.4</a>.  <a href="#name-the-creds-info-tlv" class="xref">The Creds-Info TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.5">
                    <p id="section-toc.1-1.4.2.3.2.5.1"><a href="#section-4.3.5" class="xref">4.3.5</a>.  <a href="#name-the-error-tlv" class="xref">The Error TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.6">
                    <p id="section-toc.1-1.4.2.3.2.6.1"><a href="#section-4.3.6" class="xref">4.3.6</a>.  <a href="#name-the-net-usage-tlv" class="xref">The Net-Usage TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.7">
                    <p id="section-toc.1-1.4.2.3.2.7.1"><a href="#section-4.3.7" class="xref">4.3.7</a>.  <a href="#name-the-profile-tlv" class="xref">The Profile TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.8">
                    <p id="section-toc.1-1.4.2.3.2.8.1"><a href="#section-4.3.8" class="xref">4.3.8</a>.  <a href="#name-the-protocol-tlv" class="xref">The Protocol TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.9">
                    <p id="section-toc.1-1.4.2.3.2.9.1"><a href="#section-4.3.9" class="xref">4.3.9</a>.  <a href="#name-the-protodata-tlv" class="xref">The ProtoData TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.10">
                    <p id="section-toc.1-1.4.2.3.2.10.1"><a href="#section-4.3.10" class="xref">4.3.10</a>. <a href="#name-the-protoheaders-tlv" class="xref">The ProtoHeaders TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.11">
                    <p id="section-toc.1-1.4.2.3.2.11.1"><a href="#section-4.3.11" class="xref">4.3.11</a>. <a href="#name-the-params-tlv" class="xref">The Params TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.12">
                    <p id="section-toc.1-1.4.2.3.2.12.1"><a href="#section-4.3.12" class="xref">4.3.12</a>. <a href="#name-the-token-tlv" class="xref">The Token TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.13">
                    <p id="section-toc.1-1.4.2.3.2.13.1"><a href="#section-4.3.13" class="xref">4.3.13</a>. <a href="#name-the-version-tlv" class="xref">The Version TLV</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-eap-creds-messages" class="xref">EAP-CREDS Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-the-eap-creds-init-message" class="xref">The EAP-CREDS-Init Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-eap-servers-init-message" class="xref">EAP Server's Init Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-eap-peers-init-message" class="xref">EAP Peer's Init Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="xref">5.1.3</a>.  <a href="#name-the-eap-creds-provisioning-" class="xref">The EAP-CREDS-Provisioning Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="xref">5.1.4</a>.  <a href="#name-the-eap-creds-validate-mess" class="xref">The EAP-CREDS-Validate Message</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-error-handling-in-eap-creds" class="xref">Error Handling in EAP-CREDS</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-provisioning-protocols" class="xref">Provisioning Protocols</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-token-types" class="xref">Token Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-credentials-types" class="xref">Credentials Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-credentials-algorithms" class="xref">Credentials Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-challenge-types" class="xref">Challenge Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="xref">7.6</a>.  <a href="#name-network-usage-datatypes" class="xref">Network Usage Datatypes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="xref">7.7</a>.  <a href="#name-credentials-encoding" class="xref">Credentials Encoding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="xref">7.8</a>.  <a href="#name-action-types" class="xref">Action Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="xref">7.9</a>.  <a href="#name-usage-metadata-types" class="xref">Usage Metadata Types</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sect-1">
<section id="section-1">
      <h2 id="name-requirements-notation">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-requirements-notation" class="section-name selfRef">Requirements notation</a>
      </h2>
<p id="section-1-1">
   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-2">
<section id="section-2">
      <h2 id="name-introduction">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-2-1">
   Many environments are, today, moving towards requiring strong
   authentication when it comes to gain access to networks.  The 802.1x
   architecture provides network administrators with the possibility to
   check credentials presented by a device even before providing any
   connectivity or IP services to it.  However, the provisioning and
   management of these credentials is a hard problem to solve and many
   vendors opt for long-lived credentials that can not be easily
   revoked, replaced, or simply renewed.  This specification addresses
   the problem of providing a simple-to-use and simple-to-deploy conduit
   for credentials management by extending the EAP protocol to support
   credentials provisioning and management functionality.  In
   particular, the EAP-CREDS method defined here provides a generic
   framework that can carry the messages for provisioning different
   types of credentials.  EAP-CREDS cannot be used as a stand-alone
   method, it is required that EAP-CREDS is used as an inner method of
   EAP-TLS, EAP-TEAP, or any other tunneling method that can provide the
   required secrecy and (at minimum) server-side authentication to make
   sure that the communication is protected and with the right server.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="sect-2.1">
<section id="section-2.1">
        <h3 id="name-overview-of-existing-soluti">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-overview-of-existing-soluti" class="section-name selfRef">Overview of existing solutions</a>
        </h3>
<p id="section-2.1-1">
   Currently there are many protocols that address credentials lifecycle
   management.  In particular, when it comes to digital certificates,
   some of the most deployed management protocols are: Certificate
   Management Protocol (CMP) <span>[<a href="#RFC4210" class="xref">RFC4210</a>]</span>, Certificate Management over CMS
   (CMC) <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span><span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>, Enrollment over Secure Transport (EST)
   <span>[<a href="#RFC7030" class="xref">RFC7030</a>]</span>, and Automated Certificate Management Environment (ACME)
   <span>[<a href="#RFC8555" class="xref">RFC8555</a>]</span>.  However, none of these protocols provide native support
   for client that do not have IP connectivity yet (e.g., because they
   do not have network-access credentials, yet).  EAP-CREDS provides the
   possibility to use such protocols (i.e., message-based) by defining a
   series of messages that can be used to encapsulate the provisioning
   messages for the selected provisioning protocol.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-2.2">
<section id="section-2.2">
        <h3 id="name-scope-statement">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-scope-statement" class="section-name selfRef">Scope Statement</a>
        </h3>
<p id="section-2.2-1">
   This document focuses on the definition of the EAP-CREDS method to
   convey credentials provisioning and managing messages between the
   client and the AAA server.  Moreover, the document defines how to
   encode messages for the main IETF provisioning protocols.  This
   document, however, does not provide specifications for how and where
   the credentials are generated.  In particular, the credentials could
   be generated directly within the AAA server or at a different
   location (i.e., the Certificate Service Provider or CSP) site.
   Different authentication mechanisms (e.g., TLS, etc.) can be used to
   secure the communication between the server's endpoint and the CSP.
   Examples and details of how to use EAP-CREDS encapsulation mechanism
   with specific protocol are out of scope of this document.  For more
   details of using EAP-CREDS method with Simple Provisioning Protocol
   (SPP), please refer to EAP-CREDS with Simple Provisioning Protocol
   (SPP) .  For more details of using EAP-CREDS method with Certificate
   Management Protocol (CMP), please refer to EAP-CREDS withwith
   Certificate Management Protocol (CMP) .  These two documents can be
   used as the template for other protocols' encapulation with EAP-
   CREDS.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-2.3">
<section id="section-2.3">
        <h3 id="name-eap-creds-as-tunneled-mecha">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-eap-creds-as-tunneled-mecha" class="section-name selfRef">EAP-CREDS as tunneled mechanism only</a>
        </h3>
<p id="section-2.3-1">
   EAP-CREDS requires that an outer mechanism is in place between the
   Peer and the Server in order to provide authentication and
   confidentiality of the messages exchanged via EAP-CREDS.  In other
   words, EAP-CREDS assumes that an appropriately encrypted and
   authenticated channel has been established to prevent the possibility
   to leak information or to allow man-in-the-middle attacks.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">
   This choice was taken to simplify the message flow between Peer and
   Server, and to abstract EAP-CREDS from the secure-channel
   establishment mechanism.  EAP-TLS, or EAP-TEAP are examples of such
   mechanisms.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-2.4">
<section id="section-2.4">
        <h3 id="name-fragmentation-support">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-fragmentation-support" class="section-name selfRef">Fragmentation Support</a>
        </h3>
<p id="section-2.4-1">
   EAP does not directly support handling fragmented packets and it
   requires the outer method to provide fragmentation support.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">
   Because of the outer method requirements in particular, removing any
   support for fragmented messages in EAP-CREDS removes the duplication
   of packets (e.g., Acknowledgment Packets) sent across the Peer and
   the Server, thus resulting in a smaller number of exchanged messages.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-2.5">
<section id="section-2.5">
        <h3 id="name-encapsulating-provisioning-">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-encapsulating-provisioning-" class="section-name selfRef">Encapsulating Provisioning Protocols in EAP-CREDS</a>
        </h3>
<p id="section-2.5-1">
   In order to use EAP-CREDS together with your favorite provisioning
   protocol, the messages from the provisioning protocol need to be sent
   to the other party.  In EAP-CREDS, this is done by encoding the
   provisioning protocol messages inside the ('ProtoData') TLV.  In case
   the provisioning protocol uses additional data for its operations
   (e.g., uses HTTP Headers), this data can be encoded in a separate
   ('ProtoHeaders') TLV.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">
   Since the implementation of the provisioning endpoint could happen in
   a (logically or physically) different component, a method is needed
   to identify when a provisioning protocol has actually ended.  In EAP-
   CREDS, the 'D' (Done) bit in the message headers is used for this
   purpose.<a href="#section-2.5-2" class="pilcrow">¶</a></p>
<p id="section-2.5-3">
   In the first message of Phase Two, the Server provides the client
   with all the selected parameters for one specific credential that
   needs attention (or for a new credential) to be managed by the
   network.  In particular, the server provides, at minimum, the
   ('Protocol') TLV, the ('Action') TLV, and the ('Params') or the
   ('Creds-Info') TLV.<a href="#section-2.5-3" class="pilcrow">¶</a></p>
<p id="section-2.5-4">
   After checking the parameters sent by the Server, if the Peer does
   not support any of the proposed ones, it MUST send a message with one
   single ('Error') TLV with the appropriate error code(s).  The server,
   can then decide if to manage a different set of credentials (if more
   where reported by the Peer in its Phase One message) or if to
   terminate the EAP session with an error.<a href="#section-2.5-4" class="pilcrow">¶</a></p>
<p id="section-2.5-5">
   The Peer and the Server exchange Provisioning messages until an error
   is detected (and the appropriate error message is sent to the other
   party) or until Phase Two is successfully completed.<a href="#section-2.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-2.6">
<section id="section-2.6">
        <h3 id="name-algorithm-requirements">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-algorithm-requirements" class="section-name selfRef">Algorithm Requirements</a>
        </h3>
<p id="section-2.6-1">
   EAP-CREDS uses the SHA-256 hashing algorithm to verify credentials in
   phase three of the protocol.  Peers and Servers MUST support SHA-256
   for this purpose.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-2.7">
<section id="section-2.7">
        <h3 id="name-notation">
<a href="#section-2.7" class="section-number selfRef">2.7. </a><a href="#name-notation" class="section-name selfRef">Notation</a>
        </h3>
<p id="section-2.7-1">
   In this document we use the following notation in the diagrams to
   provide information about the cardinality of the data structures
   (TLVs) within EAP-CREDS messages:<a href="#section-2.7-1" class="pilcrow">¶</a></p>
<span id="name-eap-creds-notation"></span><div id="le-eap-creds-notation">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-2.7-2.1">
<pre>
+--------+------------+---------------------------------------------+
| Symbol |  Example   | Usage                                       |
+--------+------------+---------------------------------------------+
|  { }   |   {TLV1}   | Curly Brackets are used to indicate a set   |
|  [ ]   |  {[TLV2]}  | Square Brackets are used to indicate that a |
|        |            | field is optional                           |
|  ( )   | {TLV1(=V)} | Round Squares are used to specify a value   |
|   +    |  {TLV_2+}  | The Plus character indicates that one or    |
|        |            | more instances are allowed                  |
+--------+------------+---------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-eap-creds-notation" class="selfRef">EAP-CREDS Notation</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sect-3">
<section id="section-3">
      <h2 id="name-eap-creds-protocol">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-eap-creds-protocol" class="section-name selfRef">EAP-CREDS Protocol</a>
      </h2>
<p id="section-3-1">
   In a nutshell, EAP-CREDS provides the abstraction layer on top of
   which credentials provisioning/managing protocols can be deployed
   thus enabling their use even before provisioning IP services.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
   This section outlines the operation of the protocol and message
   flows.  The format of the CREDS messages is given in <a href="#sect-4" class="xref">Section 4</a>.<a href="#section-3-2" class="pilcrow">¶</a></p>
<div id="sect-3.1">
<section id="section-3.1">
        <h3 id="name-message-flow">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-message-flow" class="section-name selfRef">Message Flow</a>
        </h3>
<p id="section-3.1-1">
   EAP-CREDS message flow is logically subdivided into three different
   phases: Initialization, Provisioning, and Validation.  EAP-CREDS
   enforces the order of phases, i.e. it is not possible to move to an
   earlier phase.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
   Phase transitioning is controlled by the Server.  In particular, the
   server, after the last message of a phase, it can decide to either
   (a) start the next phase by sending the first message of the next
   phase, or (b) continue the same phase by sending another "first"
   message of the phase (e.g., managing a second set of credentials) -
   this is allowed only in Phase Two and Phase Three but NOT in Phase
   One, or (c) terminate the EAP session.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.1-3">
          <dt id="section-3.1-3.1">Phase One (Required).  Initialization.  During this phase the Peer</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.2">
 and the Server exchange the information needed to select the
      appropriate credentials management protocol.  Phase One flow is
      composed by only messages.  In particular, the Sever sends its
      initial message of type ('EAP-CREDS-Init').  The Peer replies with
      the details about which provisioning protocols are supported, and
      additional information such as the list of installed credentials
      and, optionally, authorization data (for new credentials
      registration).<a href="#section-3.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.3">Phase Two (Optional).  Provisioning Protocol Flow.  In this phase,</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.4">
 the Peer and the Server exchange the provisioning protocol's
      messages encapsulated in a EAP-CREDS message of type Provisioning.
      The messages use two main TLVs.  The first one is the
      ('ProtoHeaders') TLV which is optional and carries information
      that might be normally conveyed via the transport protocol (e.g.,
      HTTP headers).  The second one is the ('ProtoData'), which is
      required and carries the provisioning protocol's messages.  The
      server can decide to repeat phase two again to register new
      credentials or to renew a separate set of credentials by issuing a
      new ('Provisioning') message for the new target.  When no more
      credentials have to be managed, the Server can start phase three
      or simply terminate the EAP session.<a href="#section-3.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.5">Phase Three (Optional).  Credentials Validation.  This optional phase</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.6">
 can be initiated by the server and it is used to validate that the
      Peer has properly installed the credentials and can use them to
      authenticate itself.  Depending on the credentials' type, the
      messages can carry a challenge/nonce, the value of the secret/
      token, or other information.  The format of the credentials is
      supposed to be known by the provider and the device.<a href="#section-3.1-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-3.2">
<section id="section-3.2">
        <h3 id="name-phase-transitioning-rules">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-phase-transitioning-rules" class="section-name selfRef">Phase Transitioning Rules</a>
        </h3>
<p id="section-3.2-1">
   In order to keep track of starting and ending a phase, EAP-CREDS
   defines several bits and fields in the EAP-CREDS message headers.  In
   particular, as described in <a href="#sect-4.1" class="xref">Section 4.1</a>, the 'S' (Start) bit is used
   to indicate the beginning (or Start) of a phase, while the 'Phase'
   field (4 bits) is used to indicate the phase for this message.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">
   In EAP-CREDS, phase transitioning is under the sole control of the
   Server, therefore the value of the 'S' (Start) bit is meaningful only
   in messages sent by the Server.  The value of the 'S' (Start) bit in
   Peer's messages SHALL be set to '0x0' and SHALL be ignored by the
   server.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">
   When starting a new phase, the Server MUST set the 'S' (Start) bit to
   '1' and the 'Phase' field to the current phase number (e.g., 0x01 for
   phase one, 0x02 for phase two, or 0x03 for phase three).<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">
   In case the first message of a phase is to be repeated (e.g., because
   of processing multiple credentials), the 'S' (Start) bit SHALL be set
   to '0' (i.e., it should be set to '1' only on the first occurrence
   and set to '0' in subsequent messages).<a href="#section-3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-3.3">
<section id="section-3.3">
        <h3 id="name-phase-one-initialization">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-phase-one-initialization" class="section-name selfRef">Phase One: Initialization</a>
        </h3>
<span class="break"></span><dl class="dlNewline" id="section-3.3-1">
          <dt id="section-3.3-1.1">The following figure provides the message flow for Phase One:</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-1.2"></dd>
        <dd class="break"></dd>
</dl>
<div class="alignLeft art-text artwork" id="section-3.3-2">
<pre>
    ,--------.                               ,----------.
    |EAP Peer|                               |EAP Server|
    `---+----'                               `----+-----'
        |         Outer Tunnel Established        |
        | &lt;---------------------------------------&gt;
        |                                         |
        | [1] EAP-Request/EAP-CREDS(Type=Init)    |  ,---------!.
        |     { [ Version+ ], [ Challenge-Data ] }|  |Phase One|_\
        | &lt;----------------------------------------  |Begins     |
        |                                         |  `-----------'
        |  [2] EAP-Response/EAP-CREDS(Type=Init)  |
        |      { [ Version+ ], [ Protocols+ ],    |
        |        [ Creds-Info+ ], [ Encoding+ ],  |  ,---------!.
        |        [ Format+ ], [ Token ],     |  |Phase One|_\
        |        [ Profile+ ], [ Challenge-Rsp ], |  |Ends       |
        |        [ Storage-Info ],[ Net-Usage] }  |  `-----------'
        | ----------------------------------------&gt;
        |                                         |
        |                                         |

                  EAP-CREDS Phase One Message Flow

[1] Server sends EAP-Request/EAP-CREDS(Type=Init):
</pre><a href="#section-3.3-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.3-3">
          <dt id="section-3.3-3.1"></dt>
          <dd style="margin-left: 1.5em" id="section-3.3-3.2">
      After the establishment of the outer mechanism (e.g., EAP-TLS,
      EAP-TEAP, EAP-TTLS, etc.), the server MAY decide to start a
      credentials management session.  In order to do that, the Server
      sends an EAP-Request/EAP-CREDS(Type=Init) message to the Peer with
      the 'S' (Start) bit set to '1' and the Phase field value set to
      '0x01' (thus indicating the beginning of Phase One) as described
      in <a href="#sect-4.1" class="xref">Section 4.1</a>.  Also, the Server MAY use one or more ('Version')
      TLVs to indicate the supported versions.<a href="#section-3.3-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-3.3-4">
          <dt id="section-3.3-4.1"></dt>
          <dd style="margin-left: 1.5em" id="section-3.3-4.2">
      The Server MAY also specify which versions of EAP-CREDS are
      supported by adding zero, one or more ('Version') TLVs.  If no
      ('Version') TLV is added to the message, the Peer SHOULD assume
      the supported version is 1 ('0x01').<a href="#section-3.3-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-3.3-5">
          <dt id="section-3.3-5.1"></dt>
          <dd style="margin-left: 1.5em" id="section-3.3-5.2">
      Optionally, the Server MAY also send a ('Challenge-Data') TLV
      which includes chanllenge data value (usually some random value)
      and a specified challenge type.  The Peer MUST use the specified
      type and use chanllenge data value for calculating the
      ('Challenge-Response') TLV.<a href="#section-3.3-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-3.3-6">
          <dt id="section-3.3-6.1">[2] The Peer sends EAP-Response/EAP-CREDS(Type=Init)</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-6.2">
            <p id="section-3.3-6.2.1">
 The Peer, sends back a message that carries one ('Version') TLV to
      indicate the selected version of EAP-CREDS (i.e.  from the list
      provided by the server) (optional).  If the client does not
      include the ('Version') TLV, the Server MUST use the most recent
      supported version of EAP-CREDS.  Moreover, the Server includes one
      or more ('Protocol') TLVs to indicate the list of supported
      provisioning protocols, followed by one ('Creds-Info') TLVs for
      each installed credentials to provide their status to the server
      (i.e., if multiple credentials are configured on the Peer for this
      Network, then the Peer MUST include one ('Creds-Info') TLV for
      each of them).<a href="#section-3.3-6.2.1" class="pilcrow">¶</a></p>
<p id="section-3.3-6.2.2">
 The Peer MAY also provide the list of supported Encodings and
      Formats by adding one or more ('Encoding') and ('Formats') TLVs.
      The Peer MAY also provide the Server with information about the
      Peer's credentials storage by using the ('Storage-Info') TLV.<a href="#section-3.3-6.2.2" class="pilcrow">¶</a></p>
<p id="section-3.3-6.2.3">
 When there are no available credentials, the Peer MAY include an
      authorization token that can be consumed by the Server for
      registering new credentials.  In particular, the Peer can include
      the ('Token') TLV to convey the value of the token.  The
      ('Challenge-Data') and ('Challenge-Response') TLVs, instead, can
      be used to convey a challenge and its response based on the
      authorization information.  For example, suppose a public key hash
      is present in the Token, the peer can generate some random data -
      or use the one from the Server - and generate a signature on that
      value: the signature SHALL be encoded in the ('Challenge-
      Response') TLV and it should be calculated over the concatenation
      of values inside the ('Challenge-Data') TLV and the ('Token') TLV.<a href="#section-3.3-6.2.3" class="pilcrow">¶</a></p>
<p id="section-3.3-6.2.4">
 Also, the Peer MAY add one or more ('Profile') TLVs to indicate to
      the Server which profiles are requested/supported (e.g., a pre-
      configuration MAY exist on the Peer with these ecosystem-specific
      identifiers).<a href="#section-3.3-6.2.4" class="pilcrow">¶</a></p>
<p id="section-3.3-6.2.5">
 Ultimately, the Peer MAY include additional metadata regarding the
      status of the Peer.  To this end, the Peer can use a ('Storage-
      Info') TLV to provide the server with additional data about the
      Peer's capabilities and resources.  Also, the ('Net-Usage') TLV
      can be used to provide the Server with the indication of which
      network resources are needed by the Peer and what is its intended
      utilization pattern(s).<a href="#section-3.3-6.2.5" class="pilcrow">¶</a></p>
<p id="section-3.3-6.2.6">
 The server checks that the Peer's selected protocol, version, and
      parameters are supported and, if not (or if the server detects an
      error), it can (a) send a non-recoverable error message to the
      peer, notify the outer (tunneling) layer, and terminate the EAP-
      CREDS session, or (b) start phase one again by sending a new
      ('EAP-CREDS-Init') message that will also carry an ('ERROR') TLV
      that provides the Peer with the reason the initial response was
      not acceptable.  In this case, the ('Phase') field MUST be omitted
      since it is not the first message of phase one.  The server and
      the peer can repeat phase one until they reach an agreement or the
      session is terminated by the Server.<a href="#section-3.3-6.2.6" class="pilcrow">¶</a></p>
<p id="section-3.3-6.2.7">
 NOTE WELL: The determination of the need to start phase two or not
      is based on the contents of the ('Creds-Info') TLV sent by the
      Peer (e.g., a credential is about to expire or a credential is
      simply missing).<a href="#section-3.3-6.2.7" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-3.4">
<section id="section-3.4">
        <h3 id="name-phase-two-provisioning">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-phase-two-provisioning" class="section-name selfRef">Phase Two: Provisioning</a>
        </h3>
<p id="section-3.4-1">
   The following figure provides the message flow for Phase 2:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-2">
<pre>
,--------.                                     ,----------.
|EAP Peer|                                     |EAP Server|
`---+----'                                     `----+-----'
    |  [1] EAP-Request/EAP-CREDS(Type=Provisioning) |
    |      { Protocol, Action,                      |  ,---------!.
    |        [ Creds-Info  ], [ Params ],           |  |Phase Two|_\
    |        [ ProtoData ], [ ProtoHeaders ] }      |  |Begins     |
    | &lt;----------------------------------------------  `-----------'
    |                                               |
    | [2] EAP-Response/EAP-CREDS(Type=Provisioning) |
    |     { ProtoData, [ ProtoHeaders ] }           |
    | ----------------------------------------------&gt;
    |                                               |
    .                                               .
    .                                               .
    .                                               .
    .                                               .
    | [N] EAP-Response/EAP-CREDS(Type=Provisioning) |
    |     { [ Creds-Info ], [ ProtoData ],          |
    |       [ ProtoHeaders ] }                      |
    | &lt;----------------------------------------------
    |                                               |
    | [N+1] EAP-Request/EAP-CREDS(Type=Provisioning)|  ,---------!.
    |     { [ ProtoData ], [ ProtoHeaders ] }       |  |Phase Two|_\
    | ----------------------------------------------&gt;  |Ends       |
    |                                               |  `-----------'
    |                                               |

                  EAP-CREDS Phase Two Message Flow
</pre><a href="#section-3.4-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.4-3">
          <dt id="section-3.4-3.1">[1] The Server sends EAP-Request/EAP-CREDS(Type=Provisioning)</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-3.2">
 The first message of Phase Two indicates that the Server is ready
      to initiate the selected provisioning protocol.This message
      contains the parameters of the selected provisioning protocol in
      the ('Params') (e.g., algorithm for generating credentials), the
      description of installed credentials in the ('Creds-Info'), the
      selected provisioning protocol's message data and some extra
      fields (e.g., transport-protocol headers) in the ('ProtoData') and
      its content in ('ProtoHeaders') TLVs respectively.<a href="#section-3.4-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-3.3">[2] The Peer sends EAP-Response/EAP-CREDS(Type=Provisioning)</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-3.4">
 After that, the Peer sends its first message to the Server by
      sending the EAP-Response/EAP-CREDS(Type=Provisioning) message.
      This message contains the selected provisioning protocol's message
      data and some extra fields (e.g., transport-protocol headers) in
      the ('ProtoData') and its content in ('ProtoHeaders') TLVs
      respectively.<a href="#section-3.4-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-3.5">[N=3] The Server sends EAP-Request/EAP-CREDS(Type=Provisioning)</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-3.6">
 The Server replies to the Peer's message with EAP-Request/EAP-
      CREDS(Type=Provisioning) messages until the provisioning protocol
      reaches an end or an error condition arise (non-recoverable).<a href="#section-3.4-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-3.7">[N] The Server sends EAP-Request/EAP-CREDS(Type=Provisioning)</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-3.8">
 When the provisioning protocol has been executed for the specific
      set of credentials, the server sends a last message that MUST
      include the description of the provisioned credentials in a
      ('Creds-Info') TLV and MUST set the 'D' (Done) bit in the EAP-
      CREDS message header to '1' to indicates that the server does not
      have any more ('Type=Provisioning') messages for this credenital.
      The final message does not need to be an empty one, i.e. other
      TLVs are still allowed in the same message (e.g., the 'ProtoData'
      and the 'ProtoHeaders' ones).<a href="#section-3.4-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-3.9">[N+1] The Peer sends EAP-Request/EAP-CREDS(Type=Provisioning)</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-3.10">
 The Peer MUST reply to the server with a ('Type=Provisioning')
      message that MUST have the 'D' (Done) bit in the EAP-CREDS message
      header set to '1', thus indicating that the credentials have been
      installed correctly.  In case of errors, the Peer MUST include the
      appropriate ('Error') TLV.  Also in this case, the final message
      does not need to be an empty one, i.e. other TLVs are still
      allowed in the same message (e.g., tthe 'ProtoData' and the
      'ProtoHeaders' ones).<a href="#section-3.4-3.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.4-4">
   At this point, the Server can decide to provision (or manage) another
   set of credentials by issuing a new ('Type=Provisioning') message, or
   it can decide to start Phase Three by sending its first
   ('Type=Validate') message, or it can terminate the EAP session.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-3.5">
<section id="section-3.5">
        <h3 id="name-phase-three-validation">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-phase-three-validation" class="section-name selfRef">Phase Three: Validation</a>
        </h3>
<span class="break"></span><dl class="dlNewline" id="section-3.5-1">
          <dt id="section-3.5-1.1">The following figure provides the message flow for Phase 3:</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-1.2"></dd>
        <dd class="break"></dd>
</dl>
<div class="alignLeft art-text artwork" id="section-3.5-2">
<pre>
    ,--------.                                ,----------.
    |EAP Peer|                                |EAP Server|
    `---+----'                                `----+-----'
        | [1] EAP-Request/EAP-CREDS(Type=Validate) |  ,-----------!.
        |     { Creds-Info, Challenge-Data }       |  |Phase Three|_\
        | &lt;-----------------------------------------  |Begins       |
        |                                          |  `-------------'
        | [2] EAP-Response/EAP-CREDS(Type=Validate)|  ,-----------!.
        |     { Challenge-Response }               |  |Phase Three|_\
        | -----------------------------------------&gt;  |Ends         |
        |                                          |  `-------------'
        |                                          |

                 EAP-CREDS Phase Three Message Flow
</pre><a href="#section-3.5-2" class="pilcrow">¶</a>
</div>
<p id="section-3.5-3">
   Phase three is optional and it is used by the server to request the
   client to validate (with proof) that the new credentials have been
   installed correctly before issuing the final EAP-CREDS Success
   message.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5-4">
          <dt id="section-3.5-4.1"></dt>
          <dd style="margin-left: 1.5em" id="section-3.5-4.2">
      NOTE WELL: Phase Three introduces a dependency on the selected
      hashing algorithm to provide common and easy way to check the
      integrity and functionality of a newly installed set of
      credentials.<a href="#section-3.5-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-3.5-5">
          <dt id="section-3.5-5.1">[1] The Server sends EAP-Request/EAP-CREDS(Type=Validate)</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-5.2">
            <p id="section-3.5-5.2.1">
 In order to start Phase Three, the Server sends an EAP-Request/
      EAP-CREDS(Type=Validate) message to the Peer.  The Server MUST
      include the ('Creds-Info') TLV to provide the indication about
      which set of credentials the Server intends to validate.  The
      Server MUST also include a randomly generated challenge in the
      message to the client.  The type of challenge determines in
      ('Challenge-Data') for the peer to calculate ('Challenge-
      Response').  EAP-CREDS defines the asymmetric and symmetric
      challenges in <a href="#sect-7.5" class="xref">Section 7.5</a> and others can be defined according to
      the specified rules.<a href="#section-3.5-5.2.1" class="pilcrow">¶</a></p>
<p id="section-3.5-5.2.2">
 As usual, the Server MUST set, in the headers, the 'S' (Start) bit
      to '1' in its first message of Phase Three and the 'Phase' value
      shall be set to '3' (beginning of Phase Three).<a href="#section-3.5-5.2.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-5.3">[2] The Peer sends EAP-Response/EAP-CREDS(Type=Validate)</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-5.4">
            <p id="section-3.5-5.4.1">
 When the client receives the Validate message from the server, it
      calculates the response to the challenge and sends the response
      back to the server in a EAP-Response/EAP-CREDS(Type=Validate)
      message.  When the 'EAP-CREDS-ASYMMETRIC-CHALLENGE' and 'EAP-
      CREDS-SYMMETRIC-CHALLENGE' values are used in the 'Challenge
      types', the Peer MUST calculate the response as follows:<a href="#section-3.5-5.4.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.5-5.4.2">
              <dt id="section-3.5-5.4.2.1"></dt>
              <dd style="margin-left: 1.5em" id="section-3.5-5.4.2.2">
                <p id="section-3.5-5.4.2.2.1">         Public-Key<a href="#section-3.5-5.4.2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.5-5.4.2.2.2">
 For any public-key based credentials (e.g., certificates or
            raw key pairs), the response to the challenge is calculated
            by generating a signature over the hashed value of the
            challenge.  The hashing algorithm to be used for this
            purpose is specified in <a href="#sect-2.6" class="xref">Section 2.6</a>.  The format of the
            signature in the ('Challenge-Response') TLV is the
            concatenation of:<a href="#section-3.5-5.4.2.2.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-5.4.2.2.3.1">The signatureAlgorithm (DER encoded) which contains the
               identifier for the cryptographic algorithm used by the
               Peer to generate the signature using <span>[<a href="#RFC3279" class="xref">RFC3279</a>]</span>,
               <span>[<a href="#RFC4055" class="xref">RFC4055</a>]</span>, and <span>[<a href="#RFC4491" class="xref">RFC4491</a>]</span> list supported signature
               algorithms.  Other signature algorithms MAY also be
               supported.  The definition of the signatureAlgorithm is
               provided in Section 4.1.1.2 of <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.<a href="#section-3.5-5.4.2.2.3.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.5-5.4.2.2.3.2">The signatureValue (DER encoded) which contains the
               digital signature itself.  The signature value is encoded
               as a BIT STRING and the details of how to generate the
               signatures' structures can be found in Section 4.1.1.3 of
               <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> and referenced material.<a href="#section-3.5-5.4.2.2.3.2" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-3.5-5.4.2.3">Symmetric Secret</dt>
              <dd style="margin-left: 1.5em" id="section-3.5-5.4.2.4">
                <p id="section-3.5-5.4.2.4.1">
 For any symmetric based credentials (e.g., password or Key),
            the response to the challenge is calculated by using the
            selected hash function (see <a href="#sect-2.6" class="xref">Section 2.6</a>) on the
            concatenation of (a) the value carried in the server-
            provided ('Challenge-Data') TLV, and (b) the secret value
            itself (salted hash).<a href="#section-3.5-5.4.2.4.1" class="pilcrow">¶</a></p>
<p id="section-3.5-5.4.2.4.2">
 The initial values for the type of challenges are described in the
      <a href="#sect-7.5" class="xref">Section 7.5</a>.  Other types of challenges MAY be defined according
      to the specified procedures.<a href="#section-3.5-5.4.2.4.2" class="pilcrow">¶</a></p>
<p id="section-3.5-5.4.2.4.3">
 In case of issues with the validation of newly deployed
      credentials, both the Server and the Peer should consider those
      credentials invalid (or unusable) and should issue the required
      failure message(s).<a href="#section-3.5-5.4.2.4.3" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sect-4">
<section id="section-4">
      <h2 id="name-eap-creds-message-format">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-eap-creds-message-format" class="section-name selfRef">EAP-CREDS Message Format</a>
      </h2>
<p id="section-4-1">
   The EAP-CREDS defines the following message types:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-2">
<li id="section-4-2.1">EAP-CREDS-Init<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-4-2.2">EAP-CREDS-Provisioning<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-4-2.3">EAP-CREDS-Validate<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-4-3">
   Each of these message types have the basic structure as identified in
   <a href="#sect-4.1" class="xref">Section 4.1</a>.  EAP-CREDS messages contain zero, one, or more TLVs.
   The internal structure of the different types of TLVs is described in
   <a href="#sect-4.2" class="xref">Section 4.2</a>, while a detailed description of the EAP-CREDS message
   types is provided in <a href="#sect-5" class="xref">Section 5</a>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="sect-4.1">
<section id="section-4.1">
        <h3 id="name-message-header">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-message-header" class="section-name selfRef">Message Header</a>
        </h3>
<p id="section-4.1-1">
   The EAP-CREDS messages consist of the standard EAP header (see
   Section 4 of <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span>), followed by the message payload of the EAP-
   CREDS.  The header has the following structure:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Code      |  Identifier   |             Length            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Type      |J|S|F|D| Phase |         Message Length        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         Message Length        |               Data           ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-.
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">
   Where the Code, Identifier, Length, and Type fields are all part of
   the EAP header as defined in <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span>.  Since EAP-CREDS can only be
   used as a tunneled mechanism, the presence of these fields is only
   for backward compatibility with existing parsers.  In particular, the
   'Length' field is used for fragmentation instead of the message
   length: the message length is carried in the 'Message Length' field
   if Jumbo Message is indicated in the header.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">
   The Type field in the EAP header is &lt;TBD&gt; for EAP-CREDS.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">
   The Flags bitfield is used to convey status information (e.g., extra
   long message, phase number, phase transitioning state).  The
   transition-control bit (i.e., the 'S' (Start) bit) are set in
   Server's messages and are ignored in Peer's messages (the Server is
   the entity that unilaterally controls the phase transition process).
   The meanings of the bits in the 'Flags' field are as follows:<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-6">
          <dt id="section-4.1-6.1"></dt>
          <dd style="margin-left: 1.5em" id="section-4.1-6.2">
      Bit 'J' (Jumbo Message) - If set, it indicates the presence of the
      'Message Length' field.  This bit SHALL be used only when the size
      of the message exceeds the maximum value allowed in the 'Length'
      field.  In this case, the 'Message Length' field is added to the
      message and set to the whole message size and the 'Length' field
      is used for the current fragment length.  If not set, the 'Message
      Length' field is not present in the Message and the 'Length' field
      is used for the message size (and the 'F' (Fragment) bit MUST be
      set to '0').<a href="#section-4.1-6.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-4.1-7">
          <dt id="section-4.1-7.1"></dt>
          <dd style="margin-left: 1.5em" id="section-4.1-7.2">
      Bit 'S' (Start) - If set, this message is the first one of a new
      EAP-CREDS phase.  The value of the new phase is encoded in the
      'Phase' field.<a href="#section-4.1-7.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-4.1-8">
          <dt id="section-4.1-8.1"></dt>
          <dd style="margin-left: 1.5em" id="section-4.1-8.2">
      Bit 'F' (Fragment) - If set, this message is a fragment of a
      message.  In this case, the 'Data' field is to be concatenated
      with all messages with the 'F' (Fragment) bit set to '1' until the
      message with the 'F' (Fragment) bit set to '0' that indicates the
      end of the message.  If the message is not fragmented, the 'F'
      (Fragment) bit MUST be set to '0'.  The use of this bit is
      required when the tunneling method does not provide support for
      messages up to 2^32 bits in size.<a href="#section-4.1-8.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-4.1-9">
          <dt id="section-4.1-9.1"></dt>
          <dd style="margin-left: 1.5em" id="section-4.1-9.2">
      Bit 'D' (Done) - This bit is used in Phase Two and Phase Three to
      indicate that the specific operation for the identified credential
      is over.  For example, when multiple credentials exist on the Peer
      and the Server needs to manage and validate one of them.  In its
      last message, when the provisioning protocol is done, the server
      sets the 'D' (Done) bit to indicate that it is done.  The Peer, in
      its reply, sets the bit to indicate the end of provisioning for
      this credentials is also over.  After that, the Server can
      continue Phase Two, transition to Phase Three, or terminate the
      EAP session.<a href="#section-4.1-9.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-10">
   The Phase field is a 4-bits value and identifies the EAP-CREDS phase
   for the current message.  The version of EAP-CREDS described in this
   document supports three values for this field:<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-11">
          <dt id="section-4.1-11.1"></dt>
          <dd style="margin-left: 1.5em" id="section-4.1-11.2">
      0x01 - Phase One<a href="#section-4.1-11.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-4.1-12">
          <dt id="section-4.1-12.1"></dt>
          <dd style="margin-left: 1.5em" id="section-4.1-12.2">
      0x02 - Phase Two<a href="#section-4.1-12.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-4.1-13">
          <dt id="section-4.1-13.1"></dt>
          <dd style="margin-left: 1.5em" id="section-4.1-13.2">
      0x03 - Phase Three<a href="#section-4.1-13.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-14">
   A detailed explanation of the 'Phase' and 'Flags' fields of the
   message headers is provided in <a href="#sect-3.2" class="xref">Section 3.2</a>.<a href="#section-4.1-14" class="pilcrow">¶</a></p>
<p id="section-4.1-15">
   The Data field is the message payload.  The full description of this
   field is provided in the next section.<a href="#section-4.1-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.2">
<section id="section-4.2">
        <h3 id="name-message-payload">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-message-payload" class="section-name selfRef">Message Payload</a>
        </h3>
<p id="section-4.2-1">
   The Data part of the message is organized as zero, one, or more TLV
   objects whose structure is defined in this section.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">
   Each TLV object has the same basic structure that is defined as
   follows:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-3">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                   TLV Length                  |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       TLV Value                              ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Where:

TLV-Type (uint8)
</pre><a href="#section-4.2-3" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-4">
          <dt id="section-4.2-4.1"></dt>
          <dd style="margin-left: 1.5em" id="section-4.2-4.2">
      This field is used to indicate the type of data that the TLV
      carries.  The type of TLV determines its internal structure.  The
      supported values for this fields are provided in the following
      table:<a href="#section-4.2-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-4.2-5">
          <dt id="section-4.2-5.1">Length (uint24)</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-5.2">
 This field carries the size of the value of the TLV.  In
      particular, the overall size of a TLV (i.e., the header plus the
      value) can be calculated by adding the size of the header (6
      octets) to the value of the Length field (i.e., the size of the
      TLV's value).<a href="#section-4.2-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-eap-creds-supported-tlvs-ty"></span><div id="tab-eap-creds-supported-tlvs-types">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-eap-creds-supported-tlvs-ty" class="selfRef">EAP-CREDS Supported TLVs Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> TLV Name</th>
              <th class="text-left" rowspan="1" colspan="1"> TLV Type</th>
              <th class="text-left" rowspan="1" colspan="1"> Scope/Usage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Action TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase Two</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Certificate-Data TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase Two</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Challenge-Data TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase Two, Phase Three</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Challenge-Response TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase Two, Phase Three</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Credentials-Data TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase Two</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Creds-Info TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase Two, Phase Three</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Error TLV</td>
              <td class="text-left" rowspan="1" colspan="1">All Phases</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Net-Usage TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase One</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Profile TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase Two</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Protocol TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase One, Phase Two</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">ProtoData TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase Two</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">ProtoHeaders TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase Two</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Params TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase Two</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Token TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase One</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">&lt;TBD&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">Version TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Phase One</td>
            </tr>
          </tbody>
        </table>
</div>
<span class="break"></span><dl class="dlNewline" id="section-4.2-7">
          <dt id="section-4.2-7.1">TLV Value ( &gt; 1 octet )</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-7.2">
 This field carries data for the identified TLV.  The internal
      structure is determined by the TLV Type field.<a href="#section-4.2-7.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-8">
   The rest of this section describes the structure of the different
   supported TLVs and their usage in the different messages.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.3">
<section id="section-4.3">
        <h3 id="name-eap-creds-defined-tlvs">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-eap-creds-defined-tlvs" class="section-name selfRef">EAP-CREDS defined TLVs</a>
        </h3>
<p id="section-4.3-1">
   EAP-CREDS messages's payload comprises zero, one, or more TLVs that
   are encoded in a single EAP-CREDS message.  The values for the TLV
   Type that are supported by this specifications are listed in Table 2.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div id="sect-4.3.1">
<section id="section-4.3.1">
          <h4 id="name-the-action-tlv">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-the-action-tlv" class="section-name selfRef">The Action TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.1-1">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   TLV Type    |                 TLV Length                    |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Flags     |  Action Type  |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   &lt;TBD&gt; - Action TLV

TLV Length (uint24)

   Fixed value (=2)

Flags (uint8)

   Reserved
</pre><a href="#section-4.3.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-4.3.2">
<section id="section-4.3.2">
          <h4 id="name-the-challenge-data-tlv">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-the-challenge-data-tlv" class="section-name selfRef">The Challenge-Data TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.2-1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Ch. Type    |           Challenge Data                     ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   &lt;TBD&gt; - Challenge-Data TLV

Length (uint24)

   3 octets

Challenge Type (uint8)
</pre><a href="#section-4.3.2-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3.2-2">
            <dt id="section-4.3.2-2.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.2-2.2">
      This field carries the type of Challenge.  In particular, the
      challenge type determines how the Peer MUST calculate the
      ('Challenge-Response').  The initial values for this field are
      listed in <a href="#sect-7.5" class="xref">Section 7.5</a>.  Please refer to <a href="#sect-3.5" class="xref">Section 3.5</a> for a detailed
      explanation of how to calculate the response to the challenge for
      the challenge types defined in this document.<a href="#section-4.3.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-4.3.2-3">
            <dt id="section-4.3.2-3.1">Challenge Data (&gt; 1 octet)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.2-3.2">
 This field carries the data to be used as a challenge when
      validating newly deployed credentials.<a href="#section-4.3.2-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-4.3.3">
<section id="section-4.3.3">
          <h4 id="name-the-challenge-response-tlv">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-the-challenge-response-tlv" class="section-name selfRef">The Challenge-Response TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.3-1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Challenge Response                     ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   &lt;TBD&gt; - Challenge-Response TLV

Length (uint24)

   3 octets

Challenge Response (&gt; 1 octet)
</pre><a href="#section-4.3.3-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3.3-2">
            <dt id="section-4.3.3-2.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.3-2.2">
      This field carries the data that resulted from the use of the
      credentials to be validated.<a href="#section-4.3.3-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-4.3.4">
<section id="section-4.3.4">
          <h4 id="name-the-creds-info-tlv">
<a href="#section-4.3.4" class="section-number selfRef">4.3.4. </a><a href="#name-the-creds-info-tlv" class="section-name selfRef">The Creds-Info TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.4-1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Flags     |   CredsType   |             ProtoID           |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                         IssuedOn (GMT)                        |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                        ExpiresOn (GMT)                       |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Credentials Length                      |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                           CredIDValue                        ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.3.4-1" class="pilcrow">¶</a>
</div>
<p id="section-4.3.4-2">
   The Creds-Info TLV is used by the Peer to provide a description of
   the installed credentials that are relevant for the network that is
   being accessed.<a href="#section-4.3.4-2" class="pilcrow">¶</a></p>
<p id="section-4.3.4-3">
   For example, when a set of credentials need to be renewed, the server
   checks the ('Creds-Info') from the Peer and eventually selects the
   right one for renewal.  The TLV structure is as follows:<a href="#section-4.3.4-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3.4-4">
            <dt id="section-4.3.4-4.1">TLV Type (uint8)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.4-4.2">
 &lt;TBD&gt; - Creds-Info TLV<a href="#section-4.3.4-4.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-4.3">Length (uint24)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.4-4.4">
 Provides the total length of the body of the Creds-Info TLV.<a href="#section-4.3.4-4.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-4.5">Flags (uint8)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.4-4.6">
              <p id="section-4.3.4-4.6.1">
 Provides a BITMASK that can be used to provide information about
      the status of the credentials (e.g., if the use marks the
      credentials to be compromised).  The bits have the following
      meaning:<a href="#section-4.3.4-4.6.1" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.6.2">
 Bit 0 - If set, the credential is marked as compromised
         Bit 1 - If set, the credential is immutable and cannot be
         updated<a href="#section-4.3.4-4.6.2" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.6.3">
 Bit 2 - Private Key or Secret Immutable, the public part of the
         credential (e.g., a certificate) can still be updated<a href="#section-4.3.4-4.6.3" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.6.4">
 Bit 3 - If set, the credential cannot be updated (both public
         and private parts)<a href="#section-4.3.4-4.6.4" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.6.5">
 Bit 4 - If set, the credential is ready to be used<a href="#section-4.3.4-4.6.5" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.6.6">
 Bit 5 - If set, the credential was generated on the server<a href="#section-4.3.4-4.6.6" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.6.7">
 Bit 6 - If set, the Peer would like to update the credential
         even if they are not expired<a href="#section-4.3.4-4.6.7" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.6.8">
 Bit 7 - Reserved<a href="#section-4.3.4-4.6.8" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-4.7">CredType (uint8)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.4-4.8">
 This field provides the description of the type of credential.
      The type of credentials are listed in <a href="#sect-7.3" class="xref">Section 7.3</a><a href="#section-4.3.4-4.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-4.9">ProtoID (uint16)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.4-4.10">
 This field indicates the protocol that was used to retrieve the
      target credential.  When the TLV is used in a Request by the
      Server, this field is ignored.  The values for this field are
      listed in <a href="#sect-7.1" class="xref">Section 7.1</a>.<a href="#section-4.3.4-4.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-4.11">IssuedOn (16 octets)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.4-4.12">
              <p id="section-4.3.4-4.12.1">
 This field carries the GMT date for when this credential was
      issued.  This field is 16 bytes long (the last byte must be set to
      '0x00') and contains the NULL-terminated ASCII string that
      represents the timestamp where the credential was issued.  When
      the value is not set, the field should be set to { 0x00 }. The
      format of the string is as follows:<a href="#section-4.3.4-4.12.1" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.12.2">
 YYYYMMDDHHmmssZ<a href="#section-4.3.4-4.12.2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3.4-4.12.3">
                <dt id="section-4.3.4-4.12.3.1">Where:</dt>
                <dd style="margin-left: 1.5em" id="section-4.3.4-4.12.3.2">
                  <p id="section-4.3.4-4.12.3.2.1">
 YYYY - is the 4 digits representation of the year<a href="#section-4.3.4-4.12.3.2.1" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.12.3.2.2">
 MM - is the 2 digits representation of the month
         DD - is the 2 digits representation of the day of the month<a href="#section-4.3.4-4.12.3.2.2" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.12.3.2.3">
 HH - is the 2 digits representation of the hour of the day (24
         hour format)<a href="#section-4.3.4-4.12.3.2.3" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.12.3.2.4">
 mm - is the 2 digits representation of the minutes of the hour<a href="#section-4.3.4-4.12.3.2.4" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.12.3.2.5">
 ss - is the 2 digits representation of the seconds of the
         minute<a href="#section-4.3.4-4.12.3.2.5" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4.12.3.2.6">
 Z - is the character 'Z'<a href="#section-4.3.4-4.12.3.2.6" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-4.13">ExpiresOn (16 octets)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.4-4.14">
 This field carries the GMT date for when this credential is to be
      considered expired.  This field is 16 bytes long (the last byte
      must be set to '0x00') and contains the NULL-terminated ASCII
      string that represents the timestamp where the credential was
      issued.  The format is the same as the ('IssuedOn') field.  When
      the value is not set, the field should be set to { 0x00 }.<a href="#section-4.3.4-4.14" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-4.15">Credentials Length (uint32)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.4-4.16">
 Length (in bytes) of the Credentials value.  When used with a
      public-key type of credentials, this is the size of the key (e.g.,
      for an RSA 2048 bit keys, this field should carry the value of
      256).  When used with a symmetric secret, this field carries the
      size of the secret (in bytes).<a href="#section-4.3.4-4.16" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-4.17">CredIDValue (&gt; 1 octet)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.4-4.18">
 The binary value of the credentials' identifier.  This identifier
      can be the binary value of the SHA-256 calculated over the
      certificate, a username, or it could be a random handle.  As long
      as the ID allows the peer and the server to uniquely (in its
      context) identify the credentials, the value of this field can be
      calculated in any way.<a href="#section-4.3.4-4.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-4.3.5">
<section id="section-4.3.5">
          <h4 id="name-the-error-tlv">
<a href="#section-4.3.5" class="section-number selfRef">4.3.5. </a><a href="#name-the-error-tlv" class="section-name selfRef">The Error TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.5-1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     EAP-CREDS Error Code      |      Secondary Error Code     |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          Description                         ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   &lt;TBD&gt; - Challenge-Response-Data TLV

Length (uint24)

   3 octets

EAP-CREDS Error Code (2 octets)
</pre><a href="#section-4.3.5-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3.5-2">
            <dt id="section-4.3.5-2.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.5-2.2">
      This field carries the EAP-CREDS error code.  These code are
      related to the EAP-CREDS operations only and it should not be used
      to carry the Provisioning-Protocol specific error codes.<a href="#section-4.3.5-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-4.3.5-3">
            <dt id="section-4.3.5-3.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.5-3.2">
      The error codes supported by this specifications are listed in
      <a href="#sect-4.3.5" class="xref">Section 4.3.5</a>.<a href="#section-4.3.5-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-4.3.5-4">
            <dt id="section-4.3.5-4.1">Secondary Error Code (2 octets)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.5-4.2">
 This field is used to convey an error at the encapsulation layer
      (i.e., the provisioning protocol error).  For example, this field
      can be used to convey a transport protocol error code (e.g., HTTP
      status code).  Do not use this field to convery EAP-CREDS specific
      errors.<a href="#section-4.3.5-4.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.5-4.3">Description ( &gt; 1 octet)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.5-4.4">
 The Description field is optional (i.e., when the Description Size
      is set to zero) and carries information about the error that
      occurred.  The message may or may not be used by a user or an
      automated process for debugging purposes.<a href="#section-4.3.5-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-4.3.6">
<section id="section-4.3.6">
          <h4 id="name-the-net-usage-tlv">
<a href="#section-4.3.6" class="section-number selfRef">4.3.6. </a><a href="#name-the-net-usage-tlv" class="section-name selfRef">The Net-Usage TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.6-1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |U| Desc Format |   Encoding    |   Net-Usage Data         ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   &lt;TBD&gt; - Net-Usage TLV

Length (uint24)

   Variable Length TLV (Value must be &gt; 2 )

Desc Format (7 bits)
</pre><a href="#section-4.3.6-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3.6-2">
            <dt id="section-4.3.6-2.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.6-2.2">
      This field provide the expected data format for the Net-Usage
      Data.  For example, the value in this field could be set to 'MUD'
      and have the 'U' bit set to '1' to provide the MUD-related
      information at credentials management time instead of at network-
      provisioning time (DHCP option).  This possibility could help the
      Network controller to decide if the device shall be allowed to
      register its credentials or not.  The initial values for this
      field are listed in <a href="#sect-7.9" class="xref">Section 7.9</a>.<a href="#section-4.3.6-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-4.3.6-3">
            <dt id="section-4.3.6-3.1">Encoding (uint8)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.6-3.2">
 Provides the indication of the Encoding the network usage
      description data is in.  The allowed values for this field are
      listed in <a href="#sect-7.7" class="xref">Section 7.7</a>.<a href="#section-4.3.6-3.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.6-3.3">The 'U' field (1 bit)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.6-3.4">
              <p id="section-4.3.6-3.4.1">
 The 'URL' bit ('U') is used to indicate if the value of the Net-
      Usage Data field is to be interpreted as a URL or as the actual
      data.  In particular, if the value in the 'URL' bit is '1', then
      the value in the Net-Usage Data field is to be interpreted as the
      URL where the actual data can be downloaded from.  Otherwise, if
      the 'URL' bit is set to '0', then the value in the Net-Usage Data
      field is to be interpreted as the actual data (not a URL
      referencing it).<a href="#section-4.3.6-3.4.1" class="pilcrow">¶</a></p>
<p id="section-4.3.6-3.4.2">
 An example use of this bit is when the Peer wants to convey the
      URL of the MUD file <span>[<a href="#RFC8520" class="xref">RFC8520</a>]</span>.  In this case, the Peer can set the
      Net-Usage Data field to the URL of the MUD file related to the
      Peer.<a href="#section-4.3.6-3.4.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.6-3.5">Net-Usage Data (octet string)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.6-3.6">
              <p id="section-4.3.6-3.6.1">
 This is additional information related to the device.  In
      particular, this TLV can be used by the Peer to provide the Server
      with the description of the intended network usage or a URL that
      points to the same information.<a href="#section-4.3.6-3.6.1" class="pilcrow">¶</a></p>
<p id="section-4.3.6-3.6.2">
 For example, this field can be used to convey a MUD file
      (Manufacturer Usage Description) or the latest firmware-update
      manifest.<a href="#section-4.3.6-3.6.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-4.3.7">
<section id="section-4.3.7">
          <h4 id="name-the-profile-tlv">
<a href="#section-4.3.7" class="section-number selfRef">4.3.7. </a><a href="#name-the-profile-tlv" class="section-name selfRef">The Profile TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.7-1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                    Profile Identifier                        ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   &lt;TBD&gt; - Profile Identifying Data TLV

Length (uint24)

   Length value should be &gt;= 1

Profile Identifier (octet string)
</pre><a href="#section-4.3.7-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3.7-2">
            <dt id="section-4.3.7-2.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.7-2.2">
      The Profile Identifier is used to provide indication to the other
      party about which profiles are supported when requesting
      credentials management.<a href="#section-4.3.7-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-4.3.7-3">
            <dt id="section-4.3.7-3.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.7-3.2">
      Also in this case, the data used in this field is left to be
      interpreted by the end-point and it is independent from the EAP-
      CREDS data types.  This could be a raw byte value, a string, or a
      more complex structured data (e.g., an OID).<a href="#section-4.3.7-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-4.3.7-4">
            <dt id="section-4.3.7-4.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.7-4.2">
      An example of values for this field, an end-point could use the
      string representation (i.e., dotted representation) of the Object
      Identifier (OID) of the specific profile supported (e.g., could be
      defined in the Certificate Policy of the credentials' provider).<a href="#section-4.3.7-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-4.3.8">
<section id="section-4.3.8">
          <h4 id="name-the-protocol-tlv">
<a href="#section-4.3.8" class="section-number selfRef">4.3.8. </a><a href="#name-the-protocol-tlv" class="section-name selfRef">The Protocol TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.8-1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         Protocol ID           |             Version           |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   &lt;TBD&gt; - Protocol TLV

TLV Length (uint24)

   Fixed TLV Length value of 4.

Protocol ID (uint16)
</pre><a href="#section-4.3.8-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3.8-2">
            <dt id="section-4.3.8-2.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.8-2.2">
      The Protocol ID value carries the id of a supported provisioning
      protocol.  The initial list of values for the provisioning
      protocol identifiers can be found in <a href="#sect-7.1" class="xref">Section 7.1</a>.<a href="#section-4.3.8-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-4.3.8-3">
            <dt id="section-4.3.8-3.1">Version (uint16)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.8-3.2">
 The Version (Protocol Version) value represents the specific
      version of the identified provisioning protocol.  When no version
      is specified for a protocol (i.e., either it does not support
      multiple versions or it does not matter), the value of this field
      should be set to '0x0'.<a href="#section-4.3.8-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-4.3.9">
<section id="section-4.3.9">
          <h4 id="name-the-protodata-tlv">
<a href="#section-4.3.9" class="section-number selfRef">4.3.9. </a><a href="#name-the-protodata-tlv" class="section-name selfRef">The ProtoData TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.9-1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                         Provisioning Data                    ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   &lt;TBD&gt; - ProtoData TLV

Length (uint24)

   3 octets

Headers Data (&gt; 1 octet)

   This field carries the provisioning protocol's messages.
</pre><a href="#section-4.3.9-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-4.3.10">
<section id="section-4.3.10">
          <h4 id="name-the-protoheaders-tlv">
<a href="#section-4.3.10" class="section-number selfRef">4.3.10. </a><a href="#name-the-protoheaders-tlv" class="section-name selfRef">The ProtoHeaders TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.10-1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                           Headers Data                       ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   &lt;TBD&gt; - ProtoHeaders TLV

Length (uint24)

   3 octets

Headers Data (&gt; 1 octet)
</pre><a href="#section-4.3.10-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3.10-2">
            <dt id="section-4.3.10-2.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.10-2.2">
      This field carries the meta-data (if any) that might be associated
      with the transport-layer normally used with the provisioning
      protocol.  For example, this TLV can carry the set of HTTP headers
      required by EST or ACME.<a href="#section-4.3.10-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-4.3.11">
<section id="section-4.3.11">
          <h4 id="name-the-params-tlv">
<a href="#section-4.3.11" class="section-number selfRef">4.3.11. </a><a href="#name-the-params-tlv" class="section-name selfRef">The Params TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.11-1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |            Min Length         |          Max Length           |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Algorithm   |     Flags     |     OBJECT IDENTIFIER (DER)  ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   &lt;TBD&gt; - Params TLV

Length (uint24)

   Provides the length of the TLV (&gt;= 6 octets)

Min Length (uint16)
</pre><a href="#section-4.3.11-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3.11-2">
            <dt id="section-4.3.11-2.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.11-2.2">
      Provides the minimum allowed size size for the credentials.  This
      value has meaning depending on the context of the credentials,
      however sizes are always expressed in bytes.<a href="#section-4.3.11-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-4.3.11-3">
            <dt id="section-4.3.11-3.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.11-3.2">
      For example, when used with a symmetric key or a password, the
      ('Min Length') and ('Max Length') refer to the minimum and maximum
      size of the password data.  The ('Algor OID') field can be omitted
      in this case.<a href="#section-4.3.11-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-4.3.11-4">
            <dt id="section-4.3.11-4.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.11-4.2">
      On the other hand, when referring public-key credentials, this
      field should carry the size of the modulus of the key.  For
      example, for an RSA 2048 bit keys, the field should carry the
      value of 256.  For an ECDSA that uses the prime256r1 curve, this
      field should carry the value of 32 and the Algor OID should be the
      DER representation of the specific value of the curve (i.e., the
      DER representation of '1.2.840.10045.3.1.7').<a href="#section-4.3.11-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-4.3.11-5">
            <dt id="section-4.3.11-5.1">Max Length (uint16)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.11-5.2">
              <p id="section-4.3.11-5.2.1">
 Provides the indication maximum size of the credentials.  This
      value has meaning depending on the context of the credentials,
      however sizes are always expressed in bytes.<a href="#section-4.3.11-5.2.1" class="pilcrow">¶</a></p>
<p id="section-4.3.11-5.2.2">
 The same considerations apply to this field as well as the ('Min
      Length') one discussed above.<a href="#section-4.3.11-5.2.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.11-5.3">Algorithm (uint8)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.11-5.4">
 Provides the indication of the algorithm used for the generation
      of the credentials.  The allowed values for this field are listed
      in <a href="#sect-7.4" class="xref">Section 7.4</a>.<a href="#section-4.3.11-5.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.11-5.5">Flags (uint8)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.11-5.6">
              <p id="section-4.3.11-5.6.1">
 Provides a BITMASK that can be used to provide information about
      the status of the credentials (e.g., if the use marks the
      credentials to be compromised).  The bits have the following
      meaning:<a href="#section-4.3.11-5.6.1" class="pilcrow">¶</a></p>
<p id="section-4.3.11-5.6.2">
 Bit 0 - Credentials (or part of it) are to be generated on the
         server<a href="#section-4.3.11-5.6.2" class="pilcrow">¶</a></p>
<p id="section-4.3.11-5.6.3">
 Bit 1 - Credentials (or part of it) are to be generated on the
         peer<a href="#section-4.3.11-5.6.3" class="pilcrow">¶</a></p>
<p id="section-4.3.11-5.6.4">
 Bit 2 - Credentials are to be generated on dedicated hardware<a href="#section-4.3.11-5.6.4" class="pilcrow">¶</a></p>
<p id="section-4.3.11-5.6.5">
 Bit 3 - Reserved<a href="#section-4.3.11-5.6.5" class="pilcrow">¶</a></p>
<p id="section-4.3.11-5.6.6">
 Bit 4 - Reserved<a href="#section-4.3.11-5.6.6" class="pilcrow">¶</a></p>
<p id="section-4.3.11-5.6.7">
 Bit 5 - Reserved<a href="#section-4.3.11-5.6.7" class="pilcrow">¶</a></p>
<p id="section-4.3.11-5.6.8">
 Bit 6 - Reserved<a href="#section-4.3.11-5.6.8" class="pilcrow">¶</a></p>
<p id="section-4.3.11-5.6.9">
 Bit 7 - Reserved<a href="#section-4.3.11-5.6.9" class="pilcrow">¶</a></p>
<p id="section-4.3.11-5.6.10">
 When using public-key based credentials, the bits 0 and 1 are
      mutually exclusive.<a href="#section-4.3.11-5.6.10" class="pilcrow">¶</a></p>
<p id="section-4.3.11-5.6.11">
 When using passwords or shared secrets, if bit 0 is set, then the
      secret is generated by the server and then sent to the client.  On
      the other hand, if bit 1 is set, then the secret is generated by
      the peer and then sent to the server.  Ultimately, if both bits
      are set, then the Server generates the first part of the password
      and sends it to the Peer, while the Peer generates the second part
      of the password and sends it to the Server.  The password to be
      used for future authentication is the concatenation of the two
      shares of the password: first the one from the Server, then the
      one from the Client.<a href="#section-4.3.11-5.6.11" class="pilcrow">¶</a></p>
<p id="section-4.3.11-5.6.12">
 NOTE WELL: Last but not least, since these passwords/secrets
         are meant to be used in a automated fashion, there is no
         restriction around the character set to use or their
         interpretation.  Therefore, it is good practice to generate
         random pass-phrases that use the full 8-bit character set (on
         client and server) to maximize the secret's search space.<a href="#section-4.3.11-5.6.12" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.11-5.7">Object Identifier (binary; &gt; 1 octet)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.11-5.8">
 Provides the indication of additional parameters that are needed
      to be encoded for the credentials.  This value is used only when
      the credentials use public-key cryptography - this field carries
      additional information about the generation algorithm to be used.
      We provide some useful values that can be used as reference:<a href="#section-4.3.11-5.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-object-identifiers-examples"></span><div id="tab-object-identifiers-examples">
<table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-object-identifiers-examples" class="selfRef">Object Identifiers Examples</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1"> OID Name </th>
                <th class="text-left" rowspan="1" colspan="1"> Dotted Representation</th>
                <th class="text-left" rowspan="1" colspan="1"> Binary Encoding </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">secp256r1</td>
                <td class="text-left" rowspan="1" colspan="1">1.2.840.10045.3.1.7</td>
                <td class="text-left" rowspan="1" colspan="1">06 08 2A 86 48 CE 3D 03</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">curve</td>
                <td class="text-left" rowspan="1" colspan="1"></td>
                <td class="text-left" rowspan="1" colspan="1">01 07</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">secp384r1</td>
                <td class="text-left" rowspan="1" colspan="1">1.2.840.10045.3.1.34</td>
                <td class="text-left" rowspan="1" colspan="1">06 08 2A 86 48 CE 3D 03</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">curve</td>
                <td class="text-left" rowspan="1" colspan="1"></td>
                <td class="text-left" rowspan="1" colspan="1">01 22</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">secp521r1</td>
                <td class="text-left" rowspan="1" colspan="1">1.2.840.10045.3.1.35</td>
                <td class="text-left" rowspan="1" colspan="1">06 08 2A 86 48 CE 3D 03</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">curve</td>
                <td class="text-left" rowspan="1" colspan="1"></td>
                <td class="text-left" rowspan="1" colspan="1">01 23</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">X25519 curve</td>
                <td class="text-left" rowspan="1" colspan="1">1.3.101.110</td>
                <td class="text-left" rowspan="1" colspan="1">06 03 2B 65 6E</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">X25519 curve</td>
                <td class="text-left" rowspan="1" colspan="1">1.3.101.110</td>
                <td class="text-left" rowspan="1" colspan="1">06 03 2B 65 6E</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">X448 curve</td>
                <td class="text-left" rowspan="1" colspan="1">1.3.101.111</td>
                <td class="text-left" rowspan="1" colspan="1">06 03 2B 65 6F</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Ed25519 curve</td>
                <td class="text-left" rowspan="1" colspan="1">1.3.101.112</td>
                <td class="text-left" rowspan="1" colspan="1">06 03 2B 65 70</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Ed448 curve</td>
                <td class="text-left" rowspan="1" colspan="1">1.3.101.113</td>
                <td class="text-left" rowspan="1" colspan="1">06 03 2B 65 71</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="sect-4.3.12">
<section id="section-4.3.12">
          <h4 id="name-the-token-tlv">
<a href="#section-4.3.12" class="section-number selfRef">4.3.12. </a><a href="#name-the-token-tlv" class="section-name selfRef">The Token TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.12-1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |  Token Type   |    Encoding   |             Value            ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   &lt;TBD&gt; - Token TLV

TLV Length (uint24)

   Provides the length of the TLV (&gt; 3 octets)

Token Type (uint8)
</pre><a href="#section-4.3.12-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3.12-2">
            <dt id="section-4.3.12-2.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.12-2.2">
      Provides the indication of the type of credentials.  The allowed
      values for this field are listed in <a href="#sect-7.2" class="xref">Section 7.2</a>.<a href="#section-4.3.12-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-4.3.12-3">
            <dt id="section-4.3.12-3.1">Encoding (uint8)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.12-3.2">
 Provides the indication of the Encoding the credentials are in.
      The allowed values for this field are listed in <a href="#sect-7.7" class="xref">Section 7.7</a>.<a href="#section-4.3.12-3.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.12-3.3">Value (octet string)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.12-3.4">
 This field carries the data for the credentials.<a href="#section-4.3.12-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-4.3.13">
<section id="section-4.3.13">
          <h4 id="name-the-version-tlv">
<a href="#section-4.3.13" class="section-number selfRef">4.3.13. </a><a href="#name-the-version-tlv" class="section-name selfRef">The Version TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.3.13-1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Version     |
 +-+-+-+-+-+-+-+-+

TLV Type (uint8)

   &lt;TBD&gt; - Version TLV

TLV Length (uint24)
</pre><a href="#section-4.3.13-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3.13-2">
            <dt id="section-4.3.13-2.1"></dt>
            <dd style="margin-left: 1.5em" id="section-4.3.13-2.2">
      Provides the length of the TLV.  The field has a fixed value of 1.<a href="#section-4.3.13-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-4.3.13-3">
            <dt id="section-4.3.13-3.1">Version (uint8)</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.13-3.2">
              <p id="section-4.3.13-3.2.1">
 The Version field represents the specific version of the EAP-CREDS
      protocol that are supported by the end point.  When multiple
      versions of EAP-CREDS are supported, multiple ('Version') TLVs can
      be used.<a href="#section-4.3.13-3.2.1" class="pilcrow">¶</a></p>
<p id="section-4.3.13-3.2.2">
 When no version is specified (i.e., either it does not support
      multiple versions or it does not matter), the value of this field
      should be set to '0x0' (any version).<a href="#section-4.3.13-3.2.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-5">
<section id="section-5">
      <h2 id="name-eap-creds-messages">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-eap-creds-messages" class="section-name selfRef">EAP-CREDS Messages</a>
      </h2>
<p id="section-5-1">
   This section describes each message and what TLVs are allowed or
   required.  EAP-CREDS defines the following values for the Message
   Type (Type):<a href="#section-5-1" class="pilcrow">¶</a></p>
<span id="name-eap-creds-message-types"></span><div id="tab-eap-creds-message-types">
<table class="center" id="table-3">
        <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-eap-creds-message-types" class="selfRef">EAP-CREDS Message Types</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1"> Message Type</th>
            <th class="text-left" rowspan="1" colspan="1"> Name </th>
            <th class="text-left" rowspan="1" colspan="1"> Description </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">EAP-CREDS-Init</td>
            <td class="text-left" rowspan="1" colspan="1">Initialization Phase;</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">EAP-CREDS-Provisioning</td>
            <td class="text-left" rowspan="1" colspan="1">Carries Provisioning</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1">Protocol Messages;</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">EAP-CREDS-Validate</td>
            <td class="text-left" rowspan="1" colspan="1">Validates newly installed</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1">credentials;</td>
          </tr>
        </tbody>
      </table>
</div>
<div id="sect-5.1">
<section id="section-5.1">
        <h3 id="name-the-eap-creds-init-message">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-the-eap-creds-init-message" class="section-name selfRef">The EAP-CREDS-Init Message</a>
        </h3>
<p id="section-5.1-1">
   The EAP-CREDS-Init message type is used in Phase One only of EAP-
   CREDS.  The message flow is depicted in <a href="#sect-3.3" class="xref">Section 3.3</a>.  This message
   supports the following TLVs: Version, Protocol, Creds-Info, and
   Error.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="sect-5.1.1">
<section id="section-5.1.1">
          <h4 id="name-eap-servers-init-message">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-eap-servers-init-message" class="section-name selfRef">EAP Server's Init Message</a>
          </h4>
<p id="section-5.1.1-1">
   EAP-CREDS starts with an ('EAP-CREDS-Init') message from the server.
   This message MAY contain zero, one, or more ('Version') TLVs and,
   optionally, a ('Challenge-Data') TLV.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">
   The first message from the server is the one that starts Phase One,
   therefore the Server MUST set the headers' 'S' (Start) bit to '1'
   (Start) and the headers' 'Phase' value to '1' (Phase One).<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-3">
   The Server uses one or more ('Version') TLVs in the EAP-Request/EAP-
   CREDS(Type=Init) message to provide the Peer with the list of EAP-
   CREDS versions supported.  If omitted, the implicit version of EAP-
   CREDS used in the session is one ('0x1').  If the Server detects
   multiple occurrences of this TLV in the reply from the Peer, an error
   shall be issued and the EAP-CREDS session should be terminated.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4">
   In case Token-Based registration is enabled on the Server, the Server
   MUST include, in its Init message, a ('Challenge-Data') field that
   can be used by the client to provide challenge data for proof-of-
   possession of secrets.<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.1.2">
<section id="section-5.1.2">
          <h4 id="name-eap-peers-init-message">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-eap-peers-init-message" class="section-name selfRef">EAP Peer's Init Message</a>
          </h4>
<p id="section-5.1.2-1">
   The Peer MUST reply to the Server's ('EAP-CREDS-Init') message with
   its own ('EAP-CREDS-Init') one.  The Peer SHOULD include one
   ('Version') TLV in its first message to indicate the version of EAP-
   CREDS that the client wants to use for the session.  The Peer MUST
   also provide the list of supported provisioning protocols (via one or
   more the 'Protocol' TLV), the list and status of the installed
   credentials (via the 'Creds-Info' TLV).  The Peer MAY include
   authorization data when registering new credentials (e.g., an
   authorization token or a device certificate) via the ('Token') and
   ('Challenge-Response') TLV.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">
   The Peer MUST include one ('Creds-Info') TLV for each credential the
   Network is authorized to manage.  Typically, a Peer will include only
   one ('Creds-Info') TLV in its ('EAP-CREDS-Init') message, but there
   might be cases where multiple types of credentials are available and
   selected depending on the location and other factors (e.g., X.509
   certificate and username/password combination).<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">
   In case the Peer does not have any credentials available yet, it does
   not add any ('Creds-Info') TLV - leaving the Server with the only
   action possible: Registration.  In this case, the Peer SHOULD include
   authorization information via the ('Token') TLV as described in
   <a href="#sect-5.1.2.1" class="xref">Section 5.1.2.1</a>.  Additionally, the Peer can add the ('Profile') TLV
   to indicate a preferred profile for the credentials.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<div id="sect-5.1.2.1">
<section id="section-5.1.2.1">
            <h5 id="name-bootstrapping-peers-trustwo">
<a href="#section-5.1.2.1" class="section-number selfRef">5.1.2.1. </a><a href="#name-bootstrapping-peers-trustwo" class="section-name selfRef">Bootstrapping Peer's Trustworthiness</a>
            </h5>
<p id="section-5.1.2.1-1">
   When the Peer does not have any valid credentials for the Network
   that it is authenticating to, it does not provide any ('Creds-Info')
   TLV.  This indicates to the Server that new credentials MUST be
   registered before the Peer is allowed on the network.<a href="#section-5.1.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2.1-2">
   The Registration process might rely on information exchanged during
   the Provisioning Process in Phase Two. However, if an authorization
   mechanism is not available from the supported provisioning protocol
   and no credentials are available on the Peer, EAP-CREDS provides a
   simple mechanism for the Peer to leverage an out-of-band
   token/passphrase/ott that may be already available on the Peer (e.g.,
   a device certificate or a 'spendable' credentials token like a
   kerberos ticket or a crypto-currency transaction) and that can be
   verified by the Server.<a href="#section-5.1.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2.1-3">
   In particular, when the Peer wants to register new credentials (and
   the Server requires the use of additional authorization data) it may
   need to provide (a) a Token, (b) a challenge value, and (c) a
   response to the challenge value.  To do so, the Peer MUST encode the
   token in a ('Token') TLV, the challenge value in a ('Challenge-Data')
   TLV, and, finally, the response to the challenge in the ('Challenge-
   Response') TLV.<a href="#section-5.1.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.2.1-4">
   The use of ('Challenge-Data') and ('Challenge-Response') TLVs is
   optional, however it is suggested that if a token is used for
   bootstrapping the trust, it should provide a way to verify a secret
   associated with it.<a href="#section-5.1.2.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1.2.1-5">
   It is also very important that the authorization token is disclosed
   only to authorized servers - the Peer MUST NOT disclose authorization
   tokens that are not meant for the network that is being accessed.
   This can be done, usually, by verifying the identity of the Server
   first (in the outer mechanism) and then verify that the target of the
   Token is the Server the Client is talking to.<a href="#section-5.1.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-5.1.3">
<section id="section-5.1.3">
          <h4 id="name-the-eap-creds-provisioning-">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-the-eap-creds-provisioning-" class="section-name selfRef">The EAP-CREDS-Provisioning Message</a>
          </h4>
<p id="section-5.1.3-1">
   The EAP-CREDS-Provisioning message type is used in Phase Two only of
   EAP-CREDS.  The message flow is depicted in <a href="#sect-3.4" class="xref">Section 3.4</a>.  This
   message type supports the following TLVs: Protocol, Profile, Creds-
   Info, ProtoHeaders, ProtoData, Token, and Error.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.1.3-2">
   After the exchange of phase one messages, the Server MAY start phase
   two by issuing an ('EAP-CREDS-Provisioning') message for the Peer
   where it encodes all the required details for starting the
   provisioning process.  In particular, the server sends the selected
   ('Action'), ('Protocol'), and metadata to the client in a EAP-
   Request/EAP-CREDS(Type=Provisioning) message.  The header's 'S'
   (Start) bit MUST be set to '1' (Start) and the 'Phase' value set to
   '2' (Phase Two begins).<a href="#section-5.1.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1.3-3">
            <dt id="section-5.1.3-3.1"></dt>
            <dd style="margin-left: 1.5em" id="section-5.1.3-3.2">
      NOTE WELL: After the initial message, the only TLVs that are
      allowed in messages coming from the server are the usual
      ('ProtoHeaders') ('ProtoData'), and ('Error').<a href="#section-5.1.3-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.3-4">
   The client checks that all the selected parameters are supported for
   the selected credentials and, if no errors are detected, it sends its
   first ('EAP-CREDS-Provisioning') message to the Server with the
   ('ProtoHeaders') and ('ProtoData') TLVs only.<a href="#section-5.1.3-4" class="pilcrow">¶</a></p>
<p id="section-5.1.3-5">
   From now on, the conversation between the Peer and the Server
   continues until an error is detected or the provisioning protocol
   completes successfully.<a href="#section-5.1.3-5" class="pilcrow">¶</a></p>
<p id="section-5.1.3-6">
   If no other actions, the server MAY continue with phase three or
   issue a success message and terminate the EAP session.<a href="#section-5.1.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.1.4">
<section id="section-5.1.4">
          <h4 id="name-the-eap-creds-validate-mess">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-the-eap-creds-validate-mess" class="section-name selfRef">The EAP-CREDS-Validate Message</a>
          </h4>
<p id="section-5.1.4-1">
   The EAP-CREDS-Validate message type is used in Phase Three only of
   EAP-CREDS.  The message flow is depicted in <a href="#sect-3.5" class="xref">Section 3.5</a>.  This
   message type supports the following TLVs: Protocol, Creds-Info,
   ProtoHeaders, ProtoData, Token, and Error.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4-2">
   After Phase One (and/or Phase Two) ends, the Server MAY start phase
   three by issuing an ('EAP-CREDS-Validate') message for the Peer where
   it encodes all the required details for starting the validation
   process.  In particular, the server sends the ('Creds-Info'), a
   ('Challenge-Data'), and the ('Phase') fields in a EAP-Request/EAP-
   CREDS(Type=Validate) message.  The ('Phase') field should carry the
   '1' value for the 'S' (Start) bit (Start) and the number '3' for its
   value (Phase Three begins).<a href="#section-5.1.4-2" class="pilcrow">¶</a></p>
<p id="section-5.1.4-3">
   The Peer generates the answer to the Challenge and sends back a EAP-
   Response/EAP-CREDS(Type=Validate) message with the ('Challenge-
   Response') and an optional ('Challenge-Data') field (only for server-
   side validation of the symmetric credentials).  If the Peer requested
   server-side validation of the credentials, the Server MUST include
   (if a symmetric secret) the response to the Peer-issued ('Challenge-
   Data') TLV by computing the response and adding it to the
   ('Challenge-Response') TLV in its reply.<a href="#section-5.1.4-3" class="pilcrow">¶</a></p>
<p id="section-5.1.4-4">
   Finally, in the last message, the Server (if Phase Three is to be
   ended) SHALL include the ('Phase') field with the 'S' (Start) bit set
   to '0' (end of phase) and the value set to '3' (Phase Three ended).<a href="#section-5.1.4-4" class="pilcrow">¶</a></p>
<p id="section-5.1.4-5">
   At this point, EAP-CREDS has terminated all possible operations and
   can be terminated.  The Server can now terminate the EAP session
   successfully.  In case the Peer was not authenticated during the
   tunnel establishment (i.e., no credentials were already available on
   the Peer), the Server should terminate the EAP session with a Failure
   (thus requiring the device to re-attach and authenticate to the
   network - phase two should have provided the Peer with the
   credentials to use for authenticating to the Network).<a href="#section-5.1.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-6">
<section id="section-6">
      <h2 id="name-error-handling-in-eap-creds">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-error-handling-in-eap-creds" class="section-name selfRef">Error Handling in EAP-CREDS</a>
      </h2>
<p id="section-6-1">
   This section provides a description of the error handling by using
   the CREDS-Error-TLV in a CREDS message.  &lt;TBD&gt;<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">
   This document uses a new EAP type, EAP-CREDS, whose value (TBD) MUST
   be allocated by IANA from the EAP TYPEs sub-registry of the RADIUS
   registry.  This section provides guidance to the Internet Assigned
   Numbers Authority (IANA) regarding registration of values related to
   the EAP-CREDS protocol, in accordance with <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">
   The EAP Method Type number for EAP-CREDS needs to be assigned.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">
   This document also requires IANA to create new registries as defined
   in the following subsections.<a href="#section-7-3" class="pilcrow">¶</a></p>
<div id="sect-7.1">
<section id="section-7.1">
        <h3 id="name-provisioning-protocols">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-provisioning-protocols" class="section-name selfRef">Provisioning Protocols</a>
        </h3>
<span id="name-eap-creds-inner-protocol-id"></span><div id="tab-eap-creds-inner-protocol-identifiers">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-eap-creds-inner-protocol-id" class="selfRef">EAP-CREDS Inner Protocol Identifiers</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Message Type</th>
              <th class="text-left" rowspan="1" colspan="1"> Purpose</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Unspecified</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Simple Provisioning Protocol (SPP)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Basic Certificate Management Protocol (CMP-S)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Full Certificate Management Protocol (CMP-F)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">Enrollment over Secure Transport (EST)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">Certificate Management over CMS (CMC)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">Automatic Certificate Management Environment</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"></td>
              <td class="text-left" rowspan="1" colspan="1">(ACME)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">...</td>
              <td class="text-left" rowspan="1" colspan="1">...</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">49141 ... 65534</td>
              <td class="text-left" rowspan="1" colspan="1">Vendor Specific</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.1-2">
   Assignment of new values for new cryptosuites MUST be done through
   IANA with "Specification Required" and "IESG Approval" as defined in
   <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.2">
<section id="section-7.2">
        <h3 id="name-token-types">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-token-types" class="section-name selfRef">Token Types</a>
        </h3>
<span id="name-token-types-in-token-tlv"></span><div id="tab-token-types-in-token-tlv">
<table class="center" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-token-types-in-token-tlv" class="selfRef">Token Types in ('Token') TLV</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Token Type</th>
              <th class="text-left" rowspan="1" colspan="1"> Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Unspecified</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">JWT</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Kerberos</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">OAuth</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">Certificate</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">200..254</td>
              <td class="text-left" rowspan="1" colspan="1">Vendor Specific</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.2-2">
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.3">
<section id="section-7.3">
        <h3 id="name-credentials-types">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-credentials-types" class="section-name selfRef">Credentials Types</a>
        </h3>
<span id="name-credentials-types-in-creds-"></span><div id="tab-credentials-types-in-creds-info-tlv">
<table class="center" id="table-6">
          <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-credentials-types-in-creds-" class="selfRef">Credentials Types in ('Creds-Info') TLV</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Credentials Type</th>
              <th class="text-left" rowspan="1" colspan="1"> Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">X.509 Certificate</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Public Key</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Symmetric Key</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Username and Password</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">AKA Subscriber Key</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">Bearer Token</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">One-Time Token</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">API Key</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.3-2">
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.4">
<section id="section-7.4">
        <h3 id="name-credentials-algorithms">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-credentials-algorithms" class="section-name selfRef">Credentials Algorithms</a>
        </h3>
<span id="name-credentials-algorithms-in-p"></span><div id="tab-credentials-algorithms-in-param-tlv">
<table class="center" id="table-7">
          <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-credentials-algorithms-in-p" class="selfRef">Credentials Algorithms in ('Param') TLV</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> ID</th>
              <th class="text-left" rowspan="1" colspan="1"> Algorithm</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">None</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">RSA</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">ECDSA</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">XMMS</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">AKA Subscriber Key</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">OAuth</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">Kerberos4</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">Kerberos5</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">200-254</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.4-2">
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.5">
<section id="section-7.5">
        <h3 id="name-challenge-types">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-challenge-types" class="section-name selfRef">Challenge Types</a>
        </h3>
<span id="name-challenge-type-in-challenge"></span><div id="tab-challenge-type-in-challenge-tlv">
<table class="center" id="table-8">
          <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-challenge-type-in-challenge" class="selfRef">Challenge Type in ('Challenge') TLV</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> ID</th>
              <th class="text-left" rowspan="1" colspan="1"> Data Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Not Specified</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">EAP-CREDS-ASYMMETRIC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">EAP-CREDS-SYMMETRIC</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.5-2">
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.6">
<section id="section-7.6">
        <h3 id="name-network-usage-datatypes">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-network-usage-datatypes" class="section-name selfRef">Network Usage Datatypes</a>
        </h3>
<span id="name-network-usage-datatypes-in-"></span><div id="tab-network-usage-datatypes-in-net-usage-tlv">
<table class="center" id="table-9">
          <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-network-usage-datatypes-in-" class="selfRef">Network Usage Datatypes in ('Net-Usage') TLV</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> ID</th>
              <th class="text-left" rowspan="1" colspan="1"> Data Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Vendor-Specific</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Manufacturer Usage Description [RFC8520]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Network Access Granting System</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Firmware Manifest</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4..127</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved for Future Use</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.6-2">
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-7.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.7">
<section id="section-7.7">
        <h3 id="name-credentials-encoding">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-credentials-encoding" class="section-name selfRef">Credentials Encoding</a>
        </h3>
<span id="name-credentials-encoding-in-tok"></span><div id="tab-credentials-encoding-in-token-tlv">
<table class="center" id="table-10">
          <caption>
<a href="#table-10" class="selfRef">Table 10</a>:
<a href="#name-credentials-encoding-in-tok" class="selfRef">Credentials Encoding in ('Token') TLV</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> ID</th>
              <th class="text-left" rowspan="1" colspan="1"> Encoding</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">None (Raw)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">DER</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">PEM</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Base64</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">JSON</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">XML</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">ASCII</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">UTF-8</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">200-254</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.7-2">
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-7.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.8">
<section id="section-7.8">
        <h3 id="name-action-types">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-action-types" class="section-name selfRef">Action Types</a>
        </h3>
<span id="name-action-types-in-action-tlv"></span><div id="tab-action-types-in-action-tlv">
<table class="center" id="table-11">
          <caption>
<a href="#table-11" class="selfRef">Table 11</a>:
<a href="#name-action-types-in-action-tlv" class="selfRef">Action Types in ('Action') TLV</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> ID</th>
              <th class="text-left" rowspan="1" colspan="1"> Data Type</th>
              <th class="text-left" rowspan="1" colspan="1"> Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Registration</td>
              <td class="text-left" rowspan="1" colspan="1">Registers New Credentials</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Renewal</td>
              <td class="text-left" rowspan="1" colspan="1">Renew an Existing Credential</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Remove</td>
              <td class="text-left" rowspan="1" colspan="1">Removes an Existing Credential</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">200-254</td>
              <td class="text-left" rowspan="1" colspan="1">n/a</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.8-2">
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-7.8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.9">
<section id="section-7.9">
        <h3 id="name-usage-metadata-types">
<a href="#section-7.9" class="section-number selfRef">7.9. </a><a href="#name-usage-metadata-types" class="section-name selfRef">Usage Metadata Types</a>
        </h3>
<span id="name-usage-metadata-types-in-net"></span><div id="tab-usage-metadata-types-in-net-usage-tlv">
<table class="center" id="table-12">
          <caption>
<a href="#table-12" class="selfRef">Table 12</a>:
<a href="#name-usage-metadata-types-in-net" class="selfRef">Usage Metadata Types in ('Net-Usage') TLV</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> Type</th>
              <th class="text-left" rowspan="1" colspan="1"> Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Binary (Unspecified)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">MUD File</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">TEEP Manifest</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.9-2">
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-7.9-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-8">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">
   Several security considerations need to be explicitly considered for
   the system administrators and application developers to understand
   the weaknesses of the overall architecture.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">
   The most important security consideration when deploying EAP-CREDS is
   related to the security of the outer channel.  In particular, EAP-
   CREDS assumes that the communication channel has been properly
   authenticated and that the information exchanged between the Peer and
   the Server are protected (i.e., confidentiality and integrity).<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">
   For example, if certificate-based authentication is used, the server
   presents a certificate to the peer as part of the trust establishment
   (or negotiation).  The peer SHOULD verify the validity of the EAP
   server certificate and SHOULD also examine the EAP server name
   presented in the certificate in order to determine whether the EAP
   server can be trusted.  When performing server certificate
   validation, implementations MUST provide support for the rules in
   <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> for validating certificates against a known trust anchor.<a href="#section-8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-9">
<section id="section-9">
      <h2 id="name-acknowledgments">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-9-1">
   The authors would like to thank everybody who provided insightful
   comments and helped in the definition of the deployment
   considerations.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-normative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3279">[RFC3279]</dt>
      <dd>
<span class="refAuthor">Bassham, L.</span>, <span class="refAuthor">Polk, W.</span>, and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 3279</span>, <span class="seriesInfo">DOI 10.17487/RFC3279</span>, <time datetime="2002-04" class="refDate">April 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3279">https://www.rfc-editor.org/info/rfc3279</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3748">[RFC3748]</dt>
      <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Carlson, J.</span>, and <span class="refAuthor">H. Levkowetz, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3748</span>, <span class="seriesInfo">DOI 10.17487/RFC3748</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3748">https://www.rfc-editor.org/info/rfc3748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4055">[RFC4055]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Kaliski, B.</span>, and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 4055</span>, <span class="seriesInfo">DOI 10.17487/RFC4055</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4055">https://www.rfc-editor.org/info/rfc4055</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4210">[RFC4210]</dt>
      <dd>
<span class="refAuthor">Adams, C.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Kause, T.</span>, and <span class="refAuthor">T. Mononen</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)"</span>, <span class="seriesInfo">RFC 4210</span>, <span class="seriesInfo">DOI 10.17487/RFC4210</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4210">https://www.rfc-editor.org/info/rfc4210</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4491">[RFC4491]</dt>
      <dd>
<span class="refAuthor">Leontiev, S., Ed.</span> and <span class="refAuthor">D. Shefanovski, Ed.</span>, <span class="refTitle">"Using the GOST R 34.10-94, GOST R 34.10-2001, and GOST R 34.11-94 Algorithms with the Internet X.509 Public Key Infrastructure Certificate and CRL Profile"</span>, <span class="seriesInfo">RFC 4491</span>, <span class="seriesInfo">DOI 10.17487/RFC4491</span>, <time datetime="2006-05" class="refDate">May 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4491">https://www.rfc-editor.org/info/rfc4491</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5272">[RFC5272]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC)"</span>, <span class="seriesInfo">RFC 5272</span>, <span class="seriesInfo">DOI 10.17487/RFC5272</span>, <time datetime="2008-06" class="refDate">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5272">https://www.rfc-editor.org/info/rfc5272</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
      <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6402">[RFC6402]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Certificate Management over CMS (CMC) Updates"</span>, <span class="seriesInfo">RFC 6402</span>, <span class="seriesInfo">DOI 10.17487/RFC6402</span>, <time datetime="2011-11" class="refDate">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6402">https://www.rfc-editor.org/info/rfc6402</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7030">[RFC7030]</dt>
      <dd>
<span class="refAuthor">Pritikin, M., Ed.</span>, <span class="refAuthor">Yee, P., Ed.</span>, and <span class="refAuthor">D. Harkins, Ed.</span>, <span class="refTitle">"Enrollment over Secure Transport"</span>, <span class="seriesInfo">RFC 7030</span>, <span class="seriesInfo">DOI 10.17487/RFC7030</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7030">https://www.rfc-editor.org/info/rfc7030</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
      <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8520">[RFC8520]</dt>
      <dd>
<span class="refAuthor">Lear, E.</span>, <span class="refAuthor">Droms, R.</span>, and <span class="refAuthor">D. Romascanu</span>, <span class="refTitle">"Manufacturer Usage Description Specification"</span>, <span class="seriesInfo">RFC 8520</span>, <span class="seriesInfo">DOI 10.17487/RFC8520</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8520">https://www.rfc-editor.org/info/rfc8520</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8555">[RFC8555]</dt>
    <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8555">https://www.rfc-editor.org/info/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Massimiliano Pala</span></div>
<div dir="auto" class="left"><span class="org">CableLabs</span></div>
<div dir="auto" class="left"><span class="street-address">858 Coal Creek Cir<br>Louisville, CO 80027<br>US</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:m.pala@openca.org" class="email">m.pala@openca.org</a>
</div>
<div class="url">
<span>URI:</span>
<a href="http://www.linkedin.com/in/mpala" class="url">http://www.linkedin.com/in/mpala</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yuan Tian</span></div>
<div dir="auto" class="left"><span class="org">CableLabs</span></div>
<div dir="auto" class="left"><span class="street-address">858 Coal Creek Cir<br>Louisville, CO 80027<br>US</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:y.tian@cablelabs.com" class="email">y.tian@cablelabs.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="http://www.linkedin.com/in/ytian21" class="url">http://www.linkedin.com/in/ytian21</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
