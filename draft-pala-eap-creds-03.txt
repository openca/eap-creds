



Network Working Group                                            M. Pala
Internet-Draft                                                 CableLabs
Intended status: Standards Track                            June 7, 2019
Expires: December 9, 2019


      Credentials Provisioning and Management via EAP (EAP-CREDS)
                        draft-pala-eap-creds-03

Abstract

   With the increase number of devices, protocols, and applications that
   rely on strong credentials (e.g., digital certificates, keys, or
   tokens) for network access, the need for a standardized credentials
   provisioning and management framework is paramount.  The 802.1x
   architecture allows for entities (e.g., devices, applications, etc.)
   to authenticate to the network by providing a communication channel
   where different methods can be used to exchange different types of
   credentials.  However, the need for managing these credentials (i.e.,
   provisioning and renewal) is still a hard problem to solve.

   EAP-CREDS, if implemented in Managed Networks (e.g., Cable Modems),
   could enable our operators to offer a registration and credentials
   management service integrated in the home WiFi thus enabling
   visibility about registered devices.  During initialization, EAP-
   CREDS also allows for MUD files or URLs to be transferred between the
   EAP Peer and the EAP Server, thus giving detailed visibility about
   devices when they are provisioned with credentials for accessing the
   networks.  The possibility provided by EAP-CREDS can help to secure
   home or business networks by leveraging the synergies of the security
   teams from the network operators thanks to the extended knowledge of
   what and how is registered/authenticated.

   This specifications define how to support the provisioning and
   management of authentication credentials that can be exploited in
   different environments (e.g., Wired, WiFi, cellular, etc.) to users
   and/or devices by using EAP together with standard provisioning
   protocols.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.



Pala                    Expires December 9, 2019                [Page 1]

Internet-Draft                  EAP-CREDS                      June 2019


   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on December 9, 2019.

Copyright Notice

   Copyright (c) 2019 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Requirements notation . . . . . . . . . . . . . . . . . . . .   4
   2.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   4
     2.1.  Overview of existing solutions  . . . . . . . . . . . . .   4
     2.2.  Scope Statement . . . . . . . . . . . . . . . . . . . . .   5
     2.3.  EAP-CREDS as tunneled mechanism only  . . . . . . . . . .   5
     2.4.  Notation  . . . . . . . . . . . . . . . . . . . . . . . .   5
   3.  EAP-CREDS Protocol  . . . . . . . . . . . . . . . . . . . . .   6
     3.1.  Message Flow  . . . . . . . . . . . . . . . . . . . . . .   6
       3.1.1.  Phase Transition Rules  . . . . . . . . . . . . . . .   7
     3.2.  Phase One: Initialization . . . . . . . . . . . . . . . .   8
       3.2.1.  Phase One State Machine . . . . . . . . . . . . . . .  10
     3.3.  Phase Two: Provisioning . . . . . . . . . . . . . . . . .  12
       3.3.1.  Phase Two State Machine . . . . . . . . . . . . . . .  13
     3.4.  Phase Three: Validation . . . . . . . . . . . . . . . . .  14
       3.4.1.  Phase Three State Machine . . . . . . . . . . . . . .  17
   4.  EAP-CREDS Message Format  . . . . . . . . . . . . . . . . . .  18
     4.1.  Message Header  . . . . . . . . . . . . . . . . . . . . .  19
     4.2.  Message Payload . . . . . . . . . . . . . . . . . . . . .  19
       4.2.1.  General TLV format  . . . . . . . . . . . . . . . . .  20
       4.2.2.  EAP-CREDS defined TLVs  . . . . . . . . . . . . . . .  21
         4.2.2.1.  The Action TLV  . . . . . . . . . . . . . . . . .  21
         4.2.2.2.  The Certificate-Data TLV  . . . . . . . . . . . .  22
         4.2.2.3.  The Challenge-Data TLV  . . . . . . . . . . . . .  23
         4.2.2.4.  The Challenge-Response TLV  . . . . . . . . . . .  24



Pala                    Expires December 9, 2019                [Page 2]

Internet-Draft                  EAP-CREDS                      June 2019


         4.2.2.5.  The Credentials-Information TLV . . . . . . . . .  24
         4.2.2.6.  The Credentials-Data TLV  . . . . . . . . . . . .  28
         4.2.2.7.  The Error TLV . . . . . . . . . . . . . . . . . .  28
         4.2.2.8.  The Peer-Description TLV  . . . . . . . . . . . .  29
         4.2.2.9.  The Phase-Control TLV . . . . . . . . . . . . . .  30
         4.2.2.10. The Profile TLV . . . . . . . . . . . . . . . . .  31
         4.2.2.11. The Protocol TLV  . . . . . . . . . . . . . . . .  32
         4.2.2.12. The Provisioning-Data TLV . . . . . . . . . . . .  32
         4.2.2.13. The Provisioning-Headers TLV  . . . . . . . . . .  33
         4.2.2.14. The Provisioning-Params TLV . . . . . . . . . . .  33
         4.2.2.15. The Certificate-Request TLV . . . . . . . . . . .  36
         4.2.2.16. The Storage-Info TLV  . . . . . . . . . . . . . .  37
         4.2.2.17. The Supported-Formats TLV . . . . . . . . . . . .  38
         4.2.2.18. The Supported-Encoding TLV  . . . . . . . . . . .  38
         4.2.2.19. The Token-Data TLV  . . . . . . . . . . . . . . .  39
         4.2.2.20. The Version TLV . . . . . . . . . . . . . . . . .  40
   5.  EAP-CREDS Messages  . . . . . . . . . . . . . . . . . . . . .  40
     5.1.  The EAP-CREDS-Init Message  . . . . . . . . . . . . . . .  41
       5.1.1.  EAP Server's Init Message . . . . . . . . . . . . . .  41
       5.1.2.  EAP Peer's Init Message . . . . . . . . . . . . . . .  41
         5.1.2.1.  Bootstrapping Peer's Trustworthiness  . . . . . .  42
     5.2.  The EAP-CREDS-ProtoFlow Message . . . . . . . . . . . . .  43
     5.3.  The EAP-CREDS-Validate Message  . . . . . . . . . . . . .  44
       5.3.1.  Algorithm Requirements  . . . . . . . . . . . . . . .  44
   6.  Error Handling in EAP-CREDS . . . . . . . . . . . . . . . . .  45
   7.  Fragmentation . . . . . . . . . . . . . . . . . . . . . . . .  45
   8.  Encapsulating Provisioning Protocols in EAP-CREDS . . . . . .  45
   9.  EAP-CREDS and Simple Provisioning Protocol (SPP)  . . . . . .  46
     9.1.  SPP Message Format  . . . . . . . . . . . . . . . . . . .  47
     9.2.  SPP Message Flow  . . . . . . . . . . . . . . . . . . . .  47
       9.2.1.  SPP Password Provisioning . . . . . . . . . . . . . .  48
     9.3.  SPP: Renewing Credentials . . . . . . . . . . . . . . . .  49
     9.4.  SPP: Removing Credentials . . . . . . . . . . . . . . . .  49
     9.5.  SPP Certificate Provisioning  . . . . . . . . . . . . . .  49
   10. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  50
     10.1.  Provisioning Protocols . . . . . . . . . . . . . . . . .  50
     10.2.  Token Types  . . . . . . . . . . . . . . . . . . . . . .  50
     10.3.  Credentials Types  . . . . . . . . . . . . . . . . . . .  51
     10.4.  Credentials Algorithms . . . . . . . . . . . . . . . . .  51
     10.5.  Credentials Datatypes  . . . . . . . . . . . . . . . . .  52
     10.6.  Credentials Encoding . . . . . . . . . . . . . . . . . .  52
     10.7.  Action Types . . . . . . . . . . . . . . . . . . . . . .  53
     10.8.  Usage Metadata Types . . . . . . . . . . . . . . . . . .  53
   11. Security Considerations . . . . . . . . . . . . . . . . . . .  54
   12. Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  54
   13. Normative References  . . . . . . . . . . . . . . . . . . . .  54
   Appendix A.  EAP-CREDS Example Message Flow for Provisioning
                Standards  . . . . . . . . . . . . . . . . . . . . .  55



Pala                    Expires December 9, 2019                [Page 3]

Internet-Draft                  EAP-CREDS                      June 2019


     A.1.  EAP-CREDS and CMP . . . . . . . . . . . . . . . . . . . .  55
     A.2.  EAP-CREDS and EST . . . . . . . . . . . . . . . . . . . .  55
     A.3.  EAP-CREDS and CMS . . . . . . . . . . . . . . . . . . . .  55
     A.4.  EAP-CREDS and ACME  . . . . . . . . . . . . . . . . . . .  55
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  55

1.  Requirements notation

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

2.  Introduction

   Many environments are, today, moving towards requiring strong
   authentication when it comes to gain access to networks.  The 802.1x
   architecture provides network administrators with the possibility to
   check credentials presented by a device even before providing any
   connectivity or IP services to it.

   However, the provisioning and management of these credentials is a
   hard problem to solve and many vendors opt for long-lived credentials
   that can not be easily revoked, replaced, or simply renewed.

   This specification addresses the problem of providing a simple-to-use
   and simple-to-deploy conduit for credentials management by extending
   the EAP protocol to support credentials provisioning and management
   functionality.  In particular, the EAP-CREDS method defined here
   provides a generic framework that can carry the messages for
   provisioning different types of credentials.  EAP-CREDS cannot be
   used as a stand-alone method, it is required that EAP-CREDS is used
   as an inner method of EAP-TLS, EAP-TEAP, or any other tunnelling
   method that can provide the required secrecy and (at minimum) server-
   side authentication to make sure that the communication is protected
   and with the right server.

2.1.  Overview of existing solutions

   Currently there are many protocols that address credentials lifecycle
   management.  In particular, when it comes to digital certificates,
   some of the most deployed management protocols are: Certificate
   Management Protocol (CMP) [RFC4210], Certificate Management over CMS
   (CMC) [RFC5272][RFC6402], Enrollment over Secure Transport (EST)
   [RFC7030], and Automated Certificate Management Environment (ACME) .
   However, none of these protocols provide native support for client
   that do not have IP connectivity yet (e.g., because they do not have
   network-access credentials, yet).  EAP-CREDS provides the possibility
   to use such protocols (i.e., message-based) by defining a series of



Pala                    Expires December 9, 2019                [Page 4]

Internet-Draft                  EAP-CREDS                      June 2019


   messages that can be used to encapsulate the provisioning messages
   for the selected provisioning protocol.

   In addition to these protocols, EAP-CREDS also defines a series of
   simple messages that provide a generic enrollment protocol that
   allows not only certificates but also other types of credentials
   (e.g., username/password pairs, tokens, or symmetric secrets) to be
   delivered to the client as part of the provisioning and/or renewal
   process.  The set of messages that make up the generic provisioning
   protocol is referred to as the Simple Provisioning Protocol protocol
   or SPP.

2.2.  Scope Statement

   This document focuses on the definition of the EAP-CREDS method to
   convey credentials provisioning and managing messages between the
   client and the AAA server.  Moreover, the document defines how to
   encode messages for the main IETF provisioning protocols.

   This document, however, does not provide specifications for how and
   where the credentials are generated.  In particular, the credentials
   could be generated directly within the AAA server or at a different
   location (i.e., the Certificate Service Provider or CSP) site.
   Different authentication mechanisms (e.g., TLS, etc.) can be used to
   secure the communication between the server's endpoint and the CSP.

2.3.  EAP-CREDS as tunneled mechanism only

   EAP-CREDS requires that an outer mechanism is in place between the
   Peer and the Server in order to provide authentication and
   confidentiality of the messages exchanged via EAP-CREDS.  In other
   words, EAP-CREDS assumes that an appropriatly encrypted and
   authenticated channel has been established to prevent the possibility
   to leak information or to allow man-in-the-middle attacks.

   This choice was taken to simplify the message flow between Peer and
   Server, and to abstract EAP-CREDS from the secure-channel
   establishment mechanism.  EAP-TLS, or EAP-TEAP are examples of such
   mechanisms.s

2.4.  Notation

   In this document we use the following notation in the diagrams to
   provide information about the cardinality of the data structures
   (TLVs) within EAP-CREDS messages:






Pala                    Expires December 9, 2019                [Page 5]

Internet-Draft                  EAP-CREDS                      June 2019


   +--------+------------+---------------------------------------------+
   | Symbol |  Example   | Usage                                       |
   +--------+------------+---------------------------------------------+
   |  { }   |   {TLV1}   | Curly Brackets are used to indicate a set   |
   |  [ ]   |  {[TLV2]}  | Square Brackets are used to indicate that a |
   |        |            | field is optional                           |
   |  ( )   | {TLV1(=V)} | Round Squares are used to specify a value   |
   |   +    |  {TLV_2+}  | The Plus character indicates that one or    |
   |        |            | more instances are allowed                  |
   +--------+------------+---------------------------------------------+

                        Table 1: EAP-CREDS Notation

3.  EAP-CREDS Protocol

   In a nutshell, EAP-CREDS provides the abstraction layer on top of
   which credentials provisioning/managing protocols can be deployed
   thus enabling their use even before provisioning IP services.

   This section outlines the operation of the protocol and message
   flows.  The format of the CREDS messages is given in Section 4.

3.1.  Message Flow

   EAP-CREDS message flow is logically subdivided into three different
   phases: Initialization, Provisioning, and Validation.  EAP-CREDS
   enforces the order of phases, i.e. it is not possible to move to an
   earlier phase.

   Phase transitioning is controlled by the Server via the ('Phase-
   Control') TLV: when a messages is the last of one phase or the first
   of another one, the ('Phase-Control') TLV is added to the message
   with the 'S' bit set appropriately, and the value set to the phase
   number that is transitioning.

   Phase One (Required).  Initialization.  During this phase the Peer
      and the Server exchange the information needed to select the
      appropriate credentials management protocol.  In particular, the
      Sever sends its initial message of type ('EAP-CREDS-Init').  The
      Peer replies with the details about which provisioning protocols
      are supported, and additional information such as the list of
      installed credentials and, optionally, authorization data (for new
      credentials registration).

   Phase Two (Optional).  Provisioning Protocol Flow.  In this phase,
      the Peer and the Server exchange the provisioning protocol's
      messages encapsulated in a EAP-CREDS message of type ProtoFlow.
      The messages use two main TLVs.  The first one is the



Pala                    Expires December 9, 2019                [Page 6]

Internet-Draft                  EAP-CREDS                      June 2019


      ('Provisioning-Headers') TLV which is optional and carries
      information that might be normally coveyed via the transport
      protocol (e.g., HTTP headers).  The second one is the
      ('Provisioning-Data'), which is required and carries the
      provisioning protocol's messages.  The server can decide to repeat
      phase two again to register new credentials or to renew a separate
      set of credentials.  When no more credentials have to be managed,
      the Server can start phase three or simply terminate the EAP
      session.

   Phase Three (Optional).  Credentials Validation.  This optional phase
      can be initiated by the server and it is used to validate that the
      Peer has properly installed the credentials and can use them to
      authenticate itself.  Depending on the credentials' type, the
      messages can carry a challenge/nonce, the value of the secret/
      token, or other information.  The format of the credentials is
      supposed to be known by the provider and the device.

3.1.1.  Phase Transition Rules

   In order to keep track of starting and ending a phase, EAP-CREDS
   defines a ('Phase-Control') TLV which is used on the first and last
   Server's message of a phase to idicate the current status of the
   protocol.

   Phase transitioning is, therefore, under the sole control of the
   Server.  In particular, when starting a new phase, the ('Phase-
   Control') TLV MUST be included by the Server in the message and it
   shall have the 'S' (Start) bit set and the value set to the current
   phase (e.g., one, two, or three).  On the other hand, when a phase is
   to be ended, the last message from the Server MUST carry the ('Phase-
   Control') TLV where the 'S' (Start) bit MUST be set to '0' and the
   value shall be set to the phase number that is ended.  ('Phase-
   Control') TLVs can only be used in Server messages (i.e., the Server
   decides when a phase ends and another begins).

   In case the first message of a phase is to be repeated (e.g., because
   of a recoverable error or becuase processing multiple credentials),
   the ('Phase-Control') TLV SHALL be included only on the first
   occurrency and omitted in subsequent messages.

      NOTE WELL: Once EAP-CREDS transitions from one phase to the next,
      the state machin MUST prohibit going back to a previous phase.
      This requirement guarantees that the two parties are always
      synchronized.






Pala                    Expires December 9, 2019                [Page 7]

Internet-Draft                  EAP-CREDS                      June 2019


3.2.  Phase One: Initialization

   The following figure provides the message flow for Phase One:


    ,--------.                              ,----------.
    |EAP Peer|                              |EAP Server|
    `---+----'                              `----+-----'
        |        Outer Tunnel Established        |
        | <-------------------------------------->
        |                                        |
        | [1] EAP-Request/EAP-CREDS(Type=Init)   |  ,---------!.
        |     { PhaseCtrl(=START), [ Version+ ] }|  |Phase One|_\
        | <---------------------------------------  |Begins     |
        |                                        |  `-----------'
        |  [2] EAP-Response/EAP-CREDS(Type=Init) |
        |      { Protocol+, Encodings,           |
        |        Formats, [  Version  ]          |
        |        [ CredInfo+ ], [ StorageInfo ]  |
        |        [ Token ], [ Challenge ],       |
        |        [ Challenge-Rsp ], [ Profile+], |
        |        PhaseCtrl(=END) }               |
        | --------------------------------------->
        |                                        |
        |  [3] EAP-Request/EAP-CREDS(Type=Init)  |  ,---------!.
        |      { PhaseCtrl(=END), Version }      |  |Phase One|_\
        | <---------------------------------------  |Ends       |
        |                                        |  `-----------'
        |                                        |



   [1] Server sends EAP-Request/EAP-CREDS(Type=Init):

      After the establishment of the outer mechanism (e.g., EAP-TLS,
      EAP-TEAP, EAP-TTLS, etc.), the server MAY decide to start a
      credentials management session.  In order to do that, the Server
      sends an EAP-Request/EAP-CREDS(Type=Init) message to the Peer with
      one ('Phase-Control') TLV with the 'S' bit set to '1' and the
      value set to '1' (thus indicating the beginning of Phase One).
      Also, the Server MAY use one or more ('Version') TLVs to indicate
      the supported versions.

      The Server MAY also specify which versions of EAP-CREDS are
      supported by adding one or more ('Version') TLVs.  If no
      ('Version') TLV is added to the message, the Peer SHOULD assume
      the supported version is 1 ('0x1').




Pala                    Expires December 9, 2019                [Page 8]

Internet-Draft                  EAP-CREDS                      June 2019


   [2] The Peer sends EAP-Response/EAP-CREDS(Type=Init)

      The Peer, sends back a message that carries one ('Version') TLV to
      indicate the selected version of EAP-CREDS (i.e.  from the list
      provided by the server) (optional).  If the client does not
      include the ('Version') TLV, the Server MUST use the most recent
      supported version of EAP-CREDS.  Moreover, the Server includes one
      or more ('Protocol') TLVs to indicate the list of supported
      provisioning protocols, followed by one ('Credentials-Info') TLVs
      for each installed credentials to provide their status to the
      server (i.e., if multiple credentials are configured on the Peer
      for this Network, then the Peer MUST include one ('Credentials-
      Info') TLV for each of them).

      The Peer also provides the list of supported Encodings and Formats
      by adding one or more ('Supported-Encodings') and ('Supported-
      Formats') TLVs.  The Peer MAY also provide the Server with
      information about the Peer's credentials storage by using the
      'Storage-Status' TLV.

      When there are no abailable credentials, the Peer MAY include an
      authorization token that can be consumed by the Server for
      registering new credentials.  In particular, the Peer can include
      the ('Token-Data') TLV to convey the value of the token.  The
      ('Challenge-Data') and ('Challenge-Response') TLVs, instead, can
      be used to convey a challenge and its response based on the
      authorization information (e.g., maybe a public key hash is
      present in the Token, then the peer can generate some random data
      - or use the one from the Server - and generate a signature on
      that value: the signature SHALL be encoded in the ('Challenge-
      Response') TLV and it should be calculated over the concatenation
      of values inside the ('Challenge-Data') TLV and the ('Token-Data')
      TLV.

      Also, the Peer MAY add one or more ('Profile') TLVs to indicate to
      the Server which profiles are requested/supported (e.g., a pre-
      configuration MAY exist on the Peer with these ecosystem-specific
      identifiers).

      Ultimately, the Peer MAY include one ('Storage-Info') TLV to
      provide the server with additional data about the Peer's
      capabilities and resources.

      The server checks that the Peer's selected protocol, version, and
      parameters are supported and, if not (or if the server detects an
      error), it can (a) send a non-recoverable error message to the
      peer, notify the outer (tunneling) layer, and terminate the EAP-
      CREDS session, or (b) start phase one again by sending a new



Pala                    Expires December 9, 2019                [Page 9]

Internet-Draft                  EAP-CREDS                      June 2019


      ('EAP-CREDS-Init') message that will also carry an ERROR TLV that
      provides the Peer with the reason the initial response was not
      acceptable.  In this case, the ('Phase-Control') TLV MUST be
      omitted since it is not the first message of phase one.  The
      server and the peer can repeat phase one until they reach an
      agreement or the session is terminated by the Server.

      NOTE WELL: The determination of the need to start phase two or not
      is based on the contents of the ('Credentials-Info') TLV sent by
      the Peer (e.g., a credential is about to expire or a credential is
      simply missing).

   [3] The Server sends EAP-Request/EAP-CREDS(Type=Init)

      In order to terminate Phase One, the Server sends a last message
      that carries the ('Phase-Control') TLV with the 'S' bit set to '0'
      (end of phase) and the value shall be set to '1' (phase one).  On
      top of that, the Server also sends one ('Version') TLV (mandatory)
      to announce the selected EAP-CREDS version to speak.

      When registering new credentials (e.g., no 'Credentials-Info' TLV
      was sent by the Peer and the Peer is authorized to present new
      credentials), the Server MAY add a ('Profile') TLV to indicate the
      selected profile for the new credentials that will be provisioned
      in Phase Two.

3.2.1.  Phase One State Machine

   The Server's state machine is depicted in the following Figure:






















Pala                    Expires December 9, 2019               [Page 10]

Internet-Draft                  EAP-CREDS                      June 2019


   +-------------------+
   |  Start Phase One  |
   +-------------------+
             |
             v
   +-------------------+
   | Send the Init Msg |<------------------+
   +-------------------+                   |
             |                             |
             v                             |
   +-------------------+                   |
   | Receives Peer's   |                   |
   |    Init Msg       |                   |
   +-------------------+                   |
             |                             | Yes
             v                             ^
    +------------------+  Yes   +---------------------+
    | Checks for Error |>------>|    Recoverable ?    |
    +------------------+        +---------------------+
             |  No                         |
             v                             v
   +-------------------+        +---------------------+
   |    End Phse One   |        |    Send Error Msg   |
   +-------------------+        +---------------------+
                                           |
                                           v
                                +---------------------+
                                |   End EAP Session   |
                                +---------------------+


   The first message from the server starts the phase by using the
   ('Phase-Control') TLV.

   The Server selects the action, the provisioning protocol, and
   associated parameters.  Phase Two officially begins with the next
   message exchanged (i.e. an EAP-Request/EAP-
   CREDS(Type=ProtoFlow)),which MUST include the ('Phase-Control') TLV
   with the 'S' bit set to '1' and the value set to '2'.  The message
   MUST also includes, at minimum, the selected ('Action') and
   ('Protocol') TLVs.

   When renewing existing credentials or registering new ones, the
   Server MUST include the ('Provisioning-Params') TLVs.

   When removing or renewing existing credentials, the Server MUST
   include the ('Credentials-Info') TLV to identify the set of
   credentials to which the action applies.



Pala                    Expires December 9, 2019               [Page 11]

Internet-Draft                  EAP-CREDS                      June 2019


   If multiple values are detected in the message, the message shall be
   discarded and the appropriate error message shall be issued by the
   Peer.

3.3.  Phase Two: Provisioning

   The following figure provides the message flow for Phase 2:


    ,--------.                                 ,----------.
    |EAP Peer|                                 |EAP Server|
    `---+----'                                 `----+-----'
        | [1] EAP-Request/EAP-CREDS(Type=ProtoFlow) |
        |     { PhaseCtrl(=START), Protocol, Action,|  ,---------!.
        |       [ CredInfo  ], [ Params ],          |  |Phase Two|_\
        |       [ ProtoData ], [ Profile ] }        |  |Begins     |
        | <------------------------------------------  `-----------'
        |                                           |
        | [2] EAP-Response/EAP-CREDS(Type=ProtoFlow)|
        |     { ProtoData, [ ProtoHeaders ] }       |
        | ------------------------------------------>
        |                                           |
        | [3] EAP-Response/EAP-CREDS(Type=ProtoFlow)|
        |     { ProtoData, [ ProtoHeaders ] }       |
        | <------------------------------------------
        |                                           |
        .                                           .
        .                                           .
        .                                           .
        .                                           .
        | [N] EAP-Request/EAP-CREDS(Type=ProtoFlow) |  ,---------!.
        |     { PhaseCtrl(=END) }                   |  |Phase Two|_\
        | <------------------------------------------  |Ends       |
        |                                           |  `-----------'
        |                                           |


   [1] The Server sends EAP-Request/EAP-CREDS(Type=Init)

      The first message of Phase Two indicates that the Server is ready
      to initiate the selected provisioning protocol.

   [2] The Peer sends EAP-Response/EAP-CREDS(Type=Init)

      After that, the Peer sends its first message to the Server by
      sending the EAP-Response/EAP-CREDS(Type=ProtoFlow) message.  This
      message contains the selected provisioning protocol's message data




Pala                    Expires December 9, 2019               [Page 12]

Internet-Draft                  EAP-CREDS                      June 2019


      and some extra fields (e.g., transport-protocol headers) in the
      ('Provisioning-Data') and ('Protocol-Headers') TLVs respectively.

   [3] The Server sends EAP-Request/EAP-CREDS(Type=Init)

      The Server replies to the Peer's message with EAP-Request/EAP-
      CREDS(Type=ProtoFlow) messages until the provisioning protocol
      reaches an end or an error condition arise (non-recoverable).

   [N] The Server sends EAP-Request/EAP-CREDS(Type=ProtoFlow)

      The Server terminates Phase Two by sending a final message
      carrying the ('Phase-Control') TLV with the 'S' bit set to '0' and
      the value set to '2' (thus indicating the end of Phase Two).  The
      final message does not need to be an empty one, i.e. other TLVs
      are still allowed in the same message (e.g., the 'Provisioning-
      Data' and the 'Provisioning-Headers' ones).

3.3.1.  Phase Two State Machine

   The Server's state machine for Phase Two is depicted in the following
   Figure:





























Pala                    Expires December 9, 2019               [Page 13]

Internet-Draft                  EAP-CREDS                      June 2019


                    +-------------------+
                    |  Start Phase Two  |
                    +-------------------+
                               |
                               v
                Yes +-------------------+ No
             +-----<|  New Credentials  |>-----+
             |      |    Available ?    |      |
             |      +-------------------+      |
             |                ^                |
             v                |                v
   +-------------------+      |      +-------------------+
   | Action Needed for |>-----+      |   Register New    |
   |   Credentials ?   | No          |    Credentials    |
   +-------------------+             +-------------------+
             v Yes                      Yes v       v No
             |                              |       |
             |      +-------------------+   |       |
             +----->|   Provisioning    |<--+       |
                    |     Protocol      |           |
                    +-------------------+           |
                              |  No                 |
                              v                     |
                    +------------------+            |
                    | End of Provision |            |
                    +------------------+            |
                              |                     |
                              v                     |
                    +------------------+            |
                    | End of Phase Two |<-----------+
                    +------------------+

   The Server can decide to repeat phase two as many times as needed:
   each time, the combination of the ('Credentials-Info') TLV (a.k.a.
   CredInfo) and the ('Action') TLV MUST be unique for each session to
   make sure notto repeat the same operation on the same credential over
   and over again.  In case all credentials for the Network do not need
   maintenance at this time, the Server can decide to end the EAP-CREDS
   session (no actions to be taken) and successfully complete the EAP
   session.

3.4.  Phase Three: Validation

   The following figure provides the message flow for Phase 3:







Pala                    Expires December 9, 2019               [Page 14]

Internet-Draft                  EAP-CREDS                      June 2019


    ,--------.                                ,----------.
    |EAP Peer|                                |EAP Server|
    `---+----'                                `----+-----'
        | [1] EAP-Request/EAP-CREDS(Type=Validate) |  ,-----------!.
        |     { PhaseCtrl(=START), CredInfo,       |  |Phase Three|_\
        |      Challenge }                         |  |Begins       |
        | <-----------------------------------------  `-------------'
        |                                          |
        | [2] EAP-Response/EAP-CREDS(Type=Validate)|
        |     { Challenge, ChallengeResponse,      |
        |       [ ExtraChallenge ] }               |
        | ----------------------------------------->
        |                                          |
        | [3] EAP-Request/EAP-CREDS(Type=Validate) |  ,-----------!.
        |     { Challenge, ChallengeResponse       |  |Phase Three|_\
        |       PhaseCtrl(=END) }                  |  |Ends         |
        | <-----------------------------------------  `-------------'
        |                                          |
        |                                          |


   Phase three is optional and it is used by the server to request the
   client to validate (proof) that the new credentials have been
   installed correctly before issuing the final Success message.

      NOTE WELL: Phase Three introduces a dependency on the selected
      hashing algorithm to provide common and easy way to check the
      integrity and functionality of a newly installed set of
      credentials.

   [1] The Server sends EAP-Request/EAP-CREDS(Type=Validate)

      In order to start Phase Three, the Server sends an EAP-Request/
      EAP-CREDS(Type=Validate) message to the Peer.  The Server MUST
      include the ('Credentials-Info') TLV to provide the indication
      about which set of credentials the Server intends to validate.
      The Server MUST also include a randomly generated challenge in the
      message to the client.

      As usual, the Server MUST also include the ('Phase-Control') TLV
      in its first message of Phase Three.  In this case, the 'S' bit
      shall be set to '1' and the value shall be set to '3' (beginning
      of Phase Three).

   [2] The Peer sends EAP-Response/EAP-CREDS(Type=Validate)

      When the client receives the Validate message from the server, it
      calculates the response to the challenge and sends the response



Pala                    Expires December 9, 2019               [Page 15]

Internet-Draft                  EAP-CREDS                      June 2019


      back to the server in a EAP-Response/EAP-CREDS(Type=Validate)
      message.  The Peer MUST calculate the response as follows:

         Public-Key

            For any public-key based credentials (e.g., certificates or
            raw key pairs), the response to the challenge is calculated
            by generating a signature over the hashed value of the
            challenge.  The hashing algorithm to be used for this
            purpose is specified in Section 5.3.1.  The format of the
            signature in the ('Challenge-Response') TLV is the
            concatenation of:

            -  The signatureAlgorithm (DER encoded) which contains the
               identifier for the cryptographic algorithm used by the
               Peer to generate the signature.  [RFC3279], [RFC4055],
               and [RFC4491] list supported signature algorithms, but
               other signature algorithms MAY also be supported.  The
               definition of the signatureAlgorithm is provided in
               Section 4.1.1.2 of [RFC5280].

            -  The signatureValue (DER encoded) which contains the
               digital signature itself.  The signature value is encoded
               as a BIT STRING and the details of how to generate the
               signatures' structures can be found in Section 4.1.1.3 of
               [RFC5280] and referenced material.

         Symmetric Secret

            For any symmetric based credentials (e.g., password or Key),
            the response to the challenge is calculated by using the
            selected hash function (see Section 5.3.1) on the
            concatenation of (a) the value carried in the server-
            provided ('Challenge-Data') TLV, and (b) the secret value
            itself (salted hash).

      Optionally, the client can add a separate ('Challenge-Data') TLV
      in its reply to request that the network proves it can calculate
      responses.  This extra challenge is only available for symmetric
      secrets (it is not used to verify again the identity of the
      server, but it is used for the server to prove it does have the
      right symmetric data on its side too).  This 'extra' challenge
      carries the Peer-generated challenge information that the Server
      MUST use to calculate the corresponding ('Challenge-Response')
      TLV.






Pala                    Expires December 9, 2019               [Page 16]

Internet-Draft                  EAP-CREDS                      June 2019


         NOTE WELL: The Server might not be able to respond to the extra
         challenge from the client because it might not posses the
         secret key (e.g., in case of public-key cryptography, the
         private key might not be shared with the Server, therefore it
         cannot generate signatures that the client can verify).  In
         that case, the Server will NOT add the ('Challenge-Response')
         TLV to its reply, but it MUST add the appropriate ('Errror')
         TLV.

   [3] The Server sends EAP-Request/EAP-CREDS(Type=Validate)

      When the server receives the EAP-Response/EAP-CREDS(Type=Validate)
      with the Challenge TLV in it, it MUST calculate the response to
      the challenge and send back the response to the client in an EAP-
      Request/EAP-CREDS(Type=Validate) with the ('Challenge-Response')
      TLV.

      In case of issues with the validation of the newly deployed
      credentials, both the Server and the Peer should consider those
      credentials invalid (or unusable) and should issue the required
      failure message(s).

3.4.1.  Phase Three State Machine

   The Server's state machine for Phase Three is depicted in the
   following Figure:

























Pala                    Expires December 9, 2019               [Page 17]

Internet-Draft                  EAP-CREDS                      June 2019


                                    +-------------------+
                                    | Start Phase Three |
                                    +-------------------+
                                               |
                                               v
                                    +---------------------+ No
   +------------------------------->|   New Credentials   |>-------+
   |           +------------------->|     Available ?     |<---+   |
   |           |                    +---------------------+    |   |
   |           |                  Yes |       ^                |   |
   |           |                      v       |                |   |
   |           |   +-------------------+      |                |   |
   |           |   |     Validate      |>-----+                |   |
   |           |   |   Credentials ?   | No                    |   |
   |           |   +-------------------+                       |   |
   |           |             v Yes                             |   |
   |           |             |                                 |   |
   |           |             |      +---------------------+    |   |
   |           |             +----->|     Send Validate   |    |   |
   |           |                    |       Messsage      |    |   |
   |           |                    +---------------------+    |   |
   |           |                              |                |   |
   |           |                              v                |   |
   |   +---------------------+   No +---------------------+    |   |
   |   |  Report the Error   |<----<|   Response Error?   |----+   |
   |   +---------------------+      +---------------------+ No     |
   |                                      Yes |                    |
   |                                          v                    |
   |                            No +---------------------+         |
   +------------------------------<|   End Validation ?  |         |
                                   +---------------------+         |
                                          Yes |                    |
                                              v                    |
                                   +---------------------+         |
                                   |   End Phase Three   |<--------+
                                   +---------------------+

4.  EAP-CREDS Message Format

   The EAP-CREDS defines the following message types:

   1.  EAP-CREDS/Init

   2.  EAP-CREDS/ProtoFlow

   3.  EAP-CREDS/Validate





Pala                    Expires December 9, 2019               [Page 18]

Internet-Draft                  EAP-CREDS                      June 2019


   Each of these message types have the basic structure as identified in
   Section 4.1 and in Section 4.2.  EAP-CREDS messages contain zero,
   one, or more TLVs.  The internal structure of the different types of
   TLVs is described in Section 4.2.1, while a detailed description of
   the EAP-CREDS message types is provided in Section 5.

4.1.  Message Header

   The EAP-CREDS messages consist of the standard EAP header (see
   Section 4 of [RFC3748]), followed by the version of the EAP-CREDS (4
   bits) and a field (4 bits) reserved for future use.  The header has
   the following structure:


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Code      |  Identifier   |             Length            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Type      | Flags |  Ver  |         Message Length        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Message Length        |               Data           ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-.


   Where the Code, Identifier, Length, and Type fields are all part of
   the EAP header as defined in [RFC3748].

   The Type field in the EAP header is <TBD> for EAP-CREDS.

   The Ver (Version) bitfield (4 bits) identifies the version of the
   EAP-CREDS protocol used for the exchange.  This document defines the
   value to use for this field as '0x1' (0001).

   The Flags bitfield (4 bits) is currently not used and it is reserved
   for future use.  The value of the bitfield shall be ignored when the
   Version ('Ver') field is set to '0x1' (0001).

4.2.  Message Payload

   The Data part of the message is organized as zero, one, or more TLV
   objects whose structure is defined in this section.  In particular,
   the general structure of a TLV is described in Section 4.2.1, while
   the specific structures for the supported TLVs is provided in
   Section 4.2.2.






Pala                    Expires December 9, 2019               [Page 19]

Internet-Draft                  EAP-CREDS                      June 2019


4.2.1.  General TLV format

   Each TLV object has the same basic structure that is defined as
   follows:


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                   TLV Length                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                       TLV Value                              ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Where:

   TLV-Type (uint8)

      This field is used to indicate the type of data that the TLV
      carries.  The type of TLV determines its internal structure.  The
      supported values for this fields are provided in the following
      table:

   Length (uint24)

      This field carries the size of the value of the TLV.  In
      particular, the overall size of a TLV (i.e., the header plus the
      value) can be calculated by adding the size of the header (6
      octects) to the value of the Length field (i.e., the size of the
      TLV's value).




















Pala                    Expires December 9, 2019               [Page 20]

Internet-Draft                  EAP-CREDS                      June 2019


     +----------+--------------------------+------------------------+
     | TLV Name | TLV Type                 |      Scope/Usage       |
     +----------+--------------------------+------------------------+
     |  <TBD>   | Action TLV               |       Phase Two        |
     |  <TBD>   | Certificate-Data TLV     |     Phase Two/SPP      |
     |  <TBD>   | Challenge-Data TLV       | Phase Two, Phase Three |
     |  <TBD>   | Challenge-Response TLV   | Phase Two, Phase Three |
     |  <TBD>   | Credentials-Data TLV     |     Phase Two/SPP      |
     |  <TBD>   | Credentials-Info TLV     | Phase Two, Phase Three |
     |  <TBD>   | Error TLV                |       All Phases       |
     |  <TBD>   | Peer-Description TLV     |       All Phases       |
     |  <TBD>   | Phase-Control TLV        |       All Phases       |
     |  <TBD>   | Profile TLV              |       Phase Two        |
     |  <TBD>   | Protocol TLV             |  Phase One, Phase Two  |
     |  <TBD>   | Provisioning-Data TLV    |       Phase Two        |
     |  <TBD>   | Provisioning-Headers TLV |       Phase Two        |
     |  <TBD>   | Provisioning-Params TLV  |       Phase Two        |
     |  <TBD>   | Token-Data TLV           |       Phase One        |
     |  <TBD>   | Version TLV              |       Phase One        |
     +----------+--------------------------+------------------------+

                  Table 2: EAP-CREDS Supported TLVs Types

   TLV Value ( > 1 octet )

      This field carries data for the identified TLV.  The internal
      structure is determined by the TLV Type field.

4.2.2.  EAP-CREDS defined TLVs

   EAP-CREDS messages's payload comprieses zero, one, or more TLVs that
   are encoded in a single EAP-CREDS message.  The values for the TLV
   Type that are supported by this specifications are listed in Table 2.

   This section describes the structure of the different supported TLVs
   and their usage in the different messages.

4.2.2.1.  The Action TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |     Flags     |          Action Type          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)



Pala                    Expires December 9, 2019               [Page 21]

Internet-Draft                  EAP-CREDS                      June 2019


      <TBD> - Action TLV

   Flags (uint8)

      Reserved

   Action Type (uint16)

      Provides the indication of the type of action to be performed in
      the current run of the phase two of EAP-CREDS.  The values for
      this field are provided in Table 11.

   Encoding (uint8)

      Provides the indication of the Encoding the credentials are in.
      The allowed values for this field are listed in Table 10.

   Value (octet string)

      This field carries the data for the credentials.

4.2.2.2.  The Certificate-Data TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Flags     |    Format     |    Encoding     |    Value   ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Certificate-Data TLV

   Length (uint24)

      Provides the length of the TLV (> 3 octets)

   Flags (uint8)

      Provides a BITMASK that can be used to provide additional
      information related to the encapsulated certificate.  The bits
      have the following meaning:

         Bit 0 - If set, the certificate is trusted (Trust Anchor)



Pala                    Expires December 9, 2019               [Page 22]

Internet-Draft                  EAP-CREDS                      June 2019


         Bit 1 - If set, the certificate is a CA certificate

         Bit 2 - If set, the certificate is self-signed

         Bit 3 - If set, the certificate is a proxy certificate

         Bit 4 - If set, the certificate is an attributes certificate

         Bit 5 - Reserved

         Bit 6 - Reserved

         Bit 7 - Reserved

   For a Trusted Root CA, the value of the flags shall be 0x7 (0000
   0111).  For an intermediate CA certificate that is not implicitly
   trusted, the value of the flags field should be set to 0x02 (0000
   0010).  For an End-Entity certificate, the value of the Flags will be
   0x0 (0000 0000).

   Format (uint8)

      Provides the indication of the Format the certificate is in.  The
      allowed values for this field are listed in Section 10.5.

   Encoding (uint8)

      Provides the indication of the Encoding the certificate is in.
      The allowed values for this field are listed in Table 10.

   Value (octet string)

      This field carries the data for the certificate.

4.2.2.3.  The Challenge-Data TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Challenge Data                     ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)




Pala                    Expires December 9, 2019               [Page 23]

Internet-Draft                  EAP-CREDS                      June 2019


      <TBD> - Challenge-Data TLV

   Length (uint24)

      3 octets

   Challenge Data (> 1 octet)

      This field carries the data to be used as a challenge when
      validating newly deployed credentials

4.2.2.4.  The Challenge-Response TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                       Challenge Response                     ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Challenge-Response TLV

   Length (uint24)

      3 octets

   Challenge Response (> 1 octet)

      This field carries the data that resulted from the use of the
      credentials to be validated.

4.2.2.5.  The Credentials-Information TLV














Pala                    Expires December 9, 2019               [Page 24]

Internet-Draft                  EAP-CREDS                      June 2019


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Flags     |   CredsType   |             ProtoID           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                         IssuedOn (GMT)                        |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                        Expires On (GMT)                       |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                       Credentials Length                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           CredIDValue                        ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   The Credential-Information TLV is used by the Peer to provide a
   description of the installed credentials that are relevant for the
   network that is being accessed.  The TLV is also used by the server
   to provide indication to the Peer about the required parameters when
   requesting/updating credentials.

   For example, when a set of credentials need to be renewed, the server
   checks the CredInfo from the Peer and eventually selects the right
   one for renewal - in the first message of Phase Two, the CredInfo TLV
   is used by the server to convey (let's say that the credentials to
   renew are X.509 based) the requirements for generating the X.509
   PKCS#10 request, such as the algorithm (RSA, ECDSA, etc.) further
   parameters (e.g., the specific curve to use or the Key Size) and the
   indication if the credentials are to be generated on the server or on
   the client.

   The TLV structure is as follows:

   TLV Type (uint8)

      <TBD> - Credentials-Information TLV

   Length (uint24)





Pala                    Expires December 9, 2019               [Page 25]

Internet-Draft                  EAP-CREDS                      June 2019


      Provides the total length of the body of the Credential-
      Information TLV.

   Flags (uint8)

      Provides a BITMASK that can be used to provide information about
      the status of the credentials (e.g., if the use marks the
      credentials to be compromised).  The bits have the following
      meaning:

         Bit 0 - If set, the credential is marked as compromised

         Bit 1 - If set, the credential is immutable and cannot be
         updated

         Bit 2 - Private Key or Secret Immutable, the public part of the
         credential (e.g., a certificate) can still be updated

         Bit 3 - If set, the credential cannot be updated (both public
         and private parts)

         Bit 4 - If set, the credential is ready to be used

         Bit 5 - If set, the credential was generated on the server

         Bit 6 - If set, the Peer would like to update the credential
         even if they are not expired

         Bit 7 - Reserved

   CredType (uint8)

      This field provides the description of the type of credential.
      The type of credentials are listed in Table 7

   ProtoID (uint16)

      This field indicates the protocol that was used to retrieve the
      target credential.  When the TLV is used in a Request by the
      Server, this field specifies which protocol should be used for its
      management.  The values for this field are listed in Table 5.

   IssuedOn (16 octets)

      This field carries the GMT date for when this credential was
      issued.  This field is 16 bytes long (the last byte must be set to
      '0x00') and contains the NULL-terminated ASCII string that
      represents the timestamp where the credential was issued.  When



Pala                    Expires December 9, 2019               [Page 26]

Internet-Draft                  EAP-CREDS                      June 2019


      the value is not set, the field should be set to { 0x00 }. The
      format of the string is as follows:



         YYYYMMDDHHmmssZ

      Where:

         YYYY - is the 4 digits representation of the year

         MM - is the 2 digits representation of the month

         DD - is the 2 digits representation of the day of the month

         HH - is the 2 digits representation of the hour of the day (24
         hour format)

         mm - is the 2 digits representation of the minutes of the hour

         ss - is the 2 digits representation of the seconds of the
         minute

         Z - is the character 'Z'

   ExpiresOn (16 octets)

      This field carries the GMT date for when this credential is to be
      considered expired.  This field is 16 bytes long (the last byte
      must be set to '0x00') and contains the NULL-terminated ASCII
      string that represents the timestamp where the credential was
      issued.  The format is the same as the ('IssuedOn') field.  When
      the value is not set, the field should be set to { 0x00 }.

   Credentials Length (uint16)

      Length (in bytes) of the Credentials value.  When used with a
      public-key type of credentials, this is the size of the key (e.g.,
      for an RSA 2048 bit keys, this field should carry the value of
      256).  When used with a symmetric secret, this field carries the
      size of the secred (in bytes).

   CredIDValue (> 1 octet)

      The binary value of the credentials' identifier.  This identifier
      can be the binary value of the SHA-256 calculated over the
      certificate, a username, or it could be a simple random handle.
      As long as the ID allows the server to uniquely (in its context)



Pala                    Expires December 9, 2019               [Page 27]

Internet-Draft                  EAP-CREDS                      June 2019


      identify the credentials, the value of this field can be
      calculated in any way.

4.2.2.6.  The Credentials-Data TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Cred Type   |     Format    |    Encoding     |     Value  ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Credentials-Data TLV

   Length (uint24)

      Provides the length of the TLV (> 3 octets)

   Cred Type (uint8)

      Provides the indication of the type of credentials.  The allowed
      values for this field are listed in Table 7.

   Format (uint8)

      Provides the indication of the Format the credentials are in.  The
      allowed values for this field are listed in Section 10.5.

   Encoding (uint8)

      Provides the indication of the Encoding the credentials are in.
      The allowed values for this field are listed in Table 10.

   Value (octet string)

      This field carries the data for the credentials.

4.2.2.7.  The Error TLV








Pala                    Expires December 9, 2019               [Page 28]

Internet-Draft                  EAP-CREDS                      June 2019


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     EAP-CREDS Error Code      |      Secondary Error Code     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          Description                         ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Challenge-Response-Data TLV

   Length (uint24)

      3 octets

   EAP-CREDS Error Code (2 octets)

      This field carries the EAP-CREDS error code.  These code are
      related to the EAP-CREDS operations only and it should not be used
      to carry the Provisioning-Protocol specific error codes.

   Secondary Error Code (2 octets)

      This field is used to convery an error at the encapsulation layer
      (i.e., the provisioning protocol error).  Do not use this field to
      convery EAP-CREDS specific errors.

   Description ( > 1 octet)

      The Description field is optional (i.e., when the Description Size
      is set to zero) and carries information about the error that
      occurred.  The message may or may not be used by a user or an
      automated process for debugging purposes.

4.2.2.8.  The Peer-Description TLV












Pala                    Expires December 9, 2019               [Page 29]

Internet-Draft                  EAP-CREDS                      June 2019


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Type      |              Peer Description Data           ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - The Peer-Description TLV

   Length (uint24)

      More than 1 octet

   Type (uint8)

      The Type of data in the Peer Description Data.  The initial values
      for this field are listed in Section 10.8.

   Peer Description Data (octet string)

      This is additional information related to the device.  In
      particular, this TLV can be used by the Peer to provide the Server
      with the description of the intended network usage.

      For example, this field can be used to convey a MUD file
      (Manufacturer Usage Description) or the latest firmware-update
      manifest.

4.2.2.9.  The Phase-Control TLV

     0                   1
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |S|   Phase     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Phase-Control TLV

   S (1 bit)





Pala                    Expires December 9, 2019               [Page 30]

Internet-Draft                  EAP-CREDS                      June 2019


      Start or End - If set to '0' (Start), this bit indicates that the
      message this TLV is embedded in, it is the first message for this
      phase (i.e., it marks the ) If set to '1' (End), this bits
      indicates that the message this TLV is embedded in, it is the last
      message for this phase.

   Phase (7 bits)

      The Phase field is used to indicate which of the phases is ending
      or starting.  This field should use only '1', '2', and '3' values
      for the current version of the EAP-CREDS/SPP specifications.

4.2.2.10.  The Profile TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Profile Identifying Data                  ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Profile Identifying Data TLV

   Length (uint24)

      4 octets

   Profile Identifying Data (octet string)

      The Profile Identifying Data is used to provide indication to the
      other party about which profiles are supported when requesting
      credentials management.

      Also in this case, the data used in this field is left to be
      interpreted by the end-point and it is orthogonal to EAP-CREDS
      data types.

      An example of values for this field, an end-point could use the
      string representation (i.e., dotted representation) of the Object
      Identifier (OID) of the specific profile supported (e.g., could be
      defined in the Certificate Policy of the credentials' provider).





Pala                    Expires December 9, 2019               [Page 31]

Internet-Draft                  EAP-CREDS                      June 2019


4.2.2.11.  The Protocol TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |        Protocol ID              |   Version   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Protocol TLV

   Protocol ID (uint16)

      The Protocol ID value carries the id of a supported provisioning
      protocol.  The initial values for the provisioning protocol
      identifiers can be found in Section 10.1.

   Version

      The Version (Protocol Version) value represents the specific
      version of the identified provisioning protocol.  When no version
      is specified for a protocol (i.e., either it does not support
      multiple versions or it does not matter), the value of this field
      should be set to '0x0'.

4.2.2.12.  The Provisioning-Data TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Provisioning Data                    ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Provisioning-Data TLV

   Length (uint24)

      3 octets




Pala                    Expires December 9, 2019               [Page 32]

Internet-Draft                  EAP-CREDS                      June 2019


   Headers Data (> 1 octet)

      This field carries the provisioning protocol's messages.

4.2.2.13.  The Provisioning-Headers TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Headers Data                       ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Provisioning-Headers TLV

   Length (uint24)

      3 octets

   Headers Data (> 1 octet)

      This field carries the meta-data (if any) that might be associated
      with the transport-layer normally used with the provisioning
      protocol.  For example, this TLV can carry the set of HTTP headers
      required by EST or ACME.

4.2.2.14.  The Provisioning-Params TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Min Length         |          Max Length           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Algorithm   |     Flags     |     OBJECT IDENTIFIER (DER)  ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Provisioning-Params TLV



Pala                    Expires December 9, 2019               [Page 33]

Internet-Draft                  EAP-CREDS                      June 2019


   Length (uint24)

      Provides the length of the TLV (>= 4 octets)

   Min Length (uint16)

      Provides the indication minimum size of the credentials.  This
      value has meaning depending on the context of the credentials,
      however sizes are always expressed in bytes.

      For example, when used with a symmetric key or a password, the
      ('Min Length') and ('Max Length') refer to the minimum and maximum
      size of the password data.  The ('Algor OID') field can be omitted
      in this case.

      On the other hand, when referring public-key credentials, this
      field should carry the size of the modulus of the key.  For
      example, for an RSA 2048 bit keys, the field should carry the
      value of 256.  For an ECDSA that uses the prime256r1 curve, this
      field should carry the value of 32 and the Algor OID should be the
      DER representation of the specific value of the curve (i.e., the
      DER representation of '1.2.840.10045.3.1.7').

   Max Length (uint16)

      Provides the indication maximum size of the credentials.  This
      value has meaning depending on the context of the credentials,
      however sizes are always expressed in bytes.

      The same considerations apply to this field as well as the ('Min
      Length') one discussed above.

   Flags (uint8)

      Provides a BITMASK that can be used to provide information about
      the status of the credentials (e.g., if the use marks the
      credentials to be compromised).  The bits have the following
      meaning:

         Bit 0 - Credentials (or part of it) are to be generated on the
         server

         Bit 1 - Credentials (or part of it) are to be generated on the
         peer

         Bit 2 - Credentials are to be generated on dedicated hardware

         Bit 3 - Reserved



Pala                    Expires December 9, 2019               [Page 34]

Internet-Draft                  EAP-CREDS                      June 2019


         Bit 4 - Reserved

         Bit 5 - Reserved

         Bit 6 - Reserved

         Bit 7 - Reserved

      When using public-key based credentials, the bits 0 and 1 are
      mutually exclusive.

      When using passwords or shared secrets, if bit 0 is set, then the
      secret is generated by the server and then sent to the client.  On
      the other hand, if bit 1 is set, then the secret is generated by
      the peer and then sent to the server.  Ultimately, if both bits
      are set, then the Peer generates the first part of the password
      and sends it to the Server, while the Server generates the second
      part of the password and sends it to the Peer.  The password to be
      used for future authentication is the concatenation of the two
      shares of the password: first the one from the Server, then the
      one from the Client.

      Last but not least, since these passwords/secrets are meant to be
      used in a automated fashion, there is no restriction around the
      character set to use or their interpretation.  Therefore, we
      suggest to generate full random passphrases (on client and server)
      to maximize the randomness carried within the secret.

   Algorithm (uint8)

      Provides the indication of the algorithm used for the generation
      of the credentials.  The allowed values for this field are listed
      in Table 8.

   Object Identifier (binary; > 1 octet)

      Provides the indication of additional parameters that need to be
      encoded for the credentials.  This value is used only when the
      credentials use public-key cryptography - this field carries
      additional information about the algorithm to be used.  We provide
      some useful values that can be used as reference:










Pala                    Expires December 9, 2019               [Page 35]

Internet-Draft                  EAP-CREDS                      June 2019


   +----------------+----------------------+---------------------------+
   | OID Name       |        Dotted        |      Binary Encoding      |
   |                |    Representation    |                           |
   +----------------+----------------------+---------------------------+
   | secp256r1      | 1.2.840.10045.3.1.7  |  06 08 2A 86 48 CE 3D 03  |
   | curve          |                      |           01 07           |
   | secp384r1      | 1.2.840.10045.3.1.34 |  06 08 2A 86 48 CE 3D 03  |
   | curve          |                      |           01 22           |
   | secp521r1      | 1.2.840.10045.3.1.35 |  06 08 2A 86 48 CE 3D 03  |
   | curve          |                      |           01 23           |
   | X25519 curve   |     1.3.101.110      |       06 03 2B 65 6E      |
   | X25519 curve   |     1.3.101.110      |       06 03 2B 65 6E      |
   | X448 curve     |     1.3.101.111      |       06 03 2B 65 6F      |
   | Ed25519 curve  |     1.3.101.112      |       06 03 2B 65 70      |
   | Ed448 curve    |     1.3.101.113      |       06 03 2B 65 71      |
   +----------------+----------------------+---------------------------+

                   Table 3: Object Identifiers Examples

4.2.2.15.  The Certificate-Request TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Encoding    |    Format     |            Value             ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Token-Data TLV

   Length (uint24)

      Provides the length of the TLV (> 3 octets)

   Encoding (uint8)

      Provides the indication of the Encoding the credentials are in.
      The allowed values for this field are listed in Table 10.

   Format (uint8)

      Provides the indication of the type of credentials.  The allowed
      values for this field are listed in Table 9.



Pala                    Expires December 9, 2019               [Page 36]

Internet-Draft                  EAP-CREDS                      June 2019


   CredsEnc (uint8)

      Provides the indication of the Encoding of the credentials are
      expected in.  This provides the indication to the Server of the
      capability allowed values for this field are listed in Table 10.

   CredsFormat (uint8)

      Provides the format the credentials is expected in.  The allowed
      values for this field are listed in Table 9.

   Value (octet string)

      This field carries the data for the credentials.

4.2.2.16.  The Storage-Info TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |     Flags     |           Spare Slots         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          Available Memory                     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Store-Info TLV

   Flags (8 bits)

      Provides information about the status and type of store and
      limited information about its capabilities.  The bits have the
      following meaning:

         Bit 0 - If set, the store supports RSA keys (software)

         Bit 1 - If set, the store supports RSA keys (hardware)

         Bit 2 - If set, the store supports ECDSA keys (software)

         Bit 3 - If set, the store supports ECDSA keys (hardware)

         Bit 4 - If set, the store supports symmetric keys

         Bit 5 - If set, the store supports generic tokens



Pala                    Expires December 9, 2019               [Page 37]

Internet-Draft                  EAP-CREDS                      June 2019


         Bit 6 - If set, the store is immutable (no key generation or
         deletion)

         Bit 7 - Not Used

   Spare Slots (uint16)

      Provides the number of available slots where to store credentials.
      When no more slots are available, the value of '0' should be used
      to indicate to the Server that a credential must be deleted before
      a new one can be created.

      When the number of slots is not fixed or not known, the value of {
      0xFF, 0xFF } shall be used.

   Available Memory (uint32)

      This field carries the size (in bytes) of the spare memory on the
      Peer's secrets' store.

4.2.2.17.  The Supported-Formats TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    TLV Type   |                    Length                     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Format    |      Format       ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-


   TLV Type (uint8)

      <TBD> - Supported-Formats TLV

   Format (uint8)

      Provides one or more supported formats for the credentials
      Table 9.  This TLV can contain 1 or more values of the format.

4.2.2.18.  The Supported-Encoding TLV









Pala                    Expires December 9, 2019               [Page 38]

Internet-Draft                  EAP-CREDS                      June 2019


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                    Length                     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Encoding    |     Encoding       ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-


   TLV Type (uint8)

      <TBD> - Store-Info TLV

   Encoding (uint8)

      Provides the indication of the supported Encoding by the End
      Point.  This provides the indication to the Server of the
      capability of the Peer.  The allowed values for this field are
      listed in Table 10.

4.2.2.19.  The Token-Data TLV


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |                  TLV Length                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Token Type   |    Encoding   |             Value            ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Token-Data TLV

   Length (uint24)

      Provides the length of the TLV (> 3 octets)

   Token Type (uint8)

      Provides the indication of the type of credentials.  The allowed
      values for this field are listed in Table 6.

   Encoding (uint8)





Pala                    Expires December 9, 2019               [Page 39]

Internet-Draft                  EAP-CREDS                      June 2019


      Provides the indication of the Encoding the credentials are in.
      The allowed values for this field are listed in Table 10.

   Value (octet string)

      This field carries the data for the credentials.

4.2.2.20.  The Version TLV

     0                   1
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   TLV Type    |   Version     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   TLV Type (uint8)

      <TBD> - Version TLV

   Version (uint8)

      The Version field is a uint8 value and represents the specific
      version of the EAP-CREDS protocol that are supported by the end
      point.  When multiple versions of EAP-CREDS are supported,
      multiple ('Version') TLVs can be used.

      When no version is specified (i.e., either it does not support
      multiple versions or it does not matter), the value of this field
      should be set to '0x0'.

5.  EAP-CREDS Messages

   This section describes each message and what TLVs are allowed or
   required.  EAP-CREDS defines the following values for the Message
   Type (Type):















Pala                    Expires December 9, 2019               [Page 40]

Internet-Draft                  EAP-CREDS                      June 2019


   +------------+---------------------+--------------------------------+
   |  Message   | Name                | Description                    |
   |    Type    |                     |                                |
   +------------+---------------------+--------------------------------+
   |     0      | EAP-CREDS-Init      | Initialization Phase           |
   |     1      | EAP-CREDS-ProtoFlow | Carries Provisioning Protocol  |
   |            |                     | Messages                       |
   |     2      | EAP-CREDS-Validate  | Validates newly installed      |
   |            |                     | credentials                    |
   +------------+---------------------+--------------------------------+

                     Table 4: EAP-CREDS Message Types

5.1.  The EAP-CREDS-Init Message

   The EAP-CREDS-Init message type is used in Phase One only of EAP-
   CREDS.  The message flow is depicted in Section 3.2.  This message
   supports the following TLVs: Version, Protocol, Credentials-Info, and
   Error.

5.1.1.  EAP Server's Init Message

   EAP-CREDS starts with an ('EAP-CREDS-Init') message from the server.
   This message MAY contain zero, one, or more ('Version') TLVs and,
   optionally, a ('Challenge-Data') TLV.

   The Server uses one or more ('Version') TLVs in the EAP-Request/EAP-
   CREDS(Type=Init) message to provide the Peer with the list of EAP-
   CREDS versions supported.  If omitted, the implict version of EAP-
   CREDS used in the session is one ('0x1').  If the Server detects
   multiple occurrences of this TLV in the reply from the Peer, an error
   shall be issued and the EAP-CREDS session should be terminated.

   In case Token-Based registration is enabled on the Server, the Server
   SHOULD include, in its Init message, a ('Challenge-Data') field that
   can be used by the client to provide reply protection, and (unique)
   challenge data for proof-of-possession of secrets.

5.1.2.  EAP Peer's Init Message

   The Peer MUST reply to the Server's ('EAP-CREDS-Init') message with
   its own ('EAP-CREDS-Init') one.  The Peer one Version TLV in the EAP-
   Response/EAP-CREDS(Type=Init) message to indicate the version of EAP-
   CREDS that the client wants to use for the session.  The Peer MUST
   also provide the list of supported provisioning protocols (via the
   'Protocol' TLV), the list and status of the installed credentials
   (via the 'Credentials-Info' TLV).  The Peer MAY include authorization




Pala                    Expires December 9, 2019               [Page 41]

Internet-Draft                  EAP-CREDS                      June 2019


   data when registering new credentials (e.g., an authorization token
   or a device certifcate).

   The Peer MUST include one ('Credentials-Info') TLV for each
   credential the Network is authorized to manage.  Typically, a Peer
   will include only one ('Credentials-Info') TLV in its ('EAP-CREDS-
   Init') message, but there might be cases where multiple types of
   credentials are available (e.g., X.509 certificate and username/
   password combination) and used depending on the location and other
   factors.

   In case the Peer does not have any credentials available yet, it does
   not add any ('Credentials-Info') TLV - leaving the Server with the
   only action possible: Registration.

5.1.2.1.  Bootstrapping Peer's Trustworthiness

   The Registration process might rely on information exchanged during
   the Provisioning Process in Phase Two, however, if an authorization
   mechanism is not available, EAP-CREDS provides a simple machanism for
   the Peer to leverage an out-of-band token/passphrase/ott that is
   available (or can easily be made available) on the Peer and that can
   be verified by the Server.

   In particular, when the Peer wants to register new credentials (and
   the Server requires the use of authorization because, for example,
   the Peer does not have any credentials yet) it may need to provide
   (a) a Token, (b) a challenge value, and (c) a response to the
   challenge value.  To do so, the Peer MUST encode the token in a
   ('Token-Data') TLV, the challenge value in a ('Challenge-Data') TLV,
   and, finally, the response to the challenge in the ('Challenge-
   Response') TLV.

   The use of ('Challenge-Data') and ('Challenge-Response') TLVs is
   optional, however it is suggested that if a token is used for
   bootstrapping the trust, it should provide a way to verify a secret
   associated with it.

   It is also very important that the authorization token is disclosed
   only to authorized servers - the Peer MUST NOT disclose authorization
   tokens that are not meant for the network that is being accessed.
   This can be done, usually, by verifying the identity of the Server
   first (in the outer mechanism) and then verify that the target of the
   Token is the Server the Client is talking to.







Pala                    Expires December 9, 2019               [Page 42]

Internet-Draft                  EAP-CREDS                      June 2019


5.2.  The EAP-CREDS-ProtoFlow Message

   The EAP-CREDS-ProtoFlow message type is used in Phase Two only of
   EAP-CREDS.  The message flow is depicted in Section 3.3.  This
   message type supports the following TLVs: Protocol, Credentials-Info,
   Provisioning-Headers, Provisioning-Data, Token-Data, Phase-Control,
   and Error.

   After the exchange of the initial two ('EAP-CREDS-Init') messages,
   the Server MAY start phase two by issuing an ('EAP-CREDS-ProtoFlow')
   message for the Peer where it encodes all the required details for
   starting the provisioning process.  In particular, the server sends
   the selected ('Action'), ('Protocol'), ('Credentials-Info'), and
   metadata to the client in a EAP-Request/EAP-CREDS(Type=ProtoFlow)
   message.  The ('Phase-Control') TLV MUST also be included with the
   'S' bit set to '1' (Start) and the value set to '2' (Phase Two
   begins).

      NOTE WELL: After the initial message, the only TLVs that are
      allowed in messages coming from the server are the usual
      ('Provisioning-Headers') ('Provisioning-Data'), and ('Error').

   The client checks that all the selected parameters are supported for
   the selected credentials and, if no errors are detected, it sends its
   first ('EAP-CREDS-ProtoFlow') message to the Server with the
   ('Provisioning-Headers') and ('Provisioning-Data') TLVs only.

   From now on, the conversation between the Peer and the Server
   continues until an error is detected or the provisioning protocol
   completes successfully.

   If no other actions, the server MAY continue with phase three or
   issue a success message and terminate the EAP session.  In order to
   terminat

      NOTE WELL: When the SPP protocol is used, the protocol messages
      that are encoded inside the ('Protocol-Data') TLV are composed of
      sets of TLVs as defined in this document.  The overall message
      size is provided by the size of the ('Protocol-Data') TLV that
      encapsulates the SPP-specific TLVs.  This design choice provides
      symmetry in implementing support for SPP when compared to other
      (available) provisioning protocols.

   In order to conclude Phase Two, the message from the Server MUST
   carry a ('Phase-Control') TLV with the 'S' bit set to '0' (end of
   phase) and the value should be set to '2' (Phase Two Ends).





Pala                    Expires December 9, 2019               [Page 43]

Internet-Draft                  EAP-CREDS                      June 2019


5.3.  The EAP-CREDS-Validate Message

   The EAP-CREDS-ProtoFlow message type is used in Phase Three only of
   EAP-CREDS.  The message flow is depicted in Section 3.4.  This
   message type supports the following TLVs: Protocol, Credentials-Info,
   Provisioning-Headers, Provisioning-Data, Token-Data, and Error.

   After Phase One (and/or Phase Two) ends, the Server MAY start phase
   three by issuing an ('EAP-CREDS-Validate') message for the Peer where
   it encodes all the required details for starting the validation
   process.

   In particular, the server sends the ('Credentials-Info'), a
   ('Challenge'), and the ('Phase-Control') TLVs in a EAP-Request/EAP-
   CREDS(Type=Validate) message.  The ('Phase-Control') TLV should carry
   the '1' value for the 'S' bit (Start) and the number '3' for its
   value (Phase Three begins).

   The Peer generates the answer to the Challenge and sends back a EAP-
   Response/EAP-CREDS(Type=Validate) message with the ('Challenge-
   Response') and an optional ('Challenge') field (only for server-side
   validation of the symmetric credentials).  If the Peer requested
   server-side validation of the credentials, the Server MUST include
   (if a symmetric secret) the response to the Peer-issued ('Challenge')
   TLV by computing the response and adding it to the ('Challenge-
   Response') TLV in its reply.

   Finally, in the last message, the Server (if Phase Three is to be
   ended) SHALL include the ('Phase-Control') TLV with the 'S' bit set
   to '0' (end of phase) and the value set to '3' (Phase Three ended).

   At this point, EAP-CREDS has terminated all possible operations and
   can be terminated.  The Server can now terminate the EAP session
   successfully.  In case the Peer was not authenticated during the
   tunnel establishment (i.e., no credentials were already available on
   the Peer), the Server should terminate the EAP session with a Failure
   (thus requiring the device to re-attach and authenticate to the
   network - phase two should have provided the Peer with the
   credentials to use for authenticating to the Network).

5.3.1.  Algorithm Requirements

   EAP-CREDS uses the SHA-256 hashing algorithm to verify credentials in
   phase three of the protocol.  Peers and Servers MUST support SHA-256
   for this purpose.






Pala                    Expires December 9, 2019               [Page 44]

Internet-Draft                  EAP-CREDS                      June 2019


6.  Error Handling in EAP-CREDS

   This section provides a description of the error handling by using
   the CREDS-Error-TLV in a CREDS message.

7.  Fragmentation

   Although EAP does not directly support handling of fragmented
   packets, EAP-CREDS requires that its messages are encapsulated via an
   outer method that MUST provide fragmentation support.

   Because of the outer method requirements in particular, removing any
   support for fragmented messages in EAP-CREDS removes the duplication
   of packets (e.g., Acknowledgment Packets) sent across the Peer and
   the Server, thus resulting in a smaller number of exchanged messages

8.  Encapsulating Provisioning Protocols in EAP-CREDS

   In order to use EAP-CREDS together with your favorite provisioning
   protocol, the messages from the provisioning protcol need to be sent
   to the other party.  In EAP-CREDS, this is done by putting the
   provisioning protocol messages inside the ('Provisioning-Data') TLV.
   In case the provisioning protocol uses additional data for its
   operations (e.g., uses HTTP Headers), this data can be encoded in a
   separate ('Provisioning-Headers') TLV.

   Since the implementation of the provisioning endpoint could happen in
   a (logically or physically) different component, a method is needed
   to identify when a provisioning protocol has actually ended.  In EAP-
   CREDS, when the provisioning protocol is over, when an empty message
   is sent by the Server (not the Peer).

   In the first message of Phase Two, the Server provides the client
   with all the selected parameters for one specific credential that
   needs attention (or for a new credential) to be registered with the
   network.  In particular, the server provides the ('Version') TLV
   (optional), the ('Protocol') TLV, the ('Action') TLV, and the
   ('Provisioning-Params') TLV.

   After checking the parameters sent by the Server, if the Peer does
   not support any of them, it MUST send a message with one single
   ('Error') TLV with the appropriate error code(s).  The server, can
   then decide if to manage a different set of credentials (if more
   where reported by the Peer in its Phase One message) or if to
   terminate the EAP session with an error.

   The Peer and the Server exchange ProtoFlow messages until an error is
   detected and the appropriate error message is sent to the other



Pala                    Expires December 9, 2019               [Page 45]

Internet-Draft                  EAP-CREDS                      June 2019


   party.  If the error message was sent by the Peer, then the Server
   MAY send an empty message to the Peer and terminate the session, or
   it MAY try to restart Phase Two for a different set of credentials or
   with a different action (same target and action MUST not be repeated
   in the same EAP-CREDS session).

9.  EAP-CREDS and Simple Provisioning Protocol (SPP)

   EAP-CREDS supports a Simple Provisioning Protocol (SPP) which
   comprises a series of messages that enables the management not only
   of certificates, but also of other types of credentials like
   username/password pairs, asymmetric keys, and symmetric keys.

   The Simple Provisioning Protocol (SPP), described in this section,
   behaves as any other provisioning protocol: its messages are
   encapsulated in the ('Provisioning-Data') TLVs in the second phase of
   the protocol.

   When no ('Credentials-Info') TLVs have been provided by the client,
   the Server knows that the device does not have valid credentials it
   wants to use to access the Network.  In this case, EAP-CREDS/SPP
   supports the use of Tokens to kick-off the registration process.  The
   type, format, or encoding of the Token is orthogonal to EAP-CREDS/SPP
   which treats the token as a black-box field (i.e., it does not try to
   interpret or parse its contents).

      NOTE WELL: During Phase One, the Peer MAY include the ('Token-
      Data') TLV in its EAP-CREDS-Init message to provide the needed
      authorization to register a new set of credentials.  The Server
      might not allow the registration of new credentials if the
      required authorization (i.e., the Token) was not provided during
      the initialization phase.

   In the case where an authorization Token MUST be used and it is not
   just a bearer token but it can be used (or a secret identified in it)
   to generate a verifiable proof-of-possession, the Peer can include a
   ('Challenge-Data') and a ('Challenge-Response') TLVs.

   The ('Challenge-Data') TLV MUST be used to convey the challenge data
   (usually some random value), if any.  If the Server provided a
   ('Challenge-Data') TLV, then the Peer MUST use the same TLV in its
   message (and to calculate the response).

   The ('Challenge-Response') TLV is used, instead, to encode the
   response to the challenge data that can be generated by the Peer and
   verified by the Server.





Pala                    Expires December 9, 2019               [Page 46]

Internet-Draft                  EAP-CREDS                      June 2019


      NOTE WELL: The use of the ('Token-Data'), ('Challenge-Data'), and
      ('Challenge-Response') TLVs in the Peer's Init message can be used
      to bootstrap trust between the server and the client.

9.1.  SPP Message Format

   The SPP Messages are constructed with zero, one, or more TLVs and
   encoded in the ('Provisioning-Data') TLV.  The size of the
   encpasulating ('Provisioning-Data') TLV provides the size of the
   whole message.

9.2.  SPP Message Flow


    ,--------.                                 ,----------.
    |EAP Peer|                                 |EAP Server|
    `---+----'                                 `----+-----'
        | [1] EAP-Request/EAP-CREDS(Type=ProtoFlow) |
        |   { Protocol(=SPP), Action,               |
        |     PhaseCtrl(=START), [ Params ],        |
        |     [ ProvData(=CredsData) ] }            |
        | <------------------------------------------
        |                                           |
        | [2] EAP-Response/EAP-CREDS(Type=ProtoFlow)|
        |   { [ ProvData(=CredsData) ]}             |
        | ------------------------------------------>
        |                                           |
        | [3] EAP-Response/EAP-CREDS(Type=ProtoFlow)|
        |   { [ ProvData(=CredsData) ]              |
        |     PhaseCtrl(=END) }                     |
        | <------------------------------------------
        |                                           |
        |                                           |


   EAP-CREDS defines several actions for a set of credentials.  The
   identified actions are listed in Table 11.  In particular, when a
   Peer wants to join a network but it does not have the needed
   credentials to do so (and it provided the required authorization/
   authentication Token data), the Server MAY start Phase Two with the
   intention of registering a new set of credentials.

   In this case, the first message from the Server, shall not contain a
   ('Credentials-Info') TLV since there is no targeted credentials that
   apply for this operation (i.e., for other actions - like 'renew' or
   'delete' - the TLV would identify the right set of credentials to
   renew or delete).




Pala                    Expires December 9, 2019               [Page 47]

Internet-Draft                  EAP-CREDS                      June 2019


   The Server also sets the ('Protocol') TLV to SPP, the ('Action') TLV
   to 'Register' or 'Renew', the ('Provisioning-Params') TLV (or Params)
   to the type of needed credentials (and relevant constraints).

   If the type of credentials is symmetric and the params call for
   server-side generation of a key share, the Server MUST include its
   own generated share in a ('Credentials-Data') TLV inside the
   ('Provisioning-Data') one (the data for the provisioning protocol are
   encapsulated in the 'Provisioning-Data' TLV for any protocol used
   during Phase Two - SPP is no exception to this rule).

   The Peer replies to the Server's message with its own 'ProtoFlow'
   response.  The response shall carry its own generated share of the
   key (if the credentials that are provisioned are symmetric and the
   configuration called for a share of the key to be provided by the
   Peer) or the PKCS#10 request (encoded in the 'Provisioning-Data' TLV)
   in case client-side generation was specified in the ('Provisioning-
   Params').  Otherwise, if no client-side generation was specified, the
   ('Provisioning-Data') TLV must still be present with a length of zero
   ('0x0') bytes.

   The last message is then from the Server.  In case the credentials
   being provisioned are Certificate-based, the Server MUST include the
   issued certificate in its reply.  The issued credentials shall be
   encoded in a ('Credentials-Data') TLV inside the ('Provisioning-
   Data') one.  In case that the format supported/selected by the Peer
   and the Server does not provide the possibility to encode the full
   chain (i.e., intermediate and Root CAs) in the response, the Server
   MUST add one ('Certificate-Data') TLV for each certificate in the
   chain (including the Root CA's certificate).

   If the message from the Server marks the end of the last phase of
   EAP-CREDS, the Server MUST include the ('Phase-Control') TLV with the
   'S' bit set to '0' (end of phase) and the value set to '3' (Phase
   Three ends) and the EAP session can now be safely terminated.

9.2.1.  SPP Password Provisioning














Pala                    Expires December 9, 2019               [Page 48]

Internet-Draft                  EAP-CREDS                      June 2019


    ,--------.                                 ,----------.
    |EAP Peer|                                 |EAP Server|
    `---+----'                                 `----+-----'
        | [1] EAP-Request/EAP-CREDS(Type=ProtoFlow) |
        |   { Protocol(=SPP), Action,               |
        |     PhaseCtrl(=START), [ Params ],        |
        |     [ ProvData(=CredsData) ] }            |
        | <------------------------------------------
        |                                           |
        | [2] EAP-Response/EAP-CREDS(Type=ProtoFlow)|
        |   { [ ProvData(=CredsData) ]}             |
        | ------------------------------------------>
        |                                           |
        | [3] EAP-Response/EAP-CREDS(Type=ProtoFlow)|
        |   { [ ProvData(=CredsData) ]              |
        |     PhaseCtrl(=END) }                     |
        | <------------------------------------------
        |                                           |
        |                                           |


   EAP-CREDS/SPP can provision symmetric secrets or bearer's tokens like
   username/password combination, an OAuth token, or a symmetric key.
   The message flow is provided in Section 9.2.1

   EAP-CREDS/SPP provides the possibility for shared secret to be
   generated in different ways:

   1.  Server-Side Generated

   2.  Client-Side Generated

   3.  Both Sides Generate a share

   In particular, when initiating the second phase of the protocol, the
   ('Provisioning-Params') TLV is used to specify how to generate the
   secret (see Section 4.2.2.14).

9.3.  SPP: Renewing Credentials

9.4.  SPP: Removing Credentials

9.5.  SPP Certificate Provisioning

   EAP-CREDS/SSP defines the following flow of messages for requesting
   the provisioning of credentials.





Pala                    Expires December 9, 2019               [Page 49]

Internet-Draft                  EAP-CREDS                      June 2019


10.  IANA Considerations

   This document uses a new EAP type, EAP-CREDS, whose value (TBD) MUST
   be allocated by IANA from the EAP TYPEs subregistry of the RADIUS
   registry.  This section provides guidance to the Internet Assigned
   Numbers Authority (IANA) regarding registration of values related to
   the EAP-CREDS protocol, in accordance with [RFC8126].

   The EAP Method Type number for EAP-CREDS needs to be assigned.

   This document also requires IANA to create new registries as defined
   in the following subsections.

10.1.  Provisioning Protocols

   +-----------------+-------------------------------------------------+
   |   Message Type  | Purpose                                         |
   +-----------------+-------------------------------------------------+
   |        0        | Unspecified                                     |
   |        1        | Simple Provisioning Protocol (SPP)              |
   |        2        | Basic Certificate Management Protocol (CMP-S)   |
   |        3        | Full Certificate Management Protocol (CMP-F)    |
   |        4        | Enrollment over Secure Transport (EST)          |
   |        5        | Certificate Management over CMS (CMC)           |
   |        6        | Automatic Certificate Management Environment    |
   |                 | (ACME)                                          |
   |       ...       | ...                                             |
   | 49141 ... 65534 | Vendor Specific                                 |
   +-----------------+-------------------------------------------------+

               Table 5: EAP-CREDS Inner Protocol Identifiers

   Assignment of new values for new cryptosuites MUST be done through
   IANA with "Specification Required" and "IESG Approval" as defined in
   [RFC8126].

10.2.  Token Types














Pala                    Expires December 9, 2019               [Page 50]

Internet-Draft                  EAP-CREDS                      June 2019


                     +------------+-----------------+
                     | Token Type | Description     |
                     +------------+-----------------+
                     |     0      | Unspecified     |
                     |     1      | JWT             |
                     |     2      | Kerberos        |
                     |     3      | OAuth           |
                     |  200..254  | Vendor Specific |
                     +------------+-----------------+

                           Table 6: Token Types

   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in [RFC8126].

10.3.  Credentials Types

               +------------------+-----------------------+
               | Credentials Type | Description           |
               +------------------+-----------------------+
               |        0         | X.509 Certificate     |
               |        1         | Public Key            |
               |        2         | Symmetric Key         |
               |        3         | Username and Password |
               |        4         | AKA Subscriber Key    |
               |        5         | Bearer Token          |
               |        6         | One-Time Token        |
               |        7         | API Key               |
               +------------------+-----------------------+

                        Table 7: Credentials Types

   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in [RFC8126].

10.4.  Credentials Algorithms















Pala                    Expires December 9, 2019               [Page 51]

Internet-Draft                  EAP-CREDS                      June 2019


                     +---------+--------------------+
                     |    ID   | Algorithm          |
                     +---------+--------------------+
                     |    0    | None               |
                     |    1    | RSA                |
                     |    2    | ECDSA              |
                     |    3    | XMMS               |
                     |    4    | AKA Subscriber Key |
                     |    5    | OAuth              |
                     |    6    | Kerberos4          |
                     |    7    | Kerberos5          |
                     | 200-254 | Reserved           |
                     +---------+--------------------+

                      Table 8: Credentials Algorithms

   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in [RFC8126].

10.5.  Credentials Datatypes

                        +---------+---------------+
                        |    ID   | Data Type     |
                        +---------+---------------+
                        |    0    | None (Binary) |
                        |    1    | PKCS#8        |
                        |    2    | PKCS#10       |
                        |    3    | PKCS#12       |
                        |    4    | PublicKeyInfo |
                        | 200-254 | Reserved      |
                        +---------+---------------+

                      Table 9: Credentials Datatypes

   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in [RFC8126].

10.6.  Credentials Encoding













Pala                    Expires December 9, 2019               [Page 52]

Internet-Draft                  EAP-CREDS                      June 2019


                         +---------+------------+
                         |    ID   | Encoding   |
                         +---------+------------+
                         |    0    | None (Raw) |
                         |    1    | DER        |
                         |    2    | PEM        |
                         |    3    | Base64     |
                         |    4    | JSON       |
                         |    5    | XML        |
                         |    6    | ASCII      |
                         |    7    | UTF-8      |
                         | 200-254 | Reserved   |
                         +---------+------------+

                      Table 10: Credentials Encoding

   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in [RFC8126].

10.7.  Action Types

        +---------+--------------+--------------------------------+
        |    ID   | Data Type    | Description                    |
        +---------+--------------+--------------------------------+
        |    0    | Registration | Registers New Credentials      |
        |    1    | Renewal      | Renew an Existing Credential   |
        |    2    | Remove       | Removes an Existing Credential |
        | 200-254 | n/a          | Reserved                       |
        +---------+--------------+--------------------------------+

                          Table 11: Action Types

   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in [RFC8126].

10.8.  Usage Metadata Types

                      +------+----------------------+
                      | Type | Description          |
                      +------+----------------------+
                      |  0   | Binary (Unspecified) |
                      |  1   | MUD File             |
                      |  2   | TEEP Manifest        |
                      +------+----------------------+

                      Table 12: Usage Metadata Types





Pala                    Expires December 9, 2019               [Page 53]

Internet-Draft                  EAP-CREDS                      June 2019


   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in [RFC8126].

11.  Security Considerations

   Several security considerations need to be explicitly considered for
   the system administrators and application developers to understand
   the weaknesses of the overall architecture.

   The most important security consideration when deploying EAP-CREDS is
   related to the security of the outer channel.  In particular, EAP-
   CREDS assumes that the communication channel has been properly
   authenticated and that the information exchanged between the Peer and
   the Server are protected (i.e., confidentiality and integrity).

   For example, if certificate-based authentication is used, the server
   presents a certificate to the peer as part of the trust establishment
   (or negotiation).  The peer SHOULD verify the validity of the EAP
   server certificate and SHOULD also examine the EAP server name
   presented in the certificate in order to determine whether the EAP
   server can be trusted.  When performing server certificate
   validation, implementations MUST provide support for the rules in
   [RFC5280] for validating certificates against a known trust anchor.

12.  Acknowledgments

   The authors would like to thank everybody who provided insightful
   comments and helped in the definition of the deployment
   considerations.

13.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997, <https://www.rfc-
              editor.org/info/rfc2119>.

   [RFC3748]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
              Levkowetz, Ed., "Extensible Authentication Protocol
              (EAP)", RFC 3748, DOI 10.17487/RFC3748, June 2004,
              <https://www.rfc-editor.org/info/rfc3748>.

   [RFC4210]  Adams, C., Farrell, S., Kause, T., and T. Mononen,
              "Internet X.509 Public Key Infrastructure Certificate
              Management Protocol (CMP)", RFC 4210,
              DOI 10.17487/RFC4210, September 2005, <https://www.rfc-
              editor.org/info/rfc4210>.




Pala                    Expires December 9, 2019               [Page 54]

Internet-Draft                  EAP-CREDS                      June 2019


   [RFC5272]  Schaad, J. and M. Myers, "Certificate Management over CMS
              (CMC)", RFC 5272, DOI 10.17487/RFC5272, June 2008,
              <https://www.rfc-editor.org/info/rfc5272>.

   [RFC5280]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", RFC 5280, DOI 10.17487/RFC5280, May 2008,
              <https://www.rfc-editor.org/info/rfc5280>.

   [RFC6402]  Schaad, J., "Certificate Management over CMS (CMC)
              Updates", RFC 6402, DOI 10.17487/RFC6402, November 2011,
              <https://www.rfc-editor.org/info/rfc6402>.

   [RFC7030]  Pritikin, M., Ed., Yee, P., Ed., and D. Harkins, Ed.,
              "Enrollment over Secure Transport", RFC 7030,
              DOI 10.17487/RFC7030, October 2013, <https://www.rfc-
              editor.org/info/rfc7030>.

   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for
              Writing an IANA Considerations Section in RFCs", BCP 26,
              RFC 8126, DOI 10.17487/RFC8126, June 2017,
              <https://www.rfc-editor.org/info/rfc8126>.

Appendix A.  EAP-CREDS Example Message Flow for Provisioning Standards

A.1.  EAP-CREDS and CMP

   Describe how to use EAP-CREDS with CMP.

A.2.  EAP-CREDS and EST

   Describe how to use EAP-CREDS with EST.

A.3.  EAP-CREDS and CMS

   Describe how to use EAP-CREDS with CMS.

A.4.  EAP-CREDS and ACME

   Describe how to use EAP-CREDS with ACME.

Author's Address








Pala                    Expires December 9, 2019               [Page 55]

Internet-Draft                  EAP-CREDS                      June 2019


   Massimiliano Pala
   CableLabs
   858 Coal Creek Cir
   Louisville, CO  80027
   US

   Email: m.pala@openca.org
   URI:   http://www.linkedin.com/in/mpala











































Pala                    Expires December 9, 2019               [Page 56]
